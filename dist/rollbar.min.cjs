/*! For license information please see rollbar.min.cjs.LICENSE.txt */
(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>Ze});const r=require("util"),n=require("os");var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=function(t){if(!t||"[object Object]"!==i.call(t))return!1;var e,r=o.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&o.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;for(e in t);return void 0===e||o.call(t,e)};const s=function t(){var e,r,n,o,i,s={},u=null,c=arguments.length;for(e=0;e<c;e++)if(null!=(u=arguments[e]))for(i in u)r=s[i],s!==(n=u[i])&&(n&&a(n)?(o=r&&a(r)?r:{},s[i]=t(o,n)):void 0!==n&&(s[i]=n));return s};function u(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function p(t,e){return e===f(t)}function f(t){var e=l(t);return"object"!==e?e:t?t instanceof Error?"error":{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase():"null"}function h(t){return p(t,"function")}function d(t){var e=l(t);return null!=t&&("object"==e||"function"==e)}var m={debug:0,info:1,warning:2,error:3,critical:4};function y(t,e){var r,n;try{r=JSON.stringify(t)}catch(o){if(e&&h(e))try{r=e(t)}catch(t){n=t}else n=o}return{error:n,value:r}}function v(t,e){return function(r,n){try{e(r,n)}catch(e){t.error(e)}}}function g(t){return function t(e,r){var n,o,i,a={};try{for(o in e)(n=e[o])&&(p(n,"object")||p(n,"array"))?r.includes(n)?a[o]="Removed circular reference: "+f(n):((i=r.slice()).push(n),a[o]=t(n,i)):a[o]=n}catch(t){a="Failed cloning custom data: "+t.message}return a}(t,[t])}function b(t,e,r,n,o){for(var i,a,s,u,c,l,p=[],h=[],d=0,m=t.length;d<m;++d){var y=f(l=t[d]);switch(h.push(y),y){case"undefined":break;case"string":i?p.push(l):i=l;break;case"function":u=v(e,l);break;case"date":p.push(l);break;case"error":case"domexception":case"exception":a?p.push(l):a=l;break;case"object":case"array":if(l instanceof Error||"undefined"!=typeof DOMException&&l instanceof DOMException){a?p.push(l):a=l;break}if(n&&"object"===y&&!c){for(var b=0,w=n.length;b<w;++b)if(void 0!==l[n[b]]){c=l;break}if(c)break}s?p.push(l):s=l;break;default:if(l instanceof Error||"undefined"!=typeof DOMException&&l instanceof DOMException){a?p.push(l):a=l;break}p.push(l)}}s&&(s=g(s)),p.length>0&&(s||(s=g({})),s.extraArgs=g(p));var x,_={message:i,err:a,custom:s,timestamp:S(),callback:u,notifier:r,diagnostic:{},uuid:(x=S(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=(x+16*Math.random())%16|0;return x=Math.floor(x/16),("x"===t?e:7&e|8).toString(16)})))};return _.data=_.data||{},function(t,e){e&&void 0!==e.level&&(t.level=e.level,delete e.level);e&&void 0!==e.skipFrames&&(t.skipFrames=e.skipFrames,delete e.skipFrames)}(_,s),n&&c&&(_.request=c),o&&(_.lambdaContext=o),_._originalArgs=t,_.diagnostic.original_arg_types=h,_}var w=["log","network","dom","navigation","error","manual"],x=["critical","error","warning","info","debug"];function _(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return!0;return!1}function E(t,e){if(t){var r=e.split("."),n=t;try{for(var o=0,i=r.length;o<i;++o)n=n[r[o]]}catch(t){n=void 0}return n}}function k(t,e,r){if(t){var n=e.split("."),o=n.length;if(!(o<1))if(1!==o)try{for(var i=t[n[0]]||{},a=i,s=1;s<o-1;++s)i[n[s]]=i[n[s]]||{},i=i[n[s]];i[n[o-1]]=r,t[n[0]]=a}catch(t){return}else t[n[0]]=r}}function S(){return Date.now?+Date.now():+new Date}function I(t,e,r,n){var o=s(t,e,r);return o=function(t,e){t.hostWhiteList&&!t.hostSafeList&&(t.hostSafeList=t.hostWhiteList,t.hostWhiteList=void 0,e&&e.log("hostWhiteList is deprecated. Use hostSafeList."));t.hostBlackList&&!t.hostBlockList&&(t.hostBlockList=t.hostBlackList,t.hostBlackList=void 0,e&&e.log("hostBlackList is deprecated. Use hostBlockList."));return t}(o,n),!e||e.overwriteScrubFields||e.scrubFields&&(o.scrubFields=(t.scrubFields||[]).concat(e.scrubFields)),o}function L(t){this.startTime=S(),this.counter=0,this.perMinCounter=0,this.platform=null,this.platformOptions={},this.configureGlobal(t)}function O(t,e,r){return!t.ignoreRateLimit&&e>=1&&r>e}function T(t,e,r,n,o,i,a){var s=null;return r&&(r=new Error(r)),r||n||(s=function(t,e,r,n,o){var i,a=e.environment||e.payload&&e.payload.environment;i=o?"item per minute limit reached, ignoring errors until timeout":"maxItems has been hit, ignoring errors until reset.";var s={body:{message:{body:i,extra:{maxItems:r,itemsPerMinute:n}}},language:"javascript",environment:a,notifier:{version:e.notifier&&e.notifier.version||e.version}};"browser"===t?(s.platform="browser",s.framework="browser-js",s.notifier.name="rollbar-browser-js"):"server"===t?(s.framework=e.framework||"node-js",s.notifier.name=e.notifier.name):"react-native"===t&&(s.framework=e.framework||"react-native",s.notifier.name=e.notifier.name);return s}(t,e,o,i,a)),{error:r,shouldSend:n,payload:s}}L.globalSettings={startTime:S(),maxItems:void 0,itemsPerMinute:void 0},L.prototype.configureGlobal=function(t){void 0!==t.startTime&&(L.globalSettings.startTime=t.startTime),void 0!==t.maxItems&&(L.globalSettings.maxItems=t.maxItems),void 0!==t.itemsPerMinute&&(L.globalSettings.itemsPerMinute=t.itemsPerMinute)},L.prototype.shouldSend=function(t,e){var r=(e=e||S())-this.startTime;(r<0||r>=6e4)&&(this.startTime=e,this.perMinCounter=0);var n=L.globalSettings.maxItems,o=L.globalSettings.itemsPerMinute;if(O(t,n,this.counter))return T(this.platform,this.platformOptions,n+" max items reached",!1);if(O(t,o,this.perMinCounter))return T(this.platform,this.platformOptions,o+" items per minute reached",!1);this.counter++,this.perMinCounter++;var i=!O(t,n,this.counter),a=i;return i=i&&!O(t,o,this.perMinCounter),T(this.platform,this.platformOptions,null,i,n,o,a)},L.prototype.setPlatformOptions=function(t,e){this.platform=t,this.platformOptions=e};const P=L;function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function R(){R=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof v?e:v,a=Object.create(i.prototype),s=new P(n||[]);return o(a,"_invoke",{value:I(t,r,s)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",m="completed",y={};function v(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(q([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=b.prototype=v.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var u=p(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==j(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function I(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=L(s,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?m:h,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function q(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(j(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),c(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),c(E,u,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=q,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:q(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function q(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function M(t,e,r,n,o){this.rateLimiter=t,this.api=e,this.logger=r,this.options=n,this.replayMap=o,this.predicates=[],this.pendingItems=[],this.pendingRequests=[],this.retryQueue=[],this.retryHandle=null,this.waitCallback=null,this.waitIntervalID=null}M.prototype.configure=function(t){this.api&&this.api.configure(t);var e=this.options;return this.options=s(e,t),this},M.prototype.addPredicate=function(t){return h(t)&&this.predicates.push(t),this},M.prototype.addPendingItem=function(t){this.pendingItems.push(t)},M.prototype.removePendingItem=function(t){var e=this.pendingItems.indexOf(t);-1!==e&&this.pendingItems.splice(e,1)},M.prototype.addItem=function(t,e,r,n){e&&h(e)||(e=function(){});var o=t.data,i=this._applyPredicates(o);if(i.stop)return this.removePendingItem(n),void e(i.err);if(this._maybeLog(o,r),this.removePendingItem(n),this.options.transmit){if(this.replayMap&&o.body){var a=function(t,e){for(var r=t.attributes||[],n=0;n<r.length;++n)if(r[n].key===e)return r[n].value}(o,"replay_id");a&&(t.replayId=this.replayMap.add(a,o.uuid))}this.pendingRequests.push(o);try{this._makeApiRequest(o,function(r,n,i){this._dequeuePendingRequest(o),!r&&n&&t.replayId&&this._handleReplayResponse(t.replayId,n,i),e(r,n)}.bind(this))}catch(t){this._dequeuePendingRequest(o),e(t)}}else e(new Error("Transmit disabled"))},M.prototype.wait=function(t){h(t)&&(this.waitCallback=t,this._maybeCallWait()||(this.waitIntervalID&&(this.waitIntervalID=clearInterval(this.waitIntervalID)),this.waitIntervalID=setInterval(function(){this._maybeCallWait()}.bind(this),500)))},M.prototype._applyPredicates=function(t){for(var e=null,r=0,n=this.predicates.length;r<n;r++)if(!(e=this.predicates[r](t,this.options))||void 0!==e.err)return{stop:!0,err:e.err};return{stop:!1,err:null}},M.prototype._makeApiRequest=function(t,e){var r=this.rateLimiter.shouldSend(t);r.shouldSend?this.api.postItem(t,function(r,n,o){r?this._maybeRetry(r,t,e):e(r,n,o)}.bind(this)):r.error?e(r.error):this.api.postItem(r.payload,e)};var C=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE","EAI_AGAIN"];M.prototype._maybeRetry=function(t,e,r){var n,o=!1;if(this.options.retryInterval){for(var i=0,a=C.length;i<a;i++)if(t.code===C[i]){o=!0;break}o&&(n=this.options.maxRetries,Number.isFinite(n))&&(e.retries=e.retries?e.retries+1:1,e.retries>this.options.maxRetries&&(o=!1))}o?this._retryApiRequest(e,r):r(t)},M.prototype._retryApiRequest=function(t,e){this.retryQueue.push({item:t,callback:e}),this.retryHandle||(this.retryHandle=setInterval(function(){for(;this.retryQueue.length;){var t=this.retryQueue.shift();this._makeApiRequest(t.item,t.callback)}}.bind(this),this.options.retryInterval))},M.prototype._dequeuePendingRequest=function(t){var e=this.pendingRequests.indexOf(t);-1!==e&&(this.pendingRequests.splice(e,1),this._maybeCallWait())},M.prototype._maybeLog=function(t,e){if(this.logger&&this.options.verbose){var r=e;if(r=(r=r||E(t,"body.trace.exception.message"))||E(t,"body.trace_chain.0.exception.message"))return void this.logger.error(r);(r=E(t,"body.message.body"))&&this.logger.log(r)}},M.prototype._maybeCallWait=function(){return!(!h(this.waitCallback)||0!==this.pendingItems.length||0!==this.pendingRequests.length)&&(this.waitIntervalID&&(this.waitIntervalID=clearInterval(this.waitIntervalID)),this.waitCallback(),!0)},M.prototype._handleReplayResponse=function(){var t,e=(t=R().mark((function t(e,r,n){return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.replayMap){t.next=3;break}return console.warn("Queue._handleReplayResponse: ReplayMap not available"),t.abrupt("return",!1);case 3:if(e){t.next=6;break}return console.warn("Queue._handleReplayResponse: No replayId provided"),t.abrupt("return",!1);case 6:if(t.prev=6,!this._shouldSendReplay(r,n)){t.next=13;break}return t.next=10,this.replayMap.send(e);case 10:return t.abrupt("return",t.sent);case 13:return this.replayMap.discard(e),t.abrupt("return",!1);case 15:t.next=21;break;case 17:return t.prev=17,t.t0=t.catch(6),console.error("Error handling replay response:",t.t0),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,this,[[6,17]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){q(i,n,o,a,s,"next",t)}function s(t){q(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t,r,n){return e.apply(this,arguments)}}(),M.prototype._shouldSendReplay=function(t,e){return!(0!==(null==t?void 0:t.err)||!e||"true"!==e["Rollbar-Replay-Enabled"]||"0"===e["Rollbar-Replay-RateLimit-Remaining"])};const A=M;function N(t,e){this.queue=t,this.options=e,this.transforms=[],this.diagnostic={}}N.prototype.configure=function(t){this.queue&&this.queue.configure(t);var e=this.options;return this.options=s(e,t),this},N.prototype.addTransform=function(t){return h(t)&&this.transforms.push(t),this},N.prototype.log=function(t,e){if(e&&h(e)||(e=function(){}),!this.options.enabled)return e(new Error("Rollbar is not enabled"));this.queue.addPendingItem(t);var r=t.err;this._applyTransforms(t,function(n,o){if(n)return this.queue.removePendingItem(t),e(n,null);this.queue.addItem(o,e,r,t)}.bind(this))},N.prototype._applyTransforms=function(t,e){var r=-1,n=this.transforms.length,o=this.transforms,i=this.options,a=function(t,s){t?e(t,null):++r!==n?o[r](s,i,a):e(null,s)};a(null,t)};const U=N;function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function F(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return H(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function G(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J(n.key),n)}}function J(t){var e=function(t,e){if("object"!=D(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==D(e)?e:e+""}var B=function(){return t=function t(e,r){var n,o,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o="maxAdjustedCount",i=Math.pow(2,56),(o=J(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,this.config=e||{},this.triggers=(null==e?void 0:e.triggers)||[],this.context=r||{},this.predicates={occurrence:[this.isLevelMatching.bind(this),this.isSampled.bind(this)]}},e=[{key:"isEnabledForTriggerType",value:function(t){var e,r=this.predicates[t],n=F(this.triggers);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.type===t&&this.isEnabledForTrigger(o,r))return!0}}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"isEnabledForTrigger",value:function(t,e){return!e.find((function(e){return!e(t)}))}},{key:"isLevelMatching",value:function(t){var e,r;return!(t.level&&(null===(e=t.level)||void 0===e||!e.includes(null===(r=this.context)||void 0===r||null===(r=r.item)||void 0===r?void 0:r.level)))}},{key:"isSampled",value:function(t){var e=t.samplingRatio||this.config.baseSamplingRatio||1;return 1==e||this.context.replayId.slice(-14)>=(this.maxAdjustedCount*(1-e)).toString(16).padStart(14,"0")}}],e&&G(t.prototype,e),r&&G(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function W(t,e,r,n,o,i,a){this.options=s(t),this.logger=r,W.rateLimiter.configureGlobal(this.options),W.rateLimiter.setPlatformOptions(a,this.options),this.api=e,this.queue=new A(W.rateLimiter,e,r,this.options,i),this.tracing=o;var u=this.options.tracer||null;Q(u)?(this.tracer=u,this.options.tracer="opentracing-tracer-enabled",this.options._configuredOptions.tracer="opentracing-tracer-enabled"):this.tracer=null,this.notifier=new U(this.queue,this.options),this.telemeter=n,z(t),this.lastError=null,this.lastErrorHash="none"}function z(t){t.stackTraceLimit&&(Error.stackTraceLimit=t.stackTraceLimit)}function Q(t){if(!t)return!1;if(!t.scope||"function"!=typeof t.scope)return!1;var e=t.scope();return!(!e||!e.active||"function"!=typeof e.active)}W.rateLimiter=new P({maxItems:0,itemsPerMinute:60}),W.prototype.global=function(t){return W.rateLimiter.configureGlobal(t),this},W.prototype.configure=function(t,e){var r=this.options,n={};e&&(n={payload:e}),this.options=s(r,t,n);var o=this.options.tracer||null;return Q(o)?(this.tracer=o,this.options.tracer="opentracing-tracer-enabled",this.options._configuredOptions.tracer="opentracing-tracer-enabled"):this.tracer=null,this.notifier&&this.notifier.configure(this.options),this.telemeter&&this.telemeter.configure(this.options),z(t),this.global(this.options),Q(t.tracer)&&(this.tracer=t.tracer),this},W.prototype.log=function(t){var e=this._defaultLogLevel();return this._log(e,t)},W.prototype.debug=function(t){this._log("debug",t)},W.prototype.info=function(t){this._log("info",t)},W.prototype.warn=function(t){this._log("warning",t)},W.prototype.warning=function(t){this._log("warning",t)},W.prototype.error=function(t){this._log("error",t)},W.prototype.critical=function(t){this._log("critical",t)},W.prototype.wait=function(t){this.queue.wait(t)},W.prototype.captureEvent=function(t,e,r){return this.telemeter&&this.telemeter.captureEvent(t,e,r)},W.prototype.captureDomContentLoaded=function(t){return this.telemeter&&this.telemeter.captureDomContentLoaded(t)},W.prototype.captureLoad=function(t){return this.telemeter&&this.telemeter.captureLoad(t)},W.prototype.buildJsonPayload=function(t){return this.api.buildJsonPayload(t)},W.prototype.sendJsonPayload=function(t){this.api.postJsonPayload(t)},W.prototype._log=function(t,e){var r;if(e.callback&&(r=e.callback,delete e.callback),this.options.ignoreDuplicateErrors&&this._sameAsLastError(e)){if(r){var n=new Error("ignored identical item");n.item=e,r(n)}}else try{e.level=e.level||t;var o=this._replayIdIfTriggered(e);this._addTracingAttributes(e,o),this._addTracingInfo(e);var i=this.telemeter;i&&(i._captureRollbarItem(e),e.telemetryEvents=i.copyEvents()||[],i.telemetrySpan&&(i.telemetrySpan.end({"rollbar.replay.id":o}),i.telemetrySpan=i.tracing.startSpan("rollbar-telemetry",{}))),this.notifier.log(e,r)}catch(t){r&&r(t),this.logger.error(t)}},W.prototype._addTracingAttributes=function(t,e){var r,n,o=null===(r=this.tracing)||void 0===r?void 0:r.getSpan(),i=[{key:"replay_id",value:e},{key:"session_id",value:null===(n=this.tracing)||void 0===n?void 0:n.sessionId},{key:"span_id",value:null==o?void 0:o.spanId},{key:"trace_id",value:null==o?void 0:o.traceId}];!function(t,e){t.attributes=t.attributes||[];var r,n=u(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;void 0!==o.value&&t.attributes.push(o)}}catch(t){n.e(t)}finally{n.f()}}(t.data,i),null==o||o.addEvent("rollbar.occurrence",[{key:"rollbar.occurrence.uuid",value:t.uuid}])},W.prototype._replayIdIfTriggered=function(t){var e,r=null===(e=this.tracing)||void 0===e?void 0:e.idGen(8);if(new B(this.options.recorder,{item:t,replayId:r}).isEnabledForTriggerType("occurrence"))return r},W.prototype._defaultLogLevel=function(){return this.options.logLevel||"debug"},W.prototype._sameAsLastError=function(t){if(!t._isUncaught)return!1;var e=function(t){var e=t.message||"",r=(t.err||{}).stack||String(t.err);return e+"::"+r}(t);return this.lastErrorHash===e||(this.lastError=t.err,this.lastErrorHash=e,!1)},W.prototype._addTracingInfo=function(t){if(this.tracer){var e=this.tracer.scope().active();if(function(t){if(!t||!t.context||"function"!=typeof t.context)return!1;var e=t.context();if(!e||!e.toSpanId||!e.toTraceId||"function"!=typeof e.toSpanId||"function"!=typeof e.toTraceId)return!1;return!0}(e)){e.setTag("rollbar.error_uuid",t.uuid),e.setTag("rollbar.has_error",!0),e.setTag("error",!0),e.setTag("rollbar.item_url","https://rollbar.com/item/uuid/?uuid=".concat(t.uuid)),e.setTag("rollbar.occurrence_url","https://rollbar.com/occurrence/uuid/?uuid=".concat(t.uuid));var r=e.context().toSpanId(),n=e.context().toTraceId();t.custom?(t.custom.opentracing_span_id=r,t.custom.opentracing_trace_id=n):t.custom={opentracing_span_id:r,opentracing_trace_id:n}}}};const $=W;function V(t){if(!p(t.context,"string")){var e=y(t.context);e.error?t.context="Error: could not serialize 'context'":t.context=e.value||"",t.context.length>255&&(t.context=t.context.substr(0,255))}return{data:t}}function Y(t,e,r){var n=e.hostname,o=e.protocol,i=e.port,a=e.path,s=e.search,u=t.timeout,c=function(t){var e="undefined"!=typeof window&&window||"undefined"!=typeof self&&self,r=t.defaultTransport||"xhr";void 0===e.fetch&&(r="xhr");void 0===e.XMLHttpRequest&&(r="fetch");return r}(t),l=t.proxy;if(t.endpoint){var p=r.parse(t.endpoint);n=p.hostname,o=p.protocol,i=p.port,a=p.pathname,s=p.search}return{timeout:u,hostname:n,protocol:o,port:i,path:a,search:s,proxy:l,transport:c}}function X(t,e){var r=t.protocol||"https:",n=t.port||("http:"===r?80:"https:"===r?443:void 0),o=t.hostname,i=t.path,a=t.timeout,s=t.transport;return t.search&&(i+=t.search),t.proxy&&(i=r+"//"+o+i,o=t.proxy.host||t.proxy.hostname,n=t.proxy.port,r=t.proxy.protocol||r),{timeout:a,protocol:r,hostname:o,path:i,port:n,method:e,transport:s}}function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){et(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function et(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=K(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==K(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rt(){rt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof v?e:v,a=Object.create(i.prototype),s=new P(n||[]);return o(a,"_invoke",{value:I(t,r,s)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",m="completed",y={};function v(){}function g(){}function b(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(j([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=b.prototype=v.prototype=Object.create(w);function k(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var u=p(t[o],t,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==K(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function I(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=L(s,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?m:h,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(K(e)+" is not iterable")}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),c(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(E),c(E,u,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=j,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:j(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function nt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}var ot={hostname:"api.rollbar.com",path:"/api/1/item/",search:null,version:"1",protocol:"https:",port:443},it={hostname:"api.rollbar.com",path:"/api/1/session/",search:null,version:"1",protocol:"https:",port:443};function at(t,e,r,n){this.options=t,this.transport=e,this.url=r,this.truncation=n,this.accessToken=t.accessToken,this.transportOptions=st(t,r),this.OTLPTransportOptions=ut(t,r)}function st(t,e){return Y(t,ot,e)}function ut(t,e){var r;return Y(t=tt(tt({},t),{},{endpoint:null===(r=t.tracing)||void 0===r?void 0:r.endpoint}),it,e)}at.prototype._postPromise=function(t){var e=t.accessToken,r=t.transportOptions,n=t.payload,o=this;return new Promise((function(t,i){o.transport.post(e,r,n,(function(e,r){return e?i(e):t(r)}))}))},at.prototype.postItem=function(t,e){var r=X(this.transportOptions,"POST"),n=V(t),o=this;setTimeout((function(){o.transport.post(o.accessToken,r,n,e)}),0)},at.prototype.postSpans=function(){var t,e=(t=rt().mark((function t(e){var r;return rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=X(this.OTLPTransportOptions,"POST"),t.next=3,this._postPromise({accessToken:this.accessToken,transportOptions:r,payload:e});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){nt(i,n,o,a,s,"next",t)}function s(t){nt(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}(),at.prototype.buildJsonPayload=function(t,e){var r,n=V(t);return(r=this.truncation?this.truncation.truncate(n):y(n)).error?(e&&e(r.error),null):r.value},at.prototype.postJsonPayload=function(t,e){var r=X(this.transportOptions,"POST");this.transport.postJsonPayload(this.accessToken,r,t,e)},at.prototype.configure=function(t){var e=this.oldOptions;return this.options=s(e,t),this.transportOptions=st(this.options,this.url),this.OTLPTransportOptions=ut(this.options,this.url),void 0!==this.options.accessToken&&(this.accessToken=this.options.accessToken),this};const ct=at;var lt=!0;const pt={log:function(){lt&&console.log.apply(console,arguments)},error:function(){lt&&console.error.apply(console,arguments)},setVerbose:function(t){lt=t}};var ft="3.0.0-alpha.5",ht="debug";function dt(t){return function(t){if(Array.isArray(t))return mt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return mt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var yt=["authorization","www-authorization","http_authorization","omniauth.auth","cookie","oauth-access-token","x-access-token","x_csrf_token","http_x_csrf_token","x-csrf-token"],vt=[].concat(dt(["pw","pass","passwd","password","secret","confirm_password","confirmPassword","password_confirmation","passwordConfirmation","access_token","accessToken","X-Rollbar-Access-Token","secret_key","secretKey","secretToken"]),dt(["api_key","authenticity_token","oauth_token","token","user_session_secret"]),dt(["request.session.csrf","request.session._csrf","request.params._csrf","request.cookie","request.cookies"]));const gt=function(t,e,r){var n,o,i,a,s=p(t,"object"),u=p(t,"array"),c=[];if(r=r||{obj:[],mapped:[]},s){if(a=r.obj.indexOf(t),s&&-1!==a)return r.mapped[a]||r.obj[a];r.obj.push(t),a=r.obj.length-1}if(s)for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&c.push(n);else if(u)for(i=0;i<t.length;++i)c.push(i);var l=s?{}:[],f=!0;for(i=0;i<c.length;++i)o=t[n=c[i]],l[n]=e(n,o,r),f=f&&l[n]===t[n];return s&&!f&&(r.mapped[a]=l),f?t:l};function bt(t,e){return[t,y(t,e)]}function wt(t,e){var r=t.length;return r>2*e?t.slice(0,e).concat(t.slice(r-e)):t}function xt(t,e,r){r=void 0===r?30:r;var n,o=t.data.body;if(o.trace_chain)for(var i=o.trace_chain,a=0;a<i.length;a++)n=wt(n=i[a].frames,r),i[a].frames=n;else o.trace&&(n=wt(n=o.trace.frames,r),o.trace.frames=n);return[t,y(t,e)]}function _t(t,e){return e&&e.length>t?e.slice(0,t-3).concat("..."):e}function Et(t,e,r){return e=gt(e,(function e(r,n,o){switch(f(n)){case"string":return _t(t,n);case"object":case"array":return gt(n,e,o);default:return n}})),[e,y(e,r)]}function kt(t){return t.exception&&(delete t.exception.description,t.exception.message=_t(255,t.exception.message)),t.frames=wt(t.frames,1),t}function St(t,e){var r=t.data.body;if(r.trace_chain)for(var n=r.trace_chain,o=0;o<n.length;o++)n[o]=kt(n[o]);else r.trace&&(r.trace=kt(r.trace));return[t,y(t,e)]}function It(t,e){return function(t){for(var e=0,r=t.length,n=0;n<r;n++){var o=t.charCodeAt(n);o<128?e+=1:o<2048?e+=2:o<65536&&(e+=3)}return e}(t)>e}const Lt={truncate:function(t,e,r){r=void 0===r?524288:r;for(var n,o,i,a=[bt,xt,Et.bind(null,1024),Et.bind(null,512),Et.bind(null,256),St];n=a.shift();)if(t=(o=n(t,e))[0],(i=o[1]).error||!It(i.value,r))return i;return i},raw:bt,truncateFrames:xt,truncateStrings:Et,maybeTruncateValue:_t},Ot=require("http"),Tt=require("https"),Pt=require("json-stringify-safe");function jt(){this.rateLimitExpires=0}function Rt(t,e,r){var n=e&&e.headers||{};if(n["Content-Type"]="application/json",r)try{n["Content-Length"]=Buffer.byteLength(r,"utf8")}catch(t){pt.error("Could not get the content length of the data")}return n["X-Rollbar-Access-Token"]=t,n}function qt(t){return{"http:":Ot,"https:":Tt}[t.protocol]}function Mt(){return Math.floor(Date.now()/1e3)}jt.prototype.get=function(t,e,r,n,o){var i;if(n&&h(n)||(n=function(){}),function(t,e,r){(r=r||{}).access_token=t;var n,o=[];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&o.push([n,r[n]].join("="));var i="?"+o.sort().join("&");(e=e||{}).path=e.path||"";var a,s=e.path.indexOf("?"),u=e.path.indexOf("#");-1!==s&&(-1===u||u>s)?(a=e.path,e.path=a.substring(0,s)+i+"&"+a.substring(s+1)):-1!==u?(a=e.path,e.path=a.substring(0,u)+i+a.substring(u)):e.path=e.path+i}(t,e=e||{},r),e.headers=Rt(t,e),!(i=o?o(e):qt(e)))return pt.error("Unknown transport based on given protocol: "+e.protocol),n(new Error("Unknown transport"));var a=i.request(e,function(t){this.handleResponse(t,n)}.bind(this));a.on("error",(function(t){n(t)})),a.end()},jt.prototype.post=function(t,e,r,n,o){var i;if(n&&h(n)||(n=function(){}),Mt()<this.rateLimitExpires)return n(new Error("Exceeded rate limit"));if(e=e||{},!r)return n(new Error("Cannot send empty request"));var a=Lt.truncate(r,Pt);if(a.error)return pt.error("Problem stringifying payload. Giving up"),n(a.error);var s=a.value;if(e.headers=Rt(t,e,s),!(i=o?o(e):qt(e)))return pt.error("Unknown transport based on given protocol: "+e.protocol),n(new Error("Unknown transport"));var u=i.request(e,function(t){this.handleResponse(t,function(t){return function(e,r){if(e)return t(e);r.result&&r.result.uuid?pt.log(["Successful api response."," Link: https://rollbar.com/occurrence/uuid/?uuid="+r.result.uuid].join("")):pt.log("Successful api response"),t(null,r.result)}}(n))}.bind(this));u.on("error",(function(t){n(t)})),s&&u.write(s),u.end()},jt.prototype.updateRateLimit=function(t){var e=parseInt(t.headers["x-rate-limit-remaining"]||0),r=Math.min(60,t.headers["x-rate-limit-remaining-seconds"]||0),n=Mt();429===t.statusCode&&0===e?this.rateLimitExpires=n+r:this.rateLimitExpires=n},jt.prototype.handleResponse=function(t,e){this.updateRateLimit(t);var r=[];t.setEncoding("utf8"),t.on("data",(function(t){r.push(t)})),t.on("end",(function(){!function(t,e){var r=function(t){var e,r;try{e=JSON.parse(t)}catch(t){r=t}return{error:r,value:e}}(t);if(r.error)return pt.error("Could not parse api response, err: "+r.error),e(r.error);if((t=r.value).err)return pt.error("Received error: "+t.message),e(new Error("Api error: "+(t.message||"Unknown error")));e(null,t)}(r=r.join(""),e)}))};const Ct=jt,At=require("url");var Nt=["otelAttributes"];var Ut=100;function Dt(t){return[Math.trunc(t/1e3),Math.round(t%1e3*1e6)]}function Ft(t,e){var r;this.queue=[],this.options=s(t);var n=this.options.maxTelemetryEvents||Ut;this.maxQueueSize=Math.max(0,Math.min(n,Ut)),this.tracing=e,this.telemetrySpan=null===(r=this.tracing)||void 0===r?void 0:r.startSpan("rollbar-telemetry",{})}function Ht(t,e){if(e)return e;return{error:"error",manual:"info"}[t]||"info"}Ft.prototype.configure=function(t){var e=this.options;this.options=s(e,t);var r=this.options.maxTelemetryEvents||Ut,n=Math.max(0,Math.min(r,Ut)),o=0;this.queue.length>n&&(o=this.queue.length-n),this.maxQueueSize=n,this.queue.splice(0,o)},Ft.prototype.copyEvents=function(){var t=Array.prototype.slice.call(this.queue,0);if(h(this.options.filterTelemetry))try{for(var e=t.length;e--;)this.options.filterTelemetry(t[e])&&t.splice(e,1)}catch(t){this.options.filterTelemetry=null}return t=t.map((function(t){t.otelAttributes;var e=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(-1!==e.indexOf(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],-1===e.indexOf(r)&&{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,Nt);return e})),t},Ft.prototype.capture=function(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a={level:Ht(t,r),type:t,timestamp_ms:o||S(),body:e,source:"client"};n&&(a.uuid=n),i&&(a.otelAttributes=i);try{if(h(this.options.filterTelemetry)&&this.options.filterTelemetry(a))return!1}catch(t){this.options.filterTelemetry=null}return this.push(a),a},Ft.prototype.captureEvent=function(t,e,r,n){return this.capture(t,e,r,n)},Ft.prototype.captureError=function(t,e,r,n){var o,i=t.message||String(t),a={message:i};t.stack&&(a.stack=t.stack);var s={message:i,level:e,type:"error",uuid:r};return null===(o=this.telemetrySpan)||void 0===o||o.addEvent("rollbar-occurrence-event",s,Dt(n)),this.capture("error",a,e,r,n,s)},Ft.prototype.captureLog=function(t,e,r,n){var o,i,a=null;r?(a={message:t,level:e,type:"message",uuid:r},null===(o=this.telemetrySpan)||void 0===o||o.addEvent("rollbar-occurrence-event",a,Dt(n))):(a={message:t,level:e},null===(i=this.telemetrySpan)||void 0===i||i.addEvent("rollbar-log-event",a,Dt(n)));return this.capture("log",{message:t},e,r,n,a)},Ft.prototype.captureNetwork=function(t,e,r,n){var o,i;e=e||"xhr",t.subtype=t.subtype||e,n&&(t.request=n);var a=this.levelFromStatus(t.status_code),s=1e6*(t.end_time_ms||0),u={type:t.subtype,method:t.method,url:t.url,statusCode:t.status_code,"request.headers":JSON.stringify(t.request_headers||{}),"response.headers":JSON.stringify((null===(o=t.response)||void 0===o?void 0:o.headers)||{}),"response.timeUnixNano":s.toString()};return null===(i=this.telemetrySpan)||void 0===i||i.addEvent("rollbar-network-event",u,Dt(t.start_time_ms)),this.capture("network",t,a,r,t.start_time_ms,u)},Ft.prototype.levelFromStatus=function(t){return t>=200&&t<400?"info":0===t||t>=400?"error":"info"},Ft.prototype.captureDom=function(t,e,r,n,o){var i={subtype:t,element:e};return void 0!==r&&(i.value=r),void 0!==n&&(i.checked=n),this.capture("dom",i,"info",o)},Ft.prototype.captureNavigation=function(t,e,r,n){var o;return null===(o=this.telemetrySpan)||void 0===o||o.addEvent("rollbar-navigation-event",{"previous.url.full":t,"url.full":e},Dt(n)),this.capture("navigation",{from:t,to:e},"info",r,n)},Ft.prototype.captureDomContentLoaded=function(t){return this.capture("navigation",{subtype:"DOMContentLoaded"},"info",void 0,t&&t.getTime())},Ft.prototype.captureLoad=function(t){return this.capture("navigation",{subtype:"load"},"info",void 0,t&&t.getTime())},Ft.prototype.captureConnectivityChange=function(t,e){return this.captureNetwork({change:t},"connectivity",e)},Ft.prototype._captureRollbarItem=function(t){if(this.options.includeItemsInTelemetry)return t.err?this.captureError(t.err,t.level,t.uuid,t.timestamp):t.message?this.captureLog(t.message,t.level,t.uuid,t.timestamp):t.custom?this.capture("log",t.custom,t.level,t.uuid,t.timestamp):void 0},Ft.prototype.push=function(t){this.queue.push(t),this.queue.length>this.maxQueueSize&&this.queue.shift()};const Gt=Ft;const Jt=function(t,e,r,n,o){var i=t[e];t[e]=r(i),n&&n[o].push([t,e,i])};function Bt(t){var e={protocol:t.protocol,hostname:"string"==typeof t.hostname&&t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname,hash:t.hash,search:t.search,pathname:t.pathname,path:"".concat(t.pathname||"").concat(t.search||""),href:t.href};return""!==t.port&&(e.port=Number(t.port)),(t.username||t.password)&&(e.auth="".concat(t.username,":").concat(t.password)),e}function Wt(t){var e=t.protocol||"http:";return e+="//",t.auth&&(e+="".concat(t.auth,"@")),e+=t.hostname||t.host||"localhost",t.port&&(e+=":".concat(t.port)),e+=t.path||"/"}var zt={network:!0,networkResponseHeaders:!1,networkRequestHeaders:!1,log:!0};function Qt(t,e,r){this.options=t;var n=t.autoInstrument;!1===t.enabled||!1===n?this.autoInstrument={}:(p(n,"object")||(n=zt),this.autoInstrument=s(zt,n)),this.telemeter=e,this.rollbar=r,this.diagnostic=r.client.notifier.diagnostic,this.replacements={network:[],log:[]}}function $t(t){var e=this.telemeter,r=this;return function(n,o,i){var a=function(t,e,r){if("string"==typeof t){var n=t;t=Bt(new At.URL(n))}else t&&t instanceof At.URL?t=Bt(t):(r=e,e=t,t=null);return"function"==typeof e?(r=e,e=t||{}):e=s(t||{},e),{options:e,cb:r}}(n,o,i),u={method:a.options.method||"GET",url:Wt(a.options),status_code:null,start_time_ms:S(),end_time_ms:null};r.autoInstrument.networkRequestHeaders&&(u.request_headers=a.options.headers),e.captureNetwork(u,"http");var c=Array.from(arguments),l=function(t,e,r){return function(n){if(e.end_time_ms=S(),e.status_code=n.statusCode,e.response={},t.networkResponseHeaders&&(e.response.headers=n.headers),r)return r.apply(void 0,arguments)}}(r.autoInstrument,u,a.cb);a.cb&&c.pop(),c.push(l);var p=t.apply(Tt,c);return p.on("error",(function(t){u.status_code=0,u.error=[t.name,t.message].join(": ")})),p}}function Vt(t,e){for(var r;t[e].length;)(r=t[e].shift())[0][r[1]]=r[2]}Qt.prototype.configure=function(t){this.options=s(this.options,t);var e=t.autoInstrument,r=s(this.autoInstrument);!1===t.enabled||!1===e?this.autoInstrument={}:(p(e,"object")||(e=zt),this.autoInstrument=s(zt,e)),this.instrument(r)},Qt.prototype.instrument=function(t){!this.autoInstrument.network||t&&t.network?!this.autoInstrument.network&&t&&t.network&&this.deinstrumentNetwork():this.instrumentNetwork(),!this.autoInstrument.log||t&&t.log?!this.autoInstrument.log&&t&&t.log&&this.deinstrumentConsole():this.instrumentConsole()},Qt.prototype.deinstrumentNetwork=function(){Vt(this.replacements,"network")},Qt.prototype.instrumentNetwork=function(){Jt(Ot,"request",$t.bind(this),this.replacements,"network"),Jt(Tt,"request",$t.bind(this),this.replacements,"network")},Qt.prototype.captureNetwork=function(t,e,r){return this.telemeter.captureNetwork(t,e,r)},Qt.prototype.deinstrumentConsole=function(){Vt(this.replacements,"log")},Qt.prototype.instrumentConsole=function(){var t=this.telemeter,e=process.stdout;Jt(e,"write",(function(r){return function(n){return t.captureLog(n,"info"),r.apply(e,arguments)}}),this.replacements,"log");var r=process.stderr;Jt(r,"write",(function(e){return function(n){return t.captureLog(n,"error"),e.apply(r,arguments)}}),this.replacements,"log")};const Yt=Qt,Xt=require("async"),Kt=require("fs"),Zt=require("lru-cache"),te=require("source-map"),ee=require("path");var re={},ne={},oe={},ie=/^data:application\/json[^,]+base64,/;function ae(t){if(t=t.trim(),/^file:/.test(t)&&(t=t.replace(/file:\/\/\/(\w:)?/,(function(t,e){return e?"":"/"}))),t in re)return re[t];var e="";try{Kt.existsSync(t)&&(e=Kt.readFileSync(t,"utf8"))}catch(t){}return re[t]=e}function se(t,e){if(!t)return e;var r=ee.dirname(t),n=/^\w+:\/\/[^\/]*/.exec(r),o=n?n[0]:"",i=r.slice(o.length);return o&&/^\/\w\:/.test(i)?(o+="/")+ee.resolve(r.slice(o.length),e).replace(/\\/g,"/"):o+ee.resolve(r.slice(o.length),e)}function ue(t){var e,r=function(t){var e;e=ae(t);for(var r,n,o=/(?:\/\/[@#][ \t]+sourceMappingURL=([^\s'"]+?)[ \t]*$)|(?:\/\*[@#][ \t]+sourceMappingURL=([^\*]+?)[ \t]*(?:\*\/)[ \t]*$)/gm;n=o.exec(e);)r=n;return r?r[1]:null}(t);if(!r)return null;if(ie.test(r)){var n=r.slice(r.indexOf(",")+1);e=Buffer.from(n,"base64").toString(),r=t}else e=ae(r=se(t,r));return e?{url:r,map:e}:null}function ce(t,e){var r=ne[t.source];if(!r){var n=ue(t.source);n?(r=ne[t.source]={url:n.url,map:new te.SourceMapConsumer(n.map)},e.node_source_maps.source_mapping_urls[t.source]=n.url,r.map.sourcesContent&&r.map.sources.forEach((function(t,e){var n=r.map.sourcesContent[e];if(n){var o=se(r.url,t);re[o]=n}}))):(r=ne[t.source]={url:null,map:null},e.node_source_maps.source_mapping_urls[t.source]="not found")}if(r&&r.map&&"function"==typeof r.map.originalPositionFor){var o=r.map.originalPositionFor(t);if(null!==o.source){var i=o.source;return o.source=se(r.url,o.source),function(t,e,r){oe[r]||(oe[r]=t.map.sourceContentFor(e,!0))}(r,i,o.source),o}}return t}function le(t){return oe[t]}function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}var fe=/^\s*at (?:([^(]+(?: \[\w\s+\])?(?:.*\)*)) )?\(?(.+?)(?::(\d+):(\d+)(?:, <js>:(\d+):(\d+))?)?\)?$/,he=/^\s*at .+ \(.+ (at[^)]+\))\)$/,de=/^\s*(>?) [0-9]+\|(\s*.+)$/m,me=new Zt({max:100}),ye={};function ve(t,e){var r,n,o,i,a;if((r=(n=t).match(he))&&(n=r[1]),!(r=n.match(fe)))return e(null,null);var s={source:(o=r.slice(1))[1],line:Math.floor(o[2]),column:Math.floor(o[3])-1};a=this.useSourceMaps?function(t,e){return ce({source:t.source,line:t.line,column:t.column},e)}(s,this.diagnostic):s,i={method:o[0]||"<unknown>",filename:a.source,lineno:a.line,colno:a.column,runtimePosition:s},o[4]&&(i.compiled_lineno=Math.floor(o[4])),o[5]&&(i.compiled_colno=Math.floor(o[5])),e(null,i)}function ge(t,e){var r,n;r="/"===t[0]||"."===t[0],n=!!me.get(t),e(null,r&&!n&&!!!ye[t])}function be(t,e){if(le(t))return e(null,!0);Kt.stat(t,(function(t){e(null,!t)}))}function we(t,e){var r=[];t.forEach((function(t){-1===r.indexOf(t.filename)&&r.push(t.filename)})),Xt.filter(r,ge,(function(r,n){if(r)return e(r);var o;function i(t,e){o[t]=e,me.set(t,e)}function a(t,e){var r=le(t);if(r)try{var n=r.split("\n");return i(t,n),e(null)}catch(t){return e(t)}!function(t,e){try{Kt.readFile(t,(function(t,r){var n;return t?e(t):(n=r.toString("utf8").split("\n"),e(null,n))}))}catch(t){pt.log(t)}}(t,(function(r,n){return r?e(r):(i(t,n),e(null))}))}function s(t,e){var r=o[t.filename]||me.get(t.filename);r&&function(t,e){t.code=e[t.lineno-1],t.context={pre:e.slice(Math.max(0,t.lineno-4),t.lineno-1),post:e.slice(t.lineno,t.lineno+3)}}(t,r),e(null)}o={},Xt.filter(n,be,(function(r,n){if(r)return e(r);Xt.each(n,a,(function(r){if(r)return e(r);Xt.eachSeries(t,s,(function(r){if(r)return e(r);e(null,t)}))}))}))}))}function xe(t,e,n,o){var i=function(t){var e,n;if(null==t)return null;if("object"!==pe(t))return null;if(r.isArray(t))return t;for(n in e=[],t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(t[n]);return e}(t.errors);return function(t,e,r,n){var o,i=t;for(;"object"===pe(i);)i=i&&i.stack;o=(i||"").split("\n").slice(1),e.nodeSourceMaps&&(r.diagnostic.node_source_maps={},r.diagnostic.node_source_maps.source_mapping_urls={});Xt.map(o,ve.bind({useSourceMaps:e.nodeSourceMaps,diagnostic:r.diagnostic}),(function(t,e){if(t)return n(t);e.reverse(),Xt.filter(e,(function(t,e){e(null,!!t)}),(function(t,e){if(t)return n(t);we(e,n)}))}))}(t.stack,e,n,(function(e,r){var a,s,u,c,l;return e?(pt.error("could not parse exception, err: "+e),o(e)):(a=String(t.message||"<no message>"),s=String(t.name||"<unknown>"),u={class:s,message:a,frames:r},i&&i.length&&(c=i[0],u={class:s,message:String(c.message||"<no message>"),frames:r}),a.match(de)&&(l=function(t){var e,r,n,o,i,a,s,u,c,l,p;for(r=(e=t.split("\n"))[0].indexOf(":"),n=e[0].slice(0,r),o=parseInt(e[0].slice(r+1),10),a=e[(i=e.length)-1],e=e.slice(1,i-1),c=[],l=[],s=0;s<i-2;++s)(p=e[s].match(de))&&(">"===p[1]?u=p[2]:u?p[2]&&l.push(p[2]):p[2]&&c.push(p[2]));return{frame:{method:"<jade>",filename:n,lineno:o,code:u,context:{pre:c=c.slice(0,Math.min(c.length,3)),post:l=l.slice(0,Math.min(l.length,3))}},message:a}}(a),u.message=l.message,u.frames.push(l.frame)),n.localsMap?void n.notifier.locals.mergeLocals(n.localsMap,r,t.stack,(function(t){return t&&(pt.error("could not parse locals, err: "+t),n.diagnostic["error parsing locals"]=t),o(null,u)})):o(null,u))}))}const _e=require("request-ip");function Ee(t,e){var r=e.split("."),n=r.length-1;try{for(var o=0;o<=n;++o)o<n?t=t[r[o]]:t[r[o]]="********"}catch(t){}}const ke=function(t,e,r){if(e=e||[],r)for(var n=0;n<r.length;++n)Ee(t,r[n]);var o=function(t){for(var e,r=[],n=0;n<t.length;++n)e="^\\[?(%5[bB])?"+t[n]+"\\[?(%5[bB])?\\]?(%5[dD])?$",r.push(new RegExp(e,"i"));return r}(e),i=function(t){for(var e,r=[],n=0;n<t.length;++n)e="\\[?(%5[bB])?"+t[n]+"\\[?(%5[bB])?\\]?(%5[dD])?",r.push(new RegExp("("+e+"=)([^&\\n]+)","igm"));return r}(e);function a(t,e){return e+"********"}return gt(t,(function t(e,r,n){var s=function(t,e){var r;for(r=0;r<o.length;++r)if(o[r].test(t)){e="********";break}return e}(e,r);return s===r?p(r,"object")||p(r,"array")?gt(r,t,n):function(t){var e;if(p(t,"string"))for(e=0;e<i.length;++e)t=t.replace(i[e],a);return t}(s):s}))};function Se(t,e,r){var n=e.payload&&e.payload.environment||e.environment,o={timestamp:Math.round(t.timestamp/1e3),environment:t.environment||n,level:t.level||"error",language:"javascript",framework:t.framework||e.framework,uuid:t.uuid,notifier:JSON.parse(JSON.stringify(e.notifier)),custom:t.custom};e.codeVersion?o.code_version=e.codeVersion:e.code_version&&(o.code_version=e.code_version),Object.getOwnPropertyNames(t.custom||{}).forEach((function(e){o.hasOwnProperty(e)||(o[e]=t.custom[e])})),o.server={host:e.host,argv:process.argv.concat(),pid:process.pid},e.branch&&(o.server.branch=e.branch),e.root&&(o.server.root=e.root),t.data=o,r(null,t)}function Ie(t,e,r){t.stackInfo?function(t,e,r){t.stackInfo&&(t.data=t.data||{},t.data.body=t.data.body||{},t.data.body.trace_chain=t.stackInfo),r(null,t)}(t,0,r):function(t,e,r){t.data=t.data||{},t.data.body=t.data.body||{};var n=t.message||"Item sent with null or missing arguments.";t.data.body.message={body:n},r(null,t)}(t,0,r)}function Le(t,e,r){if(!t.err)return r(null,t);var n=t.err,o=[],i=[];do{o.push(n),n=n.nested||n.cause}while(n);t.stackInfo=i,e.addErrorContext&&function(t,e){var r=t.data.custom||{},n=!1;try{for(var o=0;o<e.length;++o)e[o].hasOwnProperty("rollbarContext")&&(r=s(r,g(e[o].rollbarContext)),n=!0);n&&(t.data.custom=r)}catch(e){t.diagnostic.error_context="Failed: "+e.message}}(t,o);Xt.eachSeries(o,function(t,e,r){return function(n,o){xe(n,e,r,(function(e,r){return e?o(e):(t.push({frames:r.frames,exception:{class:r.class,message:r.message}}),o(null))}))}}(i,e,t),(function(e){e&&(t.message=t.err.message||t.err.description||t.message||String(t.err),t.diagnostic.buildTraceData=e.message,delete t.stackInfo),r(null,t)}))}function Oe(t,e,r){t.data=t.data||{};var n=t.request;if(n){var o=n.baseUrl||"";if(e.addRequestData&&h(e.addRequestData))return e.addRequestData(t.data,n),void r(null,t);var i,a=function(t){var e,r=t.headers||{},n=r.host||"<no host>",o=t.protocol||(t.socket&&t.socket.encrypted?"https":"http"),i=t.baseUrl||"";if(p(t.url,"string")){var a=i&&i.length?i+t.url:t.url;e=At.parse(a,!0)}else e=t.url||{};e.protocol=e.protocol||o,e.host=e.host||n;var s={url:At.format(e),user_ip:Re(t),headers:r,method:t.method};e.search&&e.search.length>0&&(s.GET=e.query);var u=t.body||t.payload;if(u){var c={};if("object"===(h=f(u))||"array"===h){for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&(c[l]=u[l]);s[t.method]=c}else s.body=u}var h;return s}(n);if(function(t,e){if(t&&t.user_ip&&!0!==e){var r=t.user_ip;if(e)try{var n;if(-1!==r.indexOf("."))(n=r.split(".")).pop(),n.push("0"),r=n.join(".");else if(-1!==r.indexOf(":")){if((n=r.split(":")).length>2){var o=n.slice(0,3),i=o[2].indexOf("/");-1!==i&&(o[2]=o[2].substring(0,i)),r=o.concat("0000:0000:0000:0000:0000").join(":")}}else r=null}catch(t){r=null}else r=null;t.user_ip=r}}(a,e.captureIp),t.data.request=a,n.route)i=n.route.path,t.data.context=o&&o.length?o+i:i;else try{i=n.app._router.matchRequest(n).path,t.data.context=o&&o.length?o+i:i}catch(t){}var s=e.captureEmail,u=e.captureUsername;if(n.rollbar_person){var c=n.rollbar_person;!s&&c.email&&(c.email=null),!u&&c.username&&(c.username=null),t.data.person=c}else if(n.user)t.data.person={id:n.user.id},n.user.username&&u&&(t.data.person.username=n.user.username),n.user.email&&s&&(t.data.person.email=n.user.email);else if(n.user_id||n.userId){var l=n.user_id||n.userId;h(l)&&(l=l()),t.data.person={id:l}}r(null,t)}else r(null,t)}function Te(t,e,r){var n=t.lambdaContext;if(n){var o={remainingTimeInMillis:n.getRemainingTimeInMillis(),callbackWaitsForEmptyEventLoop:n.callbackWaitsForEmptyEventLoop,functionName:n.functionName,functionVersion:n.functionVersion,arn:n.invokedFunctionArn,requestId:n.awsRequestId};t.data=t.data||{},t.data.custom=t.data.custom||{},t.data.custom.lambda=o,r(null,t)}else r(null,t)}function Pe(t,e,r){var n=e.scrubHeaders||[],o=e.scrubFields||[],i=e.scrubPaths||[];o=n.concat(o),function(t,e){if(!t||!e.scrubRequestBody)return;try{("string"==typeof(r=t.body)||r instanceof String)&&je(t)&&(t.body=JSON.parse(t.body))}catch(e){t.body=null,t.error="request.body parse failed: "+e.message}var r}(t.data.request,e),t.data=ke(t.data,o,i),function(t,e){if(!t||!e.scrubRequestBody)return;try{d(t.body)&&je(t)&&(t.body=JSON.stringify(t.body))}catch(e){t.body=null,t.error="request.body serialization failed: "+e.message}}(t.data.request,e),r(null,t)}function je(t){return t.headers&&t.headers["content-type"]&&t.headers["content-type"].includes("json")}function Re(t){var e=t.ip;return e||(e=_e.getClientIp(t)),e}function qe(t,e,r){t._isUncaught&&(t.data._isUncaught=!0),t._originalArgs&&(t.data._originalArgs=t._originalArgs),r(null,t)}function Me(t,e,r){var n=e.payload||{};n.body&&delete n.body,t.data=s(t.data,n),r(null,t)}function Ce(t,e,r){t.telemetryEvents&&k(t,"data.body.telemetry",t.telemetryEvents),r(null,t)}function Ae(t,e,r){if(t.message){var n="data.body.trace_chain.0",o=E(t,n);if(o||(o=E(t,n="data.body.trace")),o){if(!o.exception||!o.exception.description)return k(t,n+".exception.description",t.message),void r(null,t);var i=E(t,n+".extra")||{};k(t,n+".extra",s(i,{message:t.message}))}r(null,t)}else r(null,t)}function Ne(t){return function(e,r,n){var o,i=s(e),a=null;try{h(r.transform)&&(a=r.transform(i.data,e))}catch(o){return r.transform=null,t.error("Error while calling custom transform() function. Removing custom transform().",o),void n(null,e)}d(o=a)&&p(o.then,"function")?a.then((function(t){t&&(i.data=t),n(null,i)}),(function(t){n(t,e)})):n(null,i)}}function Ue(t,e,r){if(!e.sendConfig)return r(null,t);var n=E(t,"data.custom")||{};n._rollbarConfig=e,t.data.custom=n,r(null,t)}function De(t,e){h(t[e])&&(t[e]=t[e].toString())}function Fe(t,e,r){var n=e._configuredOptions;De(n,"transform"),De(n,"checkIgnore"),De(n,"onSendCallback"),delete n.accessToken,t.data.notifier.configured_options=n,r(null,t)}function He(t,e,r){var n=s(t.notifier.client.notifier.diagnostic,t.diagnostic);if(E(t,"err._isAnonymous")&&(n.is_anonymous=!0),t._isUncaught&&(n.is_uncaught=t._isUncaught),t.err)try{n.raw_error={message:t.err.message,name:t.err.name,constructor_name:t.err.constructor&&t.err.constructor.name,filename:t.err.fileName,line:t.err.lineNumber,column:t.err.columnNumber,stack:t.err.stack}}catch(t){n.raw_error={failed:String(t)}}t.data.notifier.diagnostic=s(t.data.notifier.diagnostic,n),r(null,t)}function Ge(t,e){var r=t.level,n=m[r]||0,o=e.reportLevel;return!(n<(m[o]||0))}function Je(t,e,r){if(!t)return!r;var n,o,i=t.frames;if(!i||0===i.length)return!r;for(var a=e.length,s=i.length,u=0;u<s;u++){if(!p(n=i[u].filename,"string"))return!r;for(var c=0;c<a;c++)if(o=e[c],new RegExp(o).test(n))return!0}return!1}function Be(t,e,r,n){var o,i,a=!1;"blocklist"===r&&(a=!0);try{if(o=a?e.hostBlockList:e.hostSafeList,i=E(t,"body.trace_chain")||[E(t,"body.trace")],!o||0===o.length)return!a;if(0===i.length||!i[0])return!a;for(var s=i.length,u=0;u<s;u++)if(Je(i[u],o,a))return!0}catch(t){a?e.hostBlockList=null:e.hostSafeList=null;var c=a?"hostBlockList":"hostSafeList";return n.error("Error while reading your configuration's "+c+" option. Removing custom "+c+".",t),!a}return!1}function We(t){return function(e,r){var n,o,i,a,s,u;try{if(!(i=r.ignoredMessages)||0===i.length)return!0;if(u=function(t){var e=t.body,r=[];if(e.trace_chain)for(var n=e.trace_chain,o=0;o<n.length;o++){var i=n[o];r.push(E(i,"exception.message"))}e.trace&&r.push(E(e,"trace.exception.message"));e.message&&r.push(E(e,"message.body"));return r}(e),0===u.length)return!0;for(a=i.length,n=0;n<a;n++)for(s=new RegExp(i[n],"gi"),o=0;o<u.length;o++)if(s.test(u[o]))return!1}catch(e){r.ignoredMessages=null,t.error("Error while reading your configuration's ignoredMessages option. Removing custom ignoredMessages.")}return!0}}function ze(t,e){if(p(t,"string")){var r=t;(t={}).accessToken=r}void 0!==t.minimumLevel&&(t.reportLevel=t.minimumLevel,delete t.minimumLevel),this.options=I(ze.defaultOptions,t,null,pt),this.options._configuredOptions=t,delete this.options.maxItems,this.options.environment=this.options.environment||"unspecified",pt.setVerbose(this.options.verbose),this.lambdaContext=null,this.lambdaTimeoutHandle=null;var n=new Ct,o=new ct(this.options,n,At,Lt,Pt),i=new Gt(this.options);this.client=e||new $(this.options,o,pt,i,null,null,"server"),this.instrumenter=new Yt(this.options,this.client.telemeter,this),this.instrumenter.instrument(),this.options.locals&&(this.locals=Qe(this.options.locals,pt)),function(t){t.addTransform(Se).addTransform(Le).addTransform(Ie).addTransform(Ae).addTransform(Ce).addTransform(Oe).addTransform(Te).addTransform(Ue).addTransform(Pe).addTransform(Me).addTransform(Ne(pt)).addTransform(Fe).addTransform(He).addTransform(qe)}(this.client.notifier),function(t){t.addPredicate(Ge).addPredicate(function(t){return function(e,r){var n=!!e._isUncaught;delete e._isUncaught;var o=e._originalArgs;delete e._originalArgs;try{h(r.onSendCallback)&&r.onSendCallback(n,o,e)}catch(e){r.onSendCallback=null,t.error("Error while calling onSendCallback, removing",e)}try{if(h(r.checkIgnore)&&r.checkIgnore(n,o,e))return!1}catch(e){r.checkIgnore=null,t.error("Error while calling custom checkIgnore(), removing",e)}return!0}}(pt)).addPredicate(function(t){return function(e,r){return!Be(e,r,"blocklist",t)}}(pt)).addPredicate(function(t){return function(e,r){return Be(e,r,"safelist",t)}}(pt)).addPredicate(We(pt))}(this.client.queue),this.setupUnhandledCapture()}function Qe(t,e){var r;if(process.versions.node.split(".")[0]<10)return null;if("function"==typeof t)r=t,t=null;else{if(!p(t,"object"))return e.error("options.locals or options.locals.module must be a Locals module"),null;r=t.module,delete t.module}return new r(t,e)}var $e=null;function Ve(t){var e="Rollbar is not initialized";pt.error(e),t&&t(new Error(e))}function Ye(t){for(var e=0,r=t.length;e<r;++e)if(h(t[e]))return t[e]}function Xe(t,e){var r=function(t,r){e(t,r)};r._rollbarHandler=!0;for(var n=process.listeners(t),o=n.length,i=0;i<o;++i)n[i]._rollbarHandler&&process.removeListener(t,n[i]);process.on(t,r)}function Ke(t,e){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=t,this.nested=e,this.name=this.constructor.name}ze.init=function(t,e){return $e?$e.global(t).configure(t):$e=new ze(t,e)},ze.prototype.global=function(t){return delete(t=I(t)).maxItems,this.client.global(t),this},ze.global=function(t){if($e)return $e.global(t);Ve()},ze.prototype.configure=function(t,e){var r=this.options,n={};return e&&(n={payload:e}),this.options=I(r,t,n,pt),this.options._configuredOptions=I(r._configuredOptions,t,n),delete this.options.maxItems,pt.setVerbose(this.options.verbose),this.client.configure(t,e),this.setupUnhandledCapture(),this.options.locals&&(this.locals?this.locals.updateOptions(this.options.locals):this.locals=Qe(this.options.locals,pt)),this},ze.configure=function(t,e){if($e)return $e.configure(t,e);Ve()},ze.prototype.lastError=function(){return this.client.lastError},ze.lastError=function(){if($e)return $e.lastError();Ve()},ze.prototype.log=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.log(t),{uuid:e}},ze.log=function(){if($e)return $e.log.apply($e,arguments);Ve(Ye(arguments))},ze.prototype.debug=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.debug(t),{uuid:e}},ze.debug=function(){if($e)return $e.debug.apply($e,arguments);Ve(Ye(arguments))},ze.prototype.info=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.info(t),{uuid:e}},ze.info=function(){if($e)return $e.info.apply($e,arguments);Ve(Ye(arguments))},ze.prototype.warn=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.warn(t),{uuid:e}},ze.warn=function(){if($e)return $e.warn.apply($e,arguments);Ve(Ye(arguments))},ze.prototype.warning=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.warning(t),{uuid:e}},ze.warning=function(){if($e)return $e.warning.apply($e,arguments);Ve(Ye(arguments))},ze.prototype.error=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.error(t),{uuid:e}},ze.error=function(){if($e)return $e.error.apply($e,arguments);Ve(Ye(arguments))},ze.prototype._uncaughtError=function(){var t=this._createItem(arguments);t._isUncaught=!0,t.level=this.options.uncaughtErrorLevel;var e=t.uuid;return this.client.log(t),{uuid:e}},ze.prototype.critical=function(){var t=this._createItem(arguments),e=t.uuid;return this.client.critical(t),{uuid:e}},ze.critical=function(){if($e)return $e.critical.apply($e,arguments);Ve(Ye(arguments))},ze.prototype.buildJsonPayload=function(t){return this.client.buildJsonPayload(t)},ze.buildJsonPayload=function(){if($e)return $e.buildJsonPayload.apply($e,arguments);Ve()},ze.prototype.sendJsonPayload=function(t){return this.client.sendJsonPayload(t)},ze.sendJsonPayload=function(){if($e)return $e.sendJsonPayload.apply($e,arguments);Ve()},ze.prototype.wait=function(t){this.client.wait(t)},ze.wait=function(t){if($e)return $e.wait(t);Ve(Ye(arguments))},ze.prototype.errorHandler=function(){return function(t,e,r,n){var o=function(o){return o&&pt.error("Error reporting to rollbar, ignoring: "+o),n(t,e,r)};return t?t instanceof Error?this.error(t,e,o):this.error("Error: "+t,e,o):n(t,e,r)}.bind(this)},ze.errorHandler=function(){if($e)return $e.errorHandler();Ve()},ze.prototype.lambdaHandler=function(t,e){return t.length<=2?this.asyncLambdaHandler(t,e):this.syncLambdaHandler(t,e)},ze.prototype.asyncLambdaHandler=function(t,e){var r=this,n=function(t,e){var n={originalEvent:t,originalRequestId:e.awsRequestId};r.error("Function timed out",n)},o=r.options.captureLambdaTimeouts;return function(i,a){return new Promise((function(s,u){if(r.lambdaContext=a,o){var c=(e||n).bind(null,i,a);r.lambdaTimeoutHandle=setTimeout(c,a.getRemainingTimeInMillis()-1e3)}t(i,a).then((function(t){r.wait((function(){clearTimeout(r.lambdaTimeoutHandle),s(t)}))})).catch((function(t){r.error(t),r.wait((function(){clearTimeout(r.lambdaTimeoutHandle),u(t)}))}))}))}},ze.prototype.syncLambdaHandler=function(t,e){var r=this,n=function(t,e,n){var o={originalEvent:t,originalRequestId:e.awsRequestId};r.error("Function timed out",o)},o=r.options.captureLambdaTimeouts;return function(i,a,s){if(r.lambdaContext=a,o){var u=(e||n).bind(null,i,a,s);r.lambdaTimeoutHandle=setTimeout(u,a.getRemainingTimeInMillis()-1e3)}try{t(i,a,(function(t,e){t&&r.error(t),r.wait((function(){clearTimeout(r.lambdaTimeoutHandle),s(t,e)}))}))}catch(t){r.error(t),r.wait((function(){throw clearTimeout(r.lambdaTimeoutHandle),t}))}}},ze.lambdaHandler=function(t){if($e)return $e.lambdaHandler(t);Ve()},ze.prototype.wrapCallback=function(t){return function(t,e){return function(){var r=arguments[0];return r&&t.error(r),e.apply(this,arguments)}}(this,t)},ze.wrapCallback=function(t){if($e)return $e.wrapCallback(t);Ve()},ze.prototype.captureEvent=function(){var t=function(t){for(var e,r,n,o,i=0,a=t.length;i<a;++i)switch(f(o=t[i])){case"string":!e&&_(w,o)?e=o:!n&&_(x,o)&&(n=o);break;case"object":r=o}return{type:e||"manual",metadata:r||{},level:n}}(arguments);return this.client.captureEvent(t.type,t.metadata,t.level)},ze.captureEvent=function(){if($e)return $e.captureEvent.apply($e,arguments);Ve()},ze.prototype.reportMessage=function(t,e,r,n){return pt.log("reportMessage is deprecated"),h(this[e])?this[e](t,r,n):this.error(t,r,n)},ze.reportMessage=function(t,e,r,n){if($e)return $e.reportMessage(t,e,r,n);Ve(n)},ze.prototype.reportMessageWithPayloadData=function(t,e,r,n){return pt.log("reportMessageWithPayloadData is deprecated"),this.error(t,r,e,n)},ze.reportMessageWithPayloadData=function(t,e,r,n){if($e)return $e.reportMessageWithPayloadData(t,e,r,n);Ve(n)},ze.prototype.handleError=function(t,e,r){return pt.log("handleError is deprecated"),this.error(t,e,r)},ze.handleError=function(t,e,r){if($e)return $e.handleError(t,e,r);Ve(r)},ze.prototype.handleErrorWithPayloadData=function(t,e,r,n){return pt.log("handleErrorWithPayloadData is deprecated"),this.error(t,r,e,n)},ze.handleErrorWithPayloadData=function(t,e,r,n){if($e)return $e.handleErrorWithPayloadData(t,e,r,n);Ve(n)},ze.handleUncaughtExceptions=function(t,e){if($e)return(e=e||{}).accessToken=t,$e.configure(e);Ve()},ze.handleUnhandledRejections=function(t,e){if($e)return(e=e||{}).accessToken=t,$e.configure(e);Ve()},ze.handleUncaughtExceptionsAndRejections=function(t,e){if($e)return(e=e||{}).accessToken=t,$e.configure(e);Ve()},ze.prototype._createItem=function(t){var e=b(t,pt,this,["headers","protocol","url","method","body","route"],this.lambdaContext);return e.err&&e.notifier.locals&&(e.localsMap=e.notifier.locals.currentLocalsMap()),e},ze.prototype.setupUnhandledCapture=function(){(this.options.captureUncaught||this.options.handleUncaughtExceptions)&&this.handleUncaughtExceptions(),(this.options.captureUnhandledRejections||this.options.handleUnhandledRejections)&&this.handleUnhandledRejections()},ze.prototype.handleUncaughtExceptions=function(){var t=!!this.options.exitOnUncaughtException;delete this.options.exitOnUncaughtException,Xe("uncaughtException",function(e){(this.options.captureUncaught||this.options.handleUncaughtExceptions)&&(this._uncaughtError(e,(function(t){t&&(pt.error("Encountered error while handling an uncaught exception."),pt.error(t))})),t&&setImmediate(function(){this.wait((function(){process.exit(1)}))}.bind(this)))}.bind(this))},ze.prototype.handleUnhandledRejections=function(){Xe("unhandledRejection",function(t){(this.options.captureUnhandledRejections||this.options.handleUnhandledRejections)&&this._uncaughtError(t,(function(t){t&&(pt.error("Encountered error while handling an uncaught exception."),pt.error(t))}))}.bind(this))},r.inherits(Ke,Error),ze.Error=Ke,ze.defaultOptions={host:n.hostname(),environment:"production",framework:"node-js",showReportedMessageTraces:!1,notifier:{name:"node_rollbar",version:ft},scrubHeaders:yt,scrubFields:vt,addRequestData:null,reportLevel:ht,verbose:!1,enabled:!0,transmit:!0,sendConfig:!1,includeItemsInTelemetry:!1,captureEmail:!1,captureUsername:!1,captureIp:!0,captureLambdaTimeouts:!0,ignoreDuplicateErrors:!0,scrubRequestBody:!0,autoInstrument:!1};const Ze=ze;module.exports=e.default})();
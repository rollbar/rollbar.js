(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{parse:()=>st});var r=Object.prototype.hasOwnProperty,n=Object.prototype.toString,s=function(t){if(!t||"[object Object]"!==n.call(t))return!1;var e,s=r.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!s&&!o)return!1;for(e in t);return void 0===e||r.call(t,e)};const o=function t(){var e,r,n,o,i,a={},l=null,c=arguments.length;for(e=0;e<c;e++)if(null!=(l=arguments[e]))for(i in l)r=a[i],a!==(n=l[i])&&(n&&s(n)?(o=r&&s(r)?r:{},a[i]=t(o,n)):void 0!==n&&(a[i]=n));return a};function i(t,e){return e===a(t)}function a(t){var e=typeof t;return"object"!==e?e:t?t instanceof Error?"error":{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase():"null"}function l(t){return i(t,"function")}function c(t){return Number.isFinite(t)}function u(t){return i(t,"error")||i(t,"exception")}function h(){return"********"}var p={debug:0,info:1,warning:2,error:3,critical:4};function d(t){try{const e=new URL(t);return e.password&&(e.password="********"),e.search&&(e.search="********"),e.toString()}catch(e){return t}}function f(t){var e=function(t){if(i(t,"string")){for(var e=m,r=e.parser[e.strictMode?"strict":"loose"].exec(t),n={},s=0,o=e.key.length;s<o;++s)n[e.key[s]]=r[s]||"";return n[e.q.name]={},n[e.key[12]].replace(e.q.parser,function(t,r,s){r&&(n[e.q.name][r]=s)}),n}}(t);return e?(""===e.anchor&&(e.source=e.source.replace("#","")),t=e.source.replace("?"+e.query,"")):"(unknown)"}var m={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};function g(t,e){if(!(e=e||t.protocol)&&t.port&&(80===t.port?e="http:":443===t.port&&(e="https:")),e=e||"https:",!t.hostname)return null;var r=e+"//"+t.hostname;return t.port&&(r=r+":"+t.port),t.path&&(r+=t.path),r}function y(t,e){var r,n;try{r=JSON.stringify(t)}catch(s){if(e&&l(e))try{r=e(t)}catch(t){n=t}else n=s}return{error:n,value:r}}function b(t){var e,r;try{e=JSON.parse(t)}catch(t){r=t}return{error:r,value:e}}function w(t,e,r,n,s,o,i,a){var l={url:e||"",line:r,column:n};l.func=a.guessFunctionName(l.url,l.line),l.context=a.gatherContext(l.url,l.line);var c="undefined"!=typeof document&&document&&document.location&&document.location.href,u="undefined"!=typeof window&&window&&window.navigator&&window.navigator.userAgent;return{mode:o,message:s?String(s):t||i,url:c,stack:[l],useragent:u}}function v(t,e){return function(r,n){try{e(r,n)}catch(e){t.error(e)}}}function S(t){return function t(e,r){var n,s,o,l={};try{for(s in e)(n=e[s])&&(i(n,"object")||i(n,"array"))?r.includes(n)?l[s]="Removed circular reference: "+a(n):((o=r.slice()).push(n),l[s]=t(n,o)):l[s]=n}catch(t){l="Failed cloning custom data: "+t.message}return l}(t,[t])}var C=["log","network","dom","navigation","error","manual"],I=["critical","error","warning","info","debug"];function k(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return!0;return!1}function x(t,e){t.attributes=t.attributes||[];for(const r of e)void 0!==r.value&&t.attributes.push(r)}function _(t,e){if(t){var r=e.split("."),n=t;try{for(var s=0,o=r.length;s<o;++s)n=n[r[s]]}catch(t){n=void 0}return n}}function E(t,e,r){if(t){var n=e.split("."),s=n.length;if(!(s<1))if(1!==s)try{for(var o=t[n[0]]||{},i=o,a=1;a<s-1;++a)o[n[a]]=o[n[a]]||{},o=o[n[a]];o[n[s-1]]=r,t[n[0]]=i}catch(t){return}else t[n[0]]=r}}function R(){return Date.now?+Date.now():+new Date}function O(t,e,r,n){var s=o(t,e,r);return s=function(t,e){return t.hostWhiteList&&!t.hostSafeList&&(t.hostSafeList=t.hostWhiteList,t.hostWhiteList=void 0,e&&e.log("hostWhiteList is deprecated. Use hostSafeList.")),t.hostBlackList&&!t.hostBlockList&&(t.hostBlockList=t.hostBlackList,t.hostBlackList=void 0,e&&e.log("hostBlackList is deprecated. Use hostBlockList.")),t}(s,n),!e||e.overwriteScrubFields||e.scrubFields&&(s.scrubFields=(t.scrubFields||[]).concat(e.scrubFields)),s}function M(t){this.startTime=R(),this.counter=0,this.perMinCounter=0,this.platform=null,this.platformOptions={},this.configureGlobal(t)}function A(t,e,r){return!t.ignoreRateLimit&&e>=1&&r>e}function T(t,e,r,n,s,o,i){var a=null;return r&&(r=new Error(r)),r||n||(a=function(t,e,r,n,s){var o={body:{message:{body:s?"item per minute limit reached, ignoring errors until timeout":"maxItems has been hit, ignoring errors until reset.",extra:{maxItems:r,itemsPerMinute:n}}},language:"javascript",environment:e.environment||e.payload&&e.payload.environment,notifier:{version:e.notifier&&e.notifier.version||e.version}};return"browser"===t?(o.platform="browser",o.framework="browser-js",o.notifier.name="rollbar-browser-js"):"server"===t?(o.framework=e.framework||"node-js",o.notifier.name=e.notifier.name):"react-native"===t&&(o.framework=e.framework||"react-native",o.notifier.name=e.notifier.name),o}(t,e,s,o,i)),{error:r,shouldSend:n,payload:a}}M.globalSettings={startTime:R(),maxItems:void 0,itemsPerMinute:void 0},M.prototype.configureGlobal=function(t){void 0!==t.startTime&&(M.globalSettings.startTime=t.startTime),void 0!==t.maxItems&&(M.globalSettings.maxItems=t.maxItems),void 0!==t.itemsPerMinute&&(M.globalSettings.itemsPerMinute=t.itemsPerMinute)},M.prototype.shouldSend=function(t,e){var r=(e=e||R())-this.startTime;(r<0||r>=6e4)&&(this.startTime=e,this.perMinCounter=0);var n=M.globalSettings.maxItems,s=M.globalSettings.itemsPerMinute;if(A(t,n,this.counter))return T(this.platform,this.platformOptions,n+" max items reached",!1);if(A(t,s,this.perMinCounter))return T(this.platform,this.platformOptions,s+" items per minute reached",!1);this.counter++,this.perMinCounter++;var o=!A(t,n,this.counter),i=o;return o=o&&!A(t,s,this.perMinCounter),T(this.platform,this.platformOptions,null,o,n,s,i)},M.prototype.setPlatformOptions=function(t,e){this.platform=t,this.platformOptions=e};const L=M;class P{constructor(t,e,r,n,s){this.rateLimiter=t,this.api=e,this.logger=r,this.options=n,this.replay=s,this.predicates=[],this.pendingItems=[],this.pendingRequests=[],this.retryQueue=[],this.retryHandle=null,this.waitCallback=null,this.waitIntervalID=null}configure(t){this.api?.configure(t);const e=this.options;return this.options=o(e,t),this}addPredicate(t){return l(t)&&this.predicates.push(t),this}addPendingItem(t){this.pendingItems.push(t)}removePendingItem(t){const e=this.pendingItems.indexOf(t);-1!==e&&this.pendingItems.splice(e,1)}addItem(t,e,r,n){e&&l(e)||(e=function(){});const s=t.data,o=this._applyPredicates(s);if(o.stop)return this.removePendingItem(n),void e(o.err);if(this._maybeLog(s,r),this.removePendingItem(n),this.options.transmit){this.replay&&s.body&&(t.replayId=this.replay.capture(null,s.uuid,{type:"occurrence",level:t.level}),t.replayId&&x(t.data,[{key:"replay_id",value:t.replayId}])),this.pendingRequests.push(s);try{this._makeApiRequest(s,(r,n,o)=>{this._dequeuePendingRequest(s),t.replayId&&this.replay.sendOrDiscardReplay(t.replayId,r,n,o),e(r,n)})}catch(r){this._dequeuePendingRequest(s),t.replayId&&this.replay?.discard(t.replayId),e(r)}}else e(new Error("Transmit disabled"))}wait(t){l(t)&&(this.waitCallback=t,this._maybeCallWait()||(this.waitIntervalID&&(this.waitIntervalID=clearInterval(this.waitIntervalID)),this.waitIntervalID=setInterval(()=>{this._maybeCallWait()},500)))}_applyPredicates(t){let e=null;for(let r=0,n=this.predicates.length;r<n;r++)if(e=this.predicates[r](t,this.options),!e||void 0!==e.err)return{stop:!0,err:e.err};return{stop:!1,err:null}}_makeApiRequest(t,e){const r=this.rateLimiter.shouldSend(t);r.shouldSend?this.api.postItem(t,(r,n,s)=>{r?this._maybeRetry(r,t,e):e(r,n,s)}):r.error?e(r.error):this.api.postItem(r.payload,e)}static RETRIABLE_ERRORS=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE","EAI_AGAIN"];_maybeRetry(t,e,r){let n=!1;if(this.options.retryInterval){for(let e=0,r=P.RETRIABLE_ERRORS.length;e<r;e++)if(t.code===P.RETRIABLE_ERRORS[e]){n=!0;break}n&&c(this.options.maxRetries)&&(e.retries=e.retries?e.retries+1:1,e.retries>this.options.maxRetries&&(n=!1))}n?this._retryApiRequest(e,r):r(t)}_retryApiRequest(t,e){this.retryQueue.push({item:t,callback:e}),this.retryHandle||(this.retryHandle=setInterval(()=>{for(;this.retryQueue.length;){const t=this.retryQueue.shift();this._makeApiRequest(t.item,t.callback)}},this.options.retryInterval))}_dequeuePendingRequest(t){const e=this.pendingRequests.indexOf(t);-1!==e&&(this.pendingRequests.splice(e,1),this._maybeCallWait())}_maybeLog(t,e){if(this.logger&&this.options.verbose){let r=e||_(t,"body.trace.exception.message")||_(t,"body.trace_chain.0.exception.message");if(r)return void this.logger.error(r);r=_(t,"body.message.body"),r&&this.logger.log(r)}}_maybeCallWait(){return!(!l(this.waitCallback)||0!==this.pendingItems.length||0!==this.pendingRequests.length||(this.waitIntervalID&&(this.waitIntervalID=clearInterval(this.waitIntervalID)),this.waitCallback(),0))}}const N=P;function D(t,e){this.queue=t,this.options=e,this.transforms=[],this.diagnostic={}}D.prototype.configure=function(t){this.queue&&this.queue.configure(t);var e=this.options;return this.options=o(e,t),this},D.prototype.addTransform=function(t){return l(t)&&this.transforms.push(t),this},D.prototype.log=function(t,e){if(e&&l(e)||(e=function(){}),!this.options.enabled)return e(new Error("Rollbar is not enabled"));this.queue.addPendingItem(t);var r=t.err;this._applyTransforms(t,function(n,s){if(n)return this.queue.removePendingItem(t),e(n,null);this.queue.addItem(s,e,r,t)}.bind(this))},D.prototype._applyTransforms=function(t,e){var r=-1,n=this.transforms.length,s=this.transforms,o=this.options,i=function(t,a){t?e(t,null):++r!==n?s[r](a,o,i):e(null,a)};i(null,t)};const F=D;function U(t,e,r,n,s,i,a){this.options=o(t),this.logger=r,U.rateLimiter.configureGlobal(this.options),U.rateLimiter.setPlatformOptions(a,this.options),this.api=e,this.queue=new N(U.rateLimiter,e,r,this.options,i),this.tracing=s;var l=this.options.tracer||null;B(l)?(this.tracer=l,this.options.tracer="opentracing-tracer-enabled",this.options._configuredOptions.tracer="opentracing-tracer-enabled"):this.tracer=null,this.notifier=new F(this.queue,this.options),this.telemeter=n,j(t),this.lastError=null,this.lastErrorHash="none"}function j(t){t.stackTraceLimit&&(Error.stackTraceLimit=t.stackTraceLimit)}function B(t){if(!t)return!1;if(!t.scope||"function"!=typeof t.scope)return!1;var e=t.scope();return!(!e||!e.active||"function"!=typeof e.active)}U.rateLimiter=new L({maxItems:0,itemsPerMinute:60}),U.prototype.global=function(t){return U.rateLimiter.configureGlobal(t),this},U.prototype.configure=function(t,e){var r=this.options,n={};e&&(n={payload:e}),this.options=o(r,t,n);var s=this.options.tracer||null;return B(s)?(this.tracer=s,this.options.tracer="opentracing-tracer-enabled",this.options._configuredOptions.tracer="opentracing-tracer-enabled"):this.tracer=null,this.notifier&&this.notifier.configure(this.options),this.telemeter&&this.telemeter.configure(this.options),j(t),this.global(this.options),B(t.tracer)&&(this.tracer=t.tracer),this},U.prototype.log=function(t){var e=this._defaultLogLevel();return this._log(e,t)},U.prototype.debug=function(t){this._log("debug",t)},U.prototype.info=function(t){this._log("info",t)},U.prototype.warn=function(t){this._log("warning",t)},U.prototype.warning=function(t){this._log("warning",t)},U.prototype.error=function(t){this._log("error",t)},U.prototype.critical=function(t){this._log("critical",t)},U.prototype.wait=function(t){this.queue.wait(t)},U.prototype.captureEvent=function(t,e,r){return this.telemeter&&this.telemeter.captureEvent(t,e,r)},U.prototype.captureDomContentLoaded=function(t){return this.telemeter&&this.telemeter.captureDomContentLoaded(t)},U.prototype.captureLoad=function(t){return this.telemeter&&this.telemeter.captureLoad(t)},U.prototype.buildJsonPayload=function(t){return this.api.buildJsonPayload(t)},U.prototype.sendJsonPayload=function(t){this.api.postJsonPayload(t)},U.prototype._log=function(t,e){var r;if(e.callback&&(r=e.callback,delete e.callback),this.options.ignoreDuplicateErrors&&this._sameAsLastError(e)){if(r){var n=new Error("ignored identical item");n.item=e,r(n)}}else try{e.level=e.level||t,this._addTracingAttributes(e),this._addTracingInfo(e);const n=this.telemeter;n&&(n._captureRollbarItem(e),e.telemetryEvents=n.copyEvents()||[]),this.notifier.log(e,r)}catch(t){r&&r(t),this.logger.error(t)}},U.prototype._addTracingAttributes=function(t){const e=this.tracing?.getSpan(),r=[{key:"session_id",value:this.tracing?.sessionId},{key:"span_id",value:e?.spanId},{key:"trace_id",value:e?.traceId}];x(t.data,r),e?.addEvent("rollbar.occurrence",[{key:"rollbar.occurrence.uuid",value:t.uuid}])},U.prototype._defaultLogLevel=function(){return this.options.logLevel||"debug"},U.prototype._sameAsLastError=function(t){if(!t._isUncaught)return!1;var e=function(t){return(t.message||"")+"::"+((t.err||{}).stack||String(t.err))}(t);return this.lastErrorHash===e||(this.lastError=t.err,this.lastErrorHash=e,!1)},U.prototype._addTracingInfo=function(t){if(this.tracer){var e=this.tracer.scope().active();if(function(t){if(!t||!t.context||"function"!=typeof t.context)return!1;var e=t.context();return!!(e&&e.toSpanId&&e.toTraceId&&"function"==typeof e.toSpanId&&"function"==typeof e.toTraceId)}(e)){e.setTag("rollbar.error_uuid",t.uuid),e.setTag("rollbar.has_error",!0),e.setTag("error",!0),e.setTag("rollbar.item_url",`https://rollbar.com/item/uuid/?uuid=${t.uuid}`),e.setTag("rollbar.occurrence_url",`https://rollbar.com/occurrence/uuid/?uuid=${t.uuid}`);var r=e.context().toSpanId(),n=e.context().toTraceId();t.custom?(t.custom.opentracing_span_id=r,t.custom.opentracing_trace_id=n):t.custom={opentracing_span_id:r,opentracing_trace_id:n}}}};const z=U;function W(t){if(!i(t.context,"string")){var e=y(t.context);e.error?t.context="Error: could not serialize 'context'":t.context=e.value||"",t.context.length>255&&(t.context=t.context.substr(0,255))}return{data:t}}function V(t,e,r){var n=e.hostname,s=e.protocol,o=e.port,i=e.path,a=e.search,l=t.timeout,c=function(t){var e="undefined"!=typeof window&&window||"undefined"!=typeof self&&self,r=t.defaultTransport||"xhr";return void 0===e.fetch&&(r="xhr"),void 0===e.XMLHttpRequest&&(r="fetch"),r}(t),u=t.proxy;if(t.endpoint){var h=r.parse(t.endpoint);n=h.hostname,s=h.protocol,o=h.port,i=h.pathname,a=h.search}return{timeout:l,hostname:n,protocol:s,port:o,path:i,search:a,proxy:u,transport:c}}function H(t,e){var r=t.protocol||"https:",n=t.port||("http:"===r?80:"https:"===r?443:void 0),s=t.hostname,o=t.path,i=t.timeout,a=t.transport;return t.search&&(o+=t.search),t.proxy&&(o=r+"//"+s+o,s=t.proxy.host||t.proxy.hostname,n=t.proxy.port,r=t.proxy.protocol||r),{timeout:i,protocol:r,hostname:s,path:o,port:n,method:e,transport:a}}var G={hostname:"api.rollbar.com",path:"/api/1/item/",search:null,version:"1",protocol:"https:",port:443},J={hostname:"api.rollbar.com",path:"/api/1/session/",search:null,version:"1",protocol:"https:",port:443};function q(t,e,r,n){this.options=t,this.transport=e,this.url=r,this.truncation=n,this.accessToken=t.accessToken,this.transportOptions=Z(t,r),this.OTLPTransportOptions=Y(t,r)}function Z(t,e){return V(t,G,e)}function Y(t,e){return V(t={...t,endpoint:t.tracing?.endpoint},J,e)}q.prototype._postPromise=function({accessToken:t,options:e,payload:r,headers:n}){const s=this;return new Promise((o,i)=>{s.transport.post({accessToken:t,options:e,payload:r,headers:n,callback:(t,e)=>t?i(t):o(e)})})},q.prototype.postItem=function(t,e){const r=H(this.transportOptions,"POST"),n=W(t),s=this;setTimeout(function(){s.transport.post({accessToken:s.accessToken,options:r,payload:n,callback:e})},0)},q.prototype.postSpans=async function(t,e={}){const r=H(this.OTLPTransportOptions,"POST");return await this._postPromise({accessToken:this.accessToken,options:r,payload:t,headers:e})},q.prototype.buildJsonPayload=function(t,e){var r,n=W(t);return(r=this.truncation?this.truncation.truncate(n):y(n)).error?(e&&e(r.error),null):r.value},q.prototype.postJsonPayload=function(t,e){var r=H(this.transportOptions,"POST");this.transport.postJsonPayload(this.accessToken,r,t,e)},q.prototype.configure=function(t){var e=this.oldOptions;return this.options=o(e,t),this.transportOptions=Z(this.options,this.url),this.OTLPTransportOptions=Y(this.options,this.url),void 0!==this.options.accessToken&&(this.accessToken=this.options.accessToken),this};const X=q;let $=()=>{};const K={debug:0,info:1,warn:2,error:3,disable:4},Q={error:(...t)=>$("error",t),warn:(...t)=>$("warn",t),info:(...t)=>$("info",t),debug:(...t)=>$("debug",t),log:(...t)=>$("info",t),init:({logLevel:t})=>{$=function(e,r){K[e]<K[t]||(r.unshift("Rollbar:"),console[e].apply(console,r))}}},tt=Q;function et(t,e){var r=new Error(t);return r.code=e||"ENOTFOUND",r}function rt(t){this.truncation=t}rt.prototype.get=function(t,e,r,n,s){n&&l(n)||(n=function(){}),function(t,e,r){(r=r||{}).access_token=t;var n,s=[];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&s.push([n,r[n]].join("="));var o="?"+s.sort().join("&");(e=e||{}).path=e.path||"";var i,a=e.path.indexOf("?"),l=e.path.indexOf("#");-1!==a&&(-1===l||l>a)?(i=e.path,e.path=i.substring(0,a)+o+"&"+i.substring(a+1)):-1!==l?(i=e.path,e.path=i.substring(0,l)+o+i.substring(l)):e.path=e.path+o}(t,e,r);var o=g(e);this._makeZoneRequest({accessToken:t,url:o,method:"GET",callback:n,requestFactory:s,timeout:e.timeout,transport:e.transport})},rt.prototype.post=function({accessToken:t,options:e,payload:r,headers:n,callback:s,requestFactory:o}){if(s&&l(s)||(s=function(){}),!r)return s(new Error("Cannot send empty request"));var i;if((i=this.truncation&&r.body?this.truncation.truncate(r):y(r)).error)return s(i.error);r=i.value;var a=g(e);this._makeZoneRequest({accessToken:t,url:a,method:"POST",payload:r,headers:n,callback:s,requestFactory:o,timeout:e.timeout,transport:e.transport})},rt.prototype.postJsonPayload=function(t,e,r,n,s){n&&l(n)||(n=function(){});var o=g(e);this._makeZoneRequest({accessToken:t,url:o,method:"POST",payload:r,callback:n,requestFactory:s,timeout:e.timeout,transport:e.transport})},rt.prototype._makeZoneRequest=function(){var t="undefined"!=typeof window&&window||void 0!==n&&n,e=t&&t.Zone&&t.Zone.root,r=Array.prototype.slice.call(arguments);if(e){var n=this;e.run(function(){n._makeRequest.apply(void 0,r)})}else this._makeRequest.apply(void 0,r)},rt.prototype._makeRequest=function(t){const{payload:e,callback:r,transport:n}=t;if("undefined"!=typeof RollbarProxy)return function(t,e){(new RollbarProxy).sendJsonPayload(t,function(t){},function(t){e(new Error(t))})}(e,r);"fetch"===n?function({accessToken:t,url:e,method:r,payload:n,headers:s,callback:o,timeout:i}){var a,l;c(i)&&(a=new AbortController,l=setTimeout(function(){a.abort()},i)),s={"Content-Type":"application/json","X-Rollbar-Access-Token":t,signal:a&&a.signal,...s},fetch(e,{method:r,headers:s,body:n}).then(function(t){l&&clearTimeout(l);const r=t.headers,n=e.endsWith("/api/1/item/")?{"Rollbar-Replay-Enabled":r.get("Rollbar-Replay-Enabled"),"Rollbar-Replay-RateLimit-Remaining":r.get("Rollbar-Replay-RateLimit-Remaining"),"Rollbar-Replay-RateLimit-Reset":r.get("Rollbar-Replay-RateLimit-Reset")}:{},s=t.json();o(null,s,n)}).catch(function(t){tt.error(t.message),o(t)})}(t):function({accessToken:t,url:e,method:r,payload:n,headers:s,callback:o,requestFactory:a,timeout:l}){var u;if(!(u=a?a():function(){var t,e,r=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=r.length;for(e=0;e<n;e++)try{t=r[e]();break}catch(t){}return t}()))return o(new Error("No way to send a request"));try{try{var h=function(){try{if(h&&4===u.readyState){h=void 0;var t=b(u.responseText);if((s=u)&&s.status&&200===s.status){const r=e.endsWith("/api/1/item/")?{"Rollbar-Replay-Enabled":u.getResponseHeader("Rollbar-Replay-Enabled"),"Rollbar-Replay-RateLimit-Remaining":u.getResponseHeader("Rollbar-Replay-RateLimit-Remaining"),"Rollbar-Replay-RateLimit-Reset":u.getResponseHeader("Rollbar-Replay-RateLimit-Reset")}:{};return void o(t.error,t.value,r)}if(function(t){return t&&i(t.status,"number")&&t.status>=400&&t.status<600}(u)){if(403===u.status){var r=t.value&&t.value.message;tt.error(r)}o(new Error(String(u.status)))}else o(et("XHR response had no status code (likely connection failure)"))}}catch(t){var n;n=t&&t.stack?t:new Error(t),o(n)}var s};if(u.open(r,e,!0),u.setRequestHeader){u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("X-Rollbar-Access-Token",t);for(const[t,e]of Object.entries(s??{}))u.setRequestHeader(t,e)}c(l)&&(u.timeout=l),u.onreadystatechange=h,u.send(n)}catch(t){if("undefined"!=typeof XDomainRequest){if(!window||!window.location)return o(new Error("No window available during request, unknown environment"));"http:"===window.location.href.substring(0,5)&&"https"===e.substring(0,5)&&(e="http"+e.substring(5));var p=new XDomainRequest;p.onprogress=function(){},p.ontimeout=function(){o(et("Request timed out","ETIMEDOUT"))},p.onerror=function(){o(new Error("Error during request"))},p.onload=function(){var t=b(p.responseText);o(t.error,t.value)},p.open(r,e,!0),p.send(n)}else o(new Error("Cannot find a method to transport a request"))}}catch(t){o(t)}}(t)};const nt=rt;function st(t){var e,r,n={protocol:null,auth:null,host:null,path:null,hash:null,href:t,hostname:null,port:null,pathname:null,search:null,query:null};if(-1!==(e=t.indexOf("//"))?(n.protocol=t.substring(0,e),r=e+2):r=0,-1!==(e=t.indexOf("@",r))&&(n.auth=t.substring(r,e),r=e+1),-1===(e=t.indexOf("/",r))){if(-1===(e=t.indexOf("?",r)))return-1===(e=t.indexOf("#",r))?n.host=t.substring(r):(n.host=t.substring(r,e),n.hash=t.substring(e)),n.hostname=n.host.split(":")[0],n.port=n.host.split(":")[1],n.port&&(n.port=parseInt(n.port,10)),n;n.host=t.substring(r,e),n.hostname=n.host.split(":")[0],n.port=n.host.split(":")[1],n.port&&(n.port=parseInt(n.port,10)),r=e}else n.host=t.substring(r,e),n.hostname=n.host.split(":")[0],n.port=n.host.split(":")[1],n.port&&(n.port=parseInt(n.port,10)),r=e;if(-1===(e=t.indexOf("#",r))?n.path=t.substring(r):(n.path=t.substring(r,e),n.hash=t.substring(e)),n.path){var s=n.path.split("?");n.pathname=s[0],n.query=s[1],n.search=n.query?"?"+n.query:null}return n}const ot=/(^|@)\S+:\d+/,it=/^\s*at .*(\S+:\d+|\(native\))/m,at=/^(eval@)?(\[native code\])?$/;function lt(t,e){if(void 0!==t.stacktrace||void 0!==t["opera#sourceloc"])return function(t,e){return!t.stacktrace||t.message.includes("\n")&&t.message.split("\n").length>t.stacktrace.split("\n").length?function(t){const e=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),n=[];for(let t=2,s=r.length;t<s;t+=2){const s=e.exec(r[t]);s&&n.push({file:s[2],line:+s[1],raw:r[t]})}return ut(n,void 0)}(t):t.stack?function(t,e){return ut(t.stack.split("\n").filter(t=>!!t.match(ot)&&!t.match(/^Error created at/)),e).map(t=>{const e=t.split("@"),r=ct(e.pop()),n=e.shift()||"",s=n.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;let o;return n.match(/\(([^)]*)\)/)&&(o=n.replace(/^[^(]+\(([^)]*)\)$/,"$1")),{function:s,args:void 0===o||"[arguments not available]"===o?void 0:o.split(","),file:r[0],line:r[1]?+r[1]:void 0,col:r[2]?+r[2]:void 0,raw:t}})}(t,e):function(t){const e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),n=[];for(let t=0,s=r.length;t<s;t+=2){const s=e.exec(r[t]);s&&n.push({function:s[3]||void 0,file:s[2],line:s[1]?+s[1]:void 0,raw:r[t]})}return ut(n,void 0)}(t)}(t,e);if(t.stack&&t.stack.match(it))return function(t,e){return function(t,e){return ut(t.split("\n").filter(t=>!!t.match(it)),e).map(t=>{t.includes("(eval ")&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));let e=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,"");const r=e.match(/ (\(.+\)$)/);e=r?e.replace(r[0],""):e;const n=ct(r?r[1]:e);return{function:r&&e||void 0,file:["eval","<anonymous>"].includes(n[0])?void 0:n[0],line:n[1]?+n[1]:void 0,col:n[2]?+n[2]:void 0,raw:t}})}(t.stack,e)}(t,e);if(t.stack)return function(t,e){return function(t,e){return ut(t.split("\n").filter(t=>!t.match(at)),e).map(t=>{if(t.includes(" > eval")&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),t.includes("@")||t.includes(":")){const e=/(([^\n\r"\u2028\u2029]*".[^\n\r"\u2028\u2029]*"[^\n\r@\u2028\u2029]*(?:@[^\n\r"\u2028\u2029]*"[^\n\r@\u2028\u2029]*)*(?:[\n\r\u2028\u2029][^@]*)?)?[^@]*)@/,r=t.match(e),n=r&&r[1]?r[1]:void 0,s=ct(t.replace(e,""));return{function:n,file:s[0],line:s[1]?+s[1]:void 0,col:s[2]?+s[2]:void 0,raw:t}}return{function:t}})}(t.stack,e)}(t,e);if(e?.allowEmpty)return[];throw new Error("Cannot parse given Error object")}function ct(t){if(!t.includes(":"))return[t,void 0,void 0];const e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));return[e[1],e[2]||void 0,e[3]||void 0]}function ut(t,e){return e&&null!=e.slice?Array.isArray(e.slice)?t.slice(e.slice[0],e.slice[1]):t.slice(0,e.slice):t}var ht=new RegExp("^(([a-zA-Z0-9-_$ ]*): *)?(Uncaught )?([a-zA-Z0-9-_$ ]*): ");function pt(t){var e={};return e._stackFrame=t,e.url=t.fileName,e.line=t.lineNumber,e.func=t.functionName,e.column=t.columnNumber,e.args=t.args,e.context=null,e}function dt(t,e){return{stack:function(){var r=[];e=e||0;try{r=lt(t,void 0).map(t=>({functionName:t.function,args:t.args,fileName:t.file,lineNumber:t.line,columnNumber:t.col,source:t.raw}))}catch(t){r=[]}for(var n=[],s=e;s<r.length;s++)n.push(new pt(r[s]));return n}(),message:t.message,name:(r=t,n=r.name&&r.name.length&&r.name,s=r.constructor.name&&r.constructor.name.length&&r.constructor.name,n&&s?"Error"===n?s:n:n||s),rawStack:t.stack,rawException:t};var r,n,s}const ft={guessFunctionName:function(){return"?"},guessErrorClass:function(t){if(!t||!t.match)return["Unknown error. There was no error message to display.",""];var e=t.match(ht),r="(unknown)";return e&&(r=e[e.length-1],t=(t=t.replace((e[e.length-2]||"")+r+":","")).replace(/(^[\s]+|[\s]+$)/g,"")),[r,t]},gatherContext:function(){return null},parse:function(t,e){var r=t;if(r.nested||r.cause){for(var n=[];r;)n.push(new dt(r,e)),r=r.nested||r.cause,e=0;return n[0].traceChain=n,n[0]}return new dt(r,e)},Stack:dt,Frame:pt};function mt(t,e,r){if(t.err&&"DOMException"===ft.Stack(t.err).name){var n=new Error;n.name=t.err.name,n.message=t.err.message,n.stack=t.err.stack,n.nested=t.err,t.err=n}r(null,t)}function gt(t,e,r){if(t.data=t.data||{},t.err)try{t.stackInfo=t.err._savedStackTrace||ft.parse(t.err,t.skipFrames),e.addErrorContext&&function(t){var e=[],r=t.err;for(e.push(r);r.nested||r.cause;)r=r.nested||r.cause,e.push(r);!function(t,e){var r=t.data.custom||{},n=!1;try{for(var s=0;s<e.length;++s)e[s].hasOwnProperty("rollbarContext")&&(r=o(r,S(e[s].rollbarContext)),n=!0);n&&(t.data.custom=r)}catch(e){t.diagnostic.error_context="Failed: "+e.message}}(t,e)}(t)}catch(e){tt.error("Error while parsing the error object.",e);try{t.message=t.err.message||t.err.description||t.message||String(t.err)}catch(e){t.message=String(t.err)||String(e)}delete t.err}r(null,t)}function yt(t,e,r){t.message||t.stackInfo||t.custom||r(new Error("No message, stack info, or custom data"),null),r(null,t)}function bt(t,e,r){var n=e.payload&&e.payload.environment||e.environment;t.data=o(t.data,{environment:n,level:t.level,endpoint:e.endpoint,platform:"browser",framework:"browser-js",language:"javascript",server:{},uuid:t.uuid,notifier:{name:"rollbar-browser-js",version:e.version},custom:t.custom}),r(null,t)}function wt(t,e,r){t.stackInfo?t.stackInfo.traceChain?function(t,e,r){for(var n=t.stackInfo.traceChain,s=[],o=n.length,i=0;i<o;i++){var a=Ct(t,n[i],e);s.push(a)}E(t,"data.body",{trace_chain:s}),r(null,t)}(t,e,r):function(t,e,r){if(St(t))E(t,"data.body",{trace:Ct(t,t.stackInfo,e)}),r(null,t);else{var n=t.stackInfo,s=ft.guessErrorClass(n.message),o=It(n,s[0],e),i=s[1];t.message=o+": "+i,vt(t,0,r)}}(t,e,r):vt(t,0,r)}function vt(t,e,r){var n=t.message,s=t.custom;n||(n="Item sent with null or missing arguments.");var i={body:n};s&&(i.extra=o(s)),E(t,"data.body",{message:i}),r(null,t)}function St(t){var e=t.stackInfo.stack;return e&&0===e.length&&t._unhandledStackInfo&&t._unhandledStackInfo.stack&&(e=t._unhandledStackInfo.stack),e}function Ct(t,e,r){var n=t&&t.data.description,s=t&&t.custom,i=St(t),a=ft.guessErrorClass(e.message),l={exception:{class:It(e,a[0],r),message:a[1]}};if(n&&(l.exception.description=n),i){var c,u,h,p,d,m,g,y;for(0===i.length&&(l.exception.stack=e.rawStack,l.exception.raw=String(e.rawException)),l.frames=[],g=0;g<i.length;++g)u={filename:(c=i[g]).url?f(c.url):"(unknown)",lineno:c.line||null,method:c.func&&"?"!==c.func?c.func:"[anonymous]",colno:c.column},r.sendFrameUrl&&(u.url=c.url),u.method&&u.method.endsWith&&u.method.endsWith("_rollbar_wrapped")||(h=p=d=null,(m=c.context?c.context.length:0)&&(y=Math.floor(m/2),p=c.context.slice(0,y),h=c.context[y],d=c.context.slice(y)),h&&(u.code=h),(p||d)&&(u.context={},p&&p.length&&(u.context.pre=p),d&&d.length&&(u.context.post=d)),c.args&&(u.args=c.args),l.frames.push(u));l.frames.reverse(),s&&(l.extra=o(s))}return l}function It(t,e,r){return t.name?t.name:r.guessErrorClass?e:"(unknown)"}function kt(t,e,r){t._isUncaught&&(t.data._isUncaught=!0),t._originalArgs&&(t.data._originalArgs=t._originalArgs),r(null,t)}function xt(t,e,r){var n=e.payload||{};n.body&&delete n.body,t.data=o(t.data,n),r(null,t)}function _t(t,e,r){t.telemetryEvents&&E(t,"data.body.telemetry",t.telemetryEvents),r(null,t)}function Et(t,e,r){if(t.message){var n="data.body.trace_chain.0",s=_(t,n);if(s||(s=_(t,n="data.body.trace")),s){if(!s.exception||!s.exception.description)return E(t,n+".exception.description",t.message),void r(null,t);var i=_(t,n+".extra")||{};E(t,n+".extra",o(i,{message:t.message}))}r(null,t)}else r(null,t)}function Rt(t,e,r){if(!e.sendConfig)return r(null,t);var n=_(t,"data.custom")||{};n._rollbarConfig=e,t.data.custom=n,r(null,t)}function Ot(t,e){l(t[e])&&(t[e]=t[e].toString())}function Mt(t,e,r){var n=e._configuredOptions;Ot(n,"transform"),Ot(n,"checkIgnore"),Ot(n,"onSendCallback"),delete n.accessToken,t.data.notifier.configured_options=n,r(null,t)}function At(t,e,r){var n=o(t.notifier.client.notifier.diagnostic,t.diagnostic);if(_(t,"err._isAnonymous")&&(n.is_anonymous=!0),t._isUncaught&&(n.is_uncaught=t._isUncaught),t.err)try{n.raw_error={message:t.err.message,name:t.err.name,constructor_name:t.err.constructor&&t.err.constructor.name,filename:t.err.fileName,line:t.err.lineNumber,column:t.err.columnNumber,stack:t.err.stack}}catch(t){n.raw_error={failed:String(t)}}t.data.notifier.diagnostic=o(t.data.notifier.diagnostic,n),r(null,t)}function Tt(t,e){return!_(e,"plugins.jquery.ignoreAjaxErrors")||!_(t,"body.message.extra.isAjax")}function Lt(t,e){var r=t.level,n=p[r]||0,s=e.reportLevel;return!(n<(p[s]||0))}function Pt(t,e,r){if(!t)return!r;var n,s,o=t.frames;if(!o||0===o.length)return!r;for(var a=e.length,l=o.length,c=0;c<l;c++){if(!i(n=o[c].filename,"string"))return!r;for(var u=0;u<a;u++)if(s=e[u],new RegExp(s).test(n))return!0}return!1}function Nt(t,e,r,n){var s,o,i=!1;"blocklist"===r&&(i=!0);try{if(s=i?e.hostBlockList:e.hostSafeList,o=_(t,"body.trace_chain")||[_(t,"body.trace")],!s||0===s.length)return!i;if(0===o.length||!o[0])return!i;for(var a=o.length,l=0;l<a;l++)if(Pt(o[l],s,i))return!0}catch(t){i?e.hostBlockList=null:e.hostSafeList=null;var c=i?"hostBlockList":"hostSafeList";return n.error("Error while reading your configuration's "+c+" option. Removing custom "+c+".",t),!i}return!1}let Dt=null;class Ft{constructor(t,r){tt.init({logLevel:t.logLevel||"error"}),this.options=O(jt,t,null,tt),this.options._configuredOptions=t,this.components=this.components||{};const n=this.components.telemeter,s=this.components.instrumenter;this.wrapGlobals=this.components.wrapGlobals,this.scrub=this.components.scrub;const a=this.components.truncation,c=this.components.tracing,u=this.components.replay,h=new nt(a),p=new X(this.options,h,e,a);if(c&&(this.tracing=new c(Ut(),p,this.options),this.tracing.initSession()),n&&(this.telemeter=new n(this.options,this.tracing)),u&&"undefined"!=typeof window){const t=this.options.replay;this.replay=new u({tracing:this.tracing,telemeter:this.telemeter,options:t}),t.enabled&&t.autoStart&&this.replay.recorder.start()}this.client=r||new z(this.options,p,tt,this.telemeter,this.tracing,this.replay,"browser");var d=Ut(),f="undefined"!=typeof document&&document;this.isChrome=d.chrome&&d.chrome.runtime,this.anonymousErrorsPending=0,function(t,e,r){var n,s;t.addTransform(mt).addTransform(gt).addTransform(yt).addTransform(bt).addTransform(function(t){return function(e,r,n){var s={};t&&t.location&&(s.url=t.location.href,s.query_string=t.location.search);var o="$remote_ip";r.captureIp?!0!==r.captureIp&&(o+="_anonymize"):o=null,o&&(s.user_ip=o),Object.keys(s).length>0&&E(e,"data.request",s),n(null,e)}}(r)).addTransform(function(t){return function(e,r,n){if(!t)return n(null,e);var s=t.navigator||{},o=t.screen||{};E(e,"data.client",{runtime_ms:e.timestamp-t._rollbarStartTime,timestamp:Math.round(e.timestamp/1e3),javascript:{browser:s.userAgent,language:s.language,cookie_enabled:s.cookieEnabled,screen:{width:o.width,height:o.height}}}),n(null,e)}}(r)).addTransform(function(t){return function(e,r,n){if(!t||!t.navigator)return n(null,e);for(var s,o=[],i=t.navigator.plugins||[],a=0,l=i.length;a<l;++a)s=i[a],o.push({name:s.name,description:s.description});E(e,"data.client.javascript.plugins",o),n(null,e)}}(r)).addTransform(wt).addTransform(Et).addTransform(_t).addTransform(Rt).addTransform((s=e.scrub,function(t,e,r){if(s){var n=e.scrubFields||[],o=e.scrubPaths||[];t.data=s(t.data,n,o)}r(null,t)})).addTransform(xt).addTransform((n=tt,function(t,e,r){var s,a,c,u=o(t),h=null;try{l(e.transform)&&(h=e.transform(u.data,t))}catch(s){return e.transform=null,n.error("Error while calling custom transform() function. Removing custom transform().",s),void r(null,t)}c=typeof(a=s=h),null==a||"object"!=c&&"function"!=c||!i(s.then,"function")?r(null,u):h.then(function(t){t&&(u.data=t),r(null,u)},function(e){r(e,t)})})).addTransform(Mt).addTransform(At).addTransform(kt)}(this.client.notifier,this,d),function(t){var e;t.addPredicate(Lt).addPredicate(Tt).addPredicate((e=tt,function(t,r){var n=!!t._isUncaught;delete t._isUncaught;var s=t._originalArgs;delete t._originalArgs;try{l(r.onSendCallback)&&r.onSendCallback(n,s,t)}catch(t){r.onSendCallback=null,e.error("Error while calling onSendCallback, removing",t)}try{if(l(r.checkIgnore)&&r.checkIgnore(n,s,t))return!1}catch(t){r.checkIgnore=null,e.error("Error while calling custom checkIgnore(), removing",t)}return!0})).addPredicate(function(t){return function(e,r){return!Nt(e,r,"blocklist",t)}}(tt)).addPredicate(function(t){return function(e,r){return Nt(e,r,"safelist",t)}}(tt)).addPredicate(function(t){return function(e,r){var n,s,o,i,a,l;try{if(!(o=r.ignoredMessages)||0===o.length)return!0;if(l=function(t){var e=t.body,r=[];if(e.trace_chain)for(var n=e.trace_chain,s=0;s<n.length;s++){var o=n[s];r.push(_(o,"exception.message"))}return e.trace&&r.push(_(e,"trace.exception.message")),e.message&&r.push(_(e,"message.body")),r}(e),0===l.length)return!0;for(i=o.length,n=0;n<i;n++)for(a=new RegExp(o[n],"gi"),s=0;s<l.length;s++)if(a.test(l[s]))return!1}catch(e){r.ignoredMessages=null,t.error("Error while reading your configuration's ignoredMessages option. Removing custom ignoredMessages.")}return!0}}(tt))}(this.client.queue),this.setupUnhandledCapture(),s&&(this.instrumenter=new s(this.options,this.client.telemeter,this,d,f),this.instrumenter.instrument()),this.setSessionAttributesFromOptions(t),this.rollbar=this}static init(t,e){return Dt?Dt.global(t).configure(t):(Dt=new Ft(t,e),Dt)}static setComponents(t){Ft.prototype.components=t}global(t){return this.client.global(t),this}configure(t,e){t.logLevel&&tt.init({logLevel:t.logLevel}),this.setSessionAttributesFromOptions(t);var r=this.options,n={};return e&&(n={payload:e}),this.options=O(r,t,n,tt),this.options._configuredOptions=O(r._configuredOptions,t,n),this.tracing?.configure(this.options),this.replay?.configure(this.options),this.client.configure(this.options,e),this.instrumenter?.configure(this.options),this.setupUnhandledCapture(),this}lastError(){return this.client.lastError}log(){var t=this._createItem(arguments),e=t.uuid;return this.client.log(t),{uuid:e}}debug(){var t=this._createItem(arguments),e=t.uuid;return this.client.debug(t),{uuid:e}}info(){var t=this._createItem(arguments),e=t.uuid;return this.client.info(t),{uuid:e}}warn(){var t=this._createItem(arguments),e=t.uuid;return this.client.warn(t),{uuid:e}}warning(){var t=this._createItem(arguments),e=t.uuid;return this.client.warning(t),{uuid:e}}error(){var t=this._createItem(arguments),e=t.uuid;return this.client.error(t),{uuid:e}}critical(){var t=this._createItem(arguments),e=t.uuid;return this.client.critical(t),{uuid:e}}buildJsonPayload(t){return this.client.buildJsonPayload(t)}sendJsonPayload(t){return this.client.sendJsonPayload(t)}triggerDirectReplay(t){return this.triggerReplay({type:"direct",...t})}triggerReplay(t){return this.replay?this.replay.triggerReplay(t):null}setupUnhandledCapture(){var t=Ut();this.unhandledExceptionsInitialized||(this.options.captureUncaught||this.options.handleUncaughtExceptions)&&(function(t,e){if(t){var r;if("function"==typeof e._rollbarOldOnError)r=e._rollbarOldOnError;else if(t.onerror){for(r=t.onerror;r._rollbarOldOnError;)r=r._rollbarOldOnError;e._rollbarOldOnError=r}e.handleAnonymousErrors();var n=function(){var n=Array.prototype.slice.call(arguments,0);!function(t,e,r,n){t._rollbarWrappedError&&(n[4]||(n[4]=t._rollbarWrappedError),n[5]||(n[5]=t._rollbarWrappedError._rollbarContext),t._rollbarWrappedError=null);var s=e.handleUncaughtException.apply(e,n);r&&r.apply(t,n),"anonymous"===s&&(e.anonymousErrorsPending+=1)}(t,e,r,n)};t.onerror=n}}(t,this),this.wrapGlobals&&this.options.wrapGlobalEventHandlers&&this.wrapGlobals(t,this),this.unhandledExceptionsInitialized=!0),this.unhandledRejectionsInitialized||(this.options.captureUnhandledRejections||this.options.handleUnhandledRejections)&&(function(t,e){if(t){"function"==typeof t._rollbarURH&&t._rollbarURH.belongsToShim&&t.removeEventListener("unhandledrejection",t._rollbarURH);var r=function(t){var r,n,s;try{r=t.reason}catch(t){r=void 0}try{n=t.promise}catch(t){n="[unhandledrejection] error getting `promise` from event"}try{s=t.detail,!r&&s&&(r=s.reason,n=s.promise)}catch(t){}r||(r="[unhandledrejection] error getting `reason` from event"),e&&e.handleUnhandledRejection&&e.handleUnhandledRejection(r,n)};r.belongsToShim=void 0,t._rollbarURH=r,t.addEventListener("unhandledrejection",r)}}(t,this),this.unhandledRejectionsInitialized=!0)}handleUncaughtException(t,e,r,n,s,o){if(this.options.captureUncaught||this.options.handleUncaughtExceptions){if(this.options.inspectAnonymousErrors&&this.isChrome&&null===s&&""===e)return"anonymous";var i,a=w(t,e,r,n,s,"onerror","uncaught exception",ft);u(s)?(i=this._createItem([t,s,o]))._unhandledStackInfo=a:u(e)?(i=this._createItem([t,e,o]))._unhandledStackInfo=a:(i=this._createItem([t,o])).stackInfo=a,i.level=this.options.uncaughtErrorLevel,i._isUncaught=!0,this.client.log(i)}}handleAnonymousErrors(){if(this.options.inspectAnonymousErrors&&this.isChrome){var t=this;try{Error.prepareStackTrace=function(e,r){if(t.options.inspectAnonymousErrors&&t.anonymousErrorsPending){if(t.anonymousErrorsPending-=1,!e)return;e._isAnonymous=!0,t.handleUncaughtException(e.message,null,null,null,e)}return e.stack}}catch(t){this.options.inspectAnonymousErrors=!1,this.error("anonymous error handler failed",t)}}}handleUnhandledRejection(t,e){if(this.options.captureUnhandledRejections||this.options.handleUnhandledRejections){var r="unhandled rejection was null or undefined!";if(t)if(t.message)r=t.message;else{var n=y(t);n.value&&(r=n.value)}var s,o=t&&t._rollbarContext||e&&e._rollbarContext;u(t)?s=this._createItem([r,t,o]):(s=this._createItem([r,t,o])).stackInfo=w(r,"",0,0,null,"unhandledrejection","",ft),s.level=this.options.uncaughtErrorLevel,s._isUncaught=!0,s._originalArgs=s._originalArgs||[],s._originalArgs.push(e),this.client.log(s)}}wrap(t,e,r){try{var n;if(n=l(e)?e:function(){return e||{}},!l(t))return t;if(t._isWrap)return t;if(!t._rollbar_wrapped&&(t._rollbar_wrapped=function(){r&&l(r)&&r.apply(this,arguments);try{return t.apply(this,arguments)}catch(r){var e=r;throw e&&window._rollbarWrappedError!==e&&(i(e,"string")&&(e=new String(e)),e._rollbarContext=n()||{},e._rollbarContext._wrappedSource=t.toString(),window._rollbarWrappedError=e),e}},t._rollbar_wrapped._isWrap=!0,t.hasOwnProperty))for(var s in t)t.hasOwnProperty(s)&&"_rollbar_wrapped"!==s&&(t._rollbar_wrapped[s]=t[s]);return t._rollbar_wrapped}catch(e){return t}}captureEvent(){var t=function(t){for(var e,r,n,s,o=0,i=t.length;o<i;++o)switch(a(s=t[o])){case"string":!e&&k(C,s)?e=s:!n&&k(I,s)&&(n=s);break;case"object":r=s}return{type:e||"manual",metadata:r||{},level:n}}(arguments);return this.client.captureEvent(t.type,t.metadata,t.level)}setSessionUser(t){this.tracing?.session&&this.tracing.session.setUser(t)}setSessionAttributes(t){this.tracing?.session&&(t={...t},this.tracing.session.setAttributes(t))}setSessionAttributesFromOptions(t){const e=t.person||t.payload?.person;e&&this.setSessionUser(e);const r=t.client?.javascript?.code_version||t.codeVersion||t.code_version||t.payload?.client?.javascript?.code_version||t.payload?.code_version||t.payload?.codeVersion;this.setSessionAttributes({"rollbar.codeVersion":r,"rollbar.notifier.name":"rollbar-browser-js","rollbar.notifier.version":t.version})}captureDomContentLoaded(t,e){return e||(e=new Date),this.client.captureDomContentLoaded(e)}captureLoad(t,e){return e||(e=new Date),this.client.captureLoad(e)}loadFull(){tt.info("Unexpected Rollbar.loadFull() called on a Notifier instance. This can happen when Rollbar is loaded multiple times.")}_createItem(t){return function(t,e,r,n,s){for(var o,i,l,c,u,h,p=[],d=[],f=0,m=t.length;f<m;++f){var g=a(h=t[f]);switch(d.push(g),g){case"undefined":break;case"string":o?p.push(h):o=h;break;case"function":c=v(e,h);break;case"date":p.push(h);break;case"error":case"domexception":case"exception":i?p.push(h):i=h;break;case"object":case"array":if(h instanceof Error||"undefined"!=typeof DOMException&&h instanceof DOMException){i?p.push(h):i=h;break}if(n&&"object"===g&&!u){for(var y=0,b=n.length;y<b;++y)if(void 0!==h[n[y]]){u=h;break}if(u)break}l?p.push(h):l=h;break;default:if(h instanceof Error||"undefined"!=typeof DOMException&&h instanceof DOMException){i?p.push(h):i=h;break}p.push(h)}}l&&(l=S(l)),p.length>0&&(l||(l=S({})),l.extraArgs=S(p));var w,C={message:o,err:i,custom:l,timestamp:R(),callback:c,notifier:r,diagnostic:{},uuid:(w=R(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(w+16*Math.random())%16|0;return w=Math.floor(w/16),("x"===t?e:7&e|8).toString(16)}))};return C.data=C.data||{},function(t,e){e&&void 0!==e.level&&(t.level=e.level,delete e.level),e&&void 0!==e.skipFrames&&(t.skipFrames=e.skipFrames,delete e.skipFrames)}(C,l),n&&u&&(C.request=u),s&&(C.lambdaContext=s),C._originalArgs=t,C.diagnostic.original_arg_types=d,C}(t,tt,this)}static callInstance(t,e){if(!Dt){const t="Rollbar is not initialized";tt.error(t);const r=function(t){for(var e=0,r=t.length;e<r;++e)if(l(t[e]))return t[e]}(e);return void(r&&r(new Error(t)))}return Dt[t].apply(Dt,e)}static global=(...t)=>Ft.callInstance("global",t);static configure=(...t)=>Ft.callInstance("configure",t);static lastError=(...t)=>Ft.callInstance("lastError",t);static log=(...t)=>Ft.callInstance("log",t);static debug=(...t)=>Ft.callInstance("debug",t);static info=(...t)=>Ft.callInstance("info",t);static warn=(...t)=>Ft.callInstance("warn",t);static warning=(...t)=>Ft.callInstance("warning",t);static error=(...t)=>Ft.callInstance("error",t);static critical=(...t)=>Ft.callInstance("critical",t);static buildJsonPayload=(...t)=>Ft.callInstance("buildJsonPayload",t);static sendJsonPayload=(...t)=>Ft.callInstance("sendJsonPayload",t);static wrap=(...t)=>Ft.callInstance("wrap",t);static captureEvent=(...t)=>Ft.callInstance("captureEvent",t)}function Ut(){return"undefined"!=typeof window&&window||"undefined"!=typeof self&&self}const jt={environment:"unknown",version:"3.0.0-beta.4",scrubFields:["pw","pass","passwd","password","secret","confirm_password","confirmPassword","password_confirmation","passwordConfirmation","access_token","accessToken","X-Rollbar-Access-Token","secret_key","secretKey","secretToken","cc-number","card number","cardnumber","cardnum","ccnum","ccnumber","cc num","creditcardnumber","credit card number","newcreditcardnumber","new credit card","creditcardno","credit card no","card#","card #","cc-csc","cvc","cvc2","cvv2","ccv2","security code","card verification","name on credit card","name on card","nameoncard","cardholder","card holder","name des karteninhabers","ccname","card type","cardtype","cc type","cctype","payment type","expiration date","expirationdate","expdate","cc-exp","ccmonth","ccyear"],logLevel:"debug",reportLevel:"debug",uncaughtErrorLevel:"error",endpoint:"api.rollbar.com/api/1/item/",verbose:!1,enabled:!0,transmit:!0,sendConfig:!1,includeItemsInTelemetry:!0,captureIp:!0,inspectAnonymousErrors:!0,ignoreDuplicateErrors:!0,wrapGlobalEventHandlers:!1,replay:{enabled:!1,autoStart:!0,triggerDefaults:{samplingRatio:1,preDuration:300,postDuration:5},triggers:[{type:"occurrence",level:["error","critical"]}],debug:{logErrors:!0,logEmits:!1},inlineStylesheet:!0,inlineImages:!1,collectFonts:!0,maskInputOptions:{password:!0,email:!1,tel:!1,text:!1,color:!1,date:!1,"datetime-local":!1,month:!1,number:!1,range:!1,search:!1,time:!1,url:!1,week:!1},blockClass:"rb-block",maskTextClass:"rb-mask",ignoreClass:"rb-ignore",slimDOMOptions:{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}},tracing:{enabled:!1,endpoint:"api.rollbar.com/api/1/session/"}},Bt=Ft,zt=100;function Wt(t){return[Math.trunc(t/1e3),Math.round(t%1e3*1e6)]}function Vt(t,e){return e||({error:"error",manual:"info"}[t]||"info")}function Ht(t){return"string"!=typeof t&&(t=String(t)),t.toLowerCase()}function Gt(t){this.map={},t instanceof Gt?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}Gt.prototype.append=function(t,e){t=Ht(t),e=function(t){return"string"!=typeof t&&(t=String(t)),t}(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},Gt.prototype.get=function(t){return t=Ht(t),this.has(t)?this.map[t]:null},Gt.prototype.has=function(t){return this.map.hasOwnProperty(Ht(t))},Gt.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},Gt.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),function(t){return{next:function(){var e=t.shift();return{done:void 0===e,value:e}}}}(t)};const Jt=function(t,e,r,n,s){var o=t[e];t[e]=r(o),n&&n[s].push([t,e,o])},qt=function(t,e,r){var n,s,o,a,l=i(t,"object"),c=i(t,"array"),u=[];if(r=r||{obj:[],mapped:[]},l){if(a=r.obj.indexOf(t),l&&-1!==a)return r.mapped[a]||r.obj[a];r.obj.push(t),a=r.obj.length-1}if(l)for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&u.push(n);else if(c)for(o=0;o<t.length;++o)u.push(o);var h=l?{}:[],p=!0;for(o=0;o<u.length;++o)s=t[n=u[o]],h[n]=e(n,s,r),p=p&&h[n]===t[n];return l&&!p&&(r.mapped[a]=h),p?t:h};function Zt(t,e){var r=e.split("."),n=r.length-1;try{for(var s=0;s<=n;++s)s<n?t=t[r[s]]:t[r[s]]=h()}catch(t){}}const Yt=function(t,e,r){if(e=e||[],r)for(var n=0;n<r.length;++n)Zt(t,r[n]);var s=function(t){for(var e,r=[],n=0;n<t.length;++n)e="^\\[?(%5[bB])?"+t[n]+"\\[?(%5[bB])?\\]?(%5[dD])?$",r.push(new RegExp(e,"i"));return r}(e),o=function(t){for(var e,r=[],n=0;n<t.length;++n)e="\\[?(%5[bB])?"+t[n]+"\\[?(%5[bB])?\\]?(%5[dD])?",r.push(new RegExp("("+e+"=)([^&\\n]+)","igm"));return r}(e);function a(t,e){return e+"********"}return qt(t,function t(e,r,n){var l=function(t,e){var r;for(r=0;r<s.length;++r)if(s[r].test(t)){e=h();break}return e}(e,r);return l===r?i(r,"object")||i(r,"array")?qt(r,t,n):function(t){var e;if(i(t,"string"))for(e=0;e<o.length;++e)t=t.replace(o[e],a);return t}(l):l})};function Xt(t){return function(t){for(var e,r,n=[],s=0,o=t.length-1;o>=0;o--){if(e=$t(t[o]),r=s+3*n.length+e.length,o<t.length-1&&r>=83){n.unshift("...");break}n.unshift(e),s+=e.length}return n.join(" > ")}(function(t){for(var e,r=[],n=0;t&&n<5&&"html"!==(e=Kt(t)).tagName;n++)r.unshift(e),t=t.parentNode;return r}(t))}function $t(t){if(!t||!t.tagName)return"";var e=[t.tagName];t.id&&e.push("#"+t.id),t.classes&&e.push("."+t.classes.join("."));for(var r=0;r<t.attributes.length;r++)e.push("["+t.attributes[r].key+'="'+t.attributes[r].value+'"]');return e.join("")}function Kt(t){if(!t||!t.tagName)return null;var e,r,n,s,o={};o.tagName=t.tagName.toLowerCase(),t.id&&(o.id=t.id),(e=t.className)&&"string"==typeof e&&(o.classes=e.split(/\s+/));var i=["type","name","title","alt"];for(o.attributes=[],s=0;s<i.length;s++)r=i[s],(n=t.getAttribute(r))&&o.attributes.push({key:r,value:n});return o}const Qt={network:!0,networkResponseHeaders:!1,networkResponseBody:!1,networkRequestHeaders:!1,networkRequestBody:!1,networkErrorOnHttp5xx:!1,networkErrorOnHttp4xx:!1,networkErrorOnHttp0:!1,log:!0,dom:!0,navigation:!0,connectivity:!0,contentSecurityPolicy:!0,errorOnContentSecurityPolicy:!1};function te(t,e){let r;for(;t[e].length;)r=t[e].shift(),r[0][r[1]]=r[2]}function ee(t){return"undefined"!=typeof URL&&t instanceof URL}function re(t,e,r){if(e.hasOwnProperty&&e.hasOwnProperty("addEventListener")){for(var n=e.addEventListener;n._rollbarOldAdd&&n.belongsToShim;)n=n._rollbarOldAdd;var s=function(e,r,s){n.call(this,e,t.wrap(r),s)};s._rollbarOldAdd=n,s.belongsToShim=r,e.addEventListener=s;for(var o=e.removeEventListener;o._rollbarOldRemove&&o.belongsToShim;)o=o._rollbarOldRemove;var i=function(t,e,r){o.call(this,t,e&&e._rollbar_wrapped||e,r)};i._rollbarOldRemove=o,i.belongsToShim=r,e.removeEventListener=i}}function ne(t,e){return[t,y(t,e)]}function se(t,e){var r=t.length;return r>2*e?t.slice(0,e).concat(t.slice(r-e)):t}function oe(t,e,r){r=void 0===r?30:r;var n,s=t.data.body;if(s.trace_chain)for(var o=s.trace_chain,i=0;i<o.length;i++)n=se(n=o[i].frames,r),o[i].frames=n;else s.trace&&(n=se(n=s.trace.frames,r),s.trace.frames=n);return[t,y(t,e)]}function ie(t,e){return e&&e.length>t?e.slice(0,t-3).concat("..."):e}function ae(t,e,r){return[e=qt(e,function e(r,n,s){switch(a(n)){case"string":return ie(t,n);case"object":case"array":return qt(n,e,s);default:return n}}),y(e,r)]}function le(t){return t.exception&&(delete t.exception.description,t.exception.message=ie(255,t.exception.message)),t.frames=se(t.frames,1),t}function ce(t,e){var r=t.data.body;if(r.trace_chain)for(var n=r.trace_chain,s=0;s<n.length;s++)n[s]=le(n[s]);else r.trace&&(r.trace=le(r.trace));return[t,y(t,e)]}function ue(t,e){return function(t){for(var e=0,r=t.length,n=0;n<r;n++){var s=t.charCodeAt(n);s<128?e+=1:s<2048?e+=2:s<65536&&(e+=3)}return e}(t)>e}const he={truncate:function(t,e,r){r=void 0===r?524288:r;for(var n,s,o,i=[ne,oe,ae.bind(null,1024),ae.bind(null,512),ae.bind(null,256),ce];n=i.shift();)if(t=(s=n(t,e))[0],(o=s[1]).error||!ue(o.value,r))return o;return o},raw:ne,truncateFrames:oe,truncateStrings:ae,maybeTruncateValue:ie};class pe{constructor(t){this._currentContext=t?new Map(t):new Map}getValue(t){return this._currentContext.get(t)}setValue(t,e){const r=new pe(this._currentContext);return r._currentContext.set(t,e),r}deleteValue(t){const e=new pe(self._currentContext);return e._currentContext.delete(t),e}}const de=new pe;class fe{constructor(){this.currentContext=de}active(){return this.currentContext}enterContext(t){const e=this.currentContext;return this.currentContext=t||de,e}exitContext(t){return this.currentContext=t,this.currentContext}with(t,e,r,...n){const s=this.enterContext(t);try{return e.call(r,...n)}finally{this.exitContext(s)}}}const me=function(t=16){let e=new Uint8Array(t);return crypto.getRandomValues(e),Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")},ge="RollbarSession";class ye{_attributes;constructor(t,e){this.options=e,this.tracing=t,this.window=t.window,this.session=null,this._attributes={}}init(t={}){return this.session||(this.getSession()||this.createSession(),this.initSessionAttributes(t)),this}getSession(){try{const t=this.window.sessionStorage.getItem(ge);if(!t)return null;this.session=JSON.parse(t)}catch{return null}return this}createSession(){return this.session={id:me(),createdAt:Date.now()},this.setSession(this.session)}setSession(t){const e=JSON.stringify(t);try{this.window.sessionStorage.setItem(ge,e)}catch{return null}return this}get attributes(){return this._attributes}setAttributes(t){return this._attributes={...this._attributes,...t},this}setUser(t){return this.setAttributes({"user.id":t?.id,"user.email":t?.email,"user.name":t?.name||t?.username}),this}initSessionAttributes(t){return this.setAttributes({"session.id":this.session.id,"browser.brands":navigator.userAgentData?.brands,"browser.language":navigator.language,"browser.mobile":navigator.userAgentData?.mobile,"browser.platform":navigator.userAgentData?.platform,"client.address":"$remote_ip","rollbar.notifier.framework":"browser-js","user_agent.original":navigator.userAgent,...t}),this}}function be(t){return[Math.trunc(t/1e3),Math.round(t%1e3*1e6)]}function we(t,e){return[t[0]+e[0]+Math.trunc((t[1]+e[1])/1e9),(t[1]+e[1])%1e9]}const ve={fromMillis:be,toMillis:function(t){return 1e3*t[0]+Math.round(t[1]/1e6)},toNanos:function(t){return 1e9*t[0]+t[1]},add:we,now:function(t=!1){return t?we(be(performance.timeOrigin),be(performance.now())):be(Date.now())},isHrTime:function(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}};class Se{constructor(t,e={}){this.api=t,this.options=e}export(t,e){Ce.push(...t)}toPayload(){const t=Ce.slice();if(Ce.length=0,!t||!t.length)return{resourceSpans:[]};const e=t[0]&&t[0].resource||{},r=new Map;for(const e of t){const t=e.instrumentationScope?`${e.instrumentationScope.name}:${e.instrumentationScope.version}`:"default:1.0.0";r.has(t)||r.set(t,{scope:e.instrumentationScope||{name:"default",version:"1.0.0",attributes:[]},spans:[]}),r.get(t).spans.push(this._transformSpan(e))}return{resourceSpans:[{resource:this._transformResource(e),scopeSpans:Array.from(r.values()).map(t=>({scope:this._transformInstrumentationScope(t.scope),spans:t.spans}))}]}}post(t,e={}){return this.api.postSpans(t,e)}_transformSpan(t){const e=t=>Object.entries(t||{}).map(([t,e])=>({key:t,value:this._transformAnyValue(e)}));return{traceId:t.spanContext.traceId,spanId:t.spanContext.spanId,parentSpanId:t.parentSpanId||"",name:t.name,kind:t.kind||1,startTimeUnixNano:ve.toNanos(t.startTime),endTimeUnixNano:ve.toNanos(t.endTime),attributes:e(t.attributes),events:(r=t.events,(r||[]).map(t=>({timeUnixNano:ve.toNanos(t.time),name:t.name,attributes:e(t.attributes)})))};var r}_transformResource(t){const e=t.attributes||{};return{attributes:Object.entries(e).map(([t,e])=>({key:t,value:this._transformAnyValue(e)}))}}_transformInstrumentationScope(t){return{name:t.name||"",version:t.version||"",attributes:(t.attributes||[]).map(t=>({key:t.key,value:this._transformAnyValue(t.value)}))}}_transformAnyValue(t){if(null==t)return{stringValue:""};const e=typeof t;return"string"===e?{stringValue:t}:"number"===e?Number.isInteger(t)?{intValue:t.toString()}:{doubleValue:t}:"boolean"===e?{boolValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(t=>this._transformAnyValue(t))}}:"object"===e?{kvlistValue:{values:Object.entries(t).map(([t,e])=>({key:t,value:this._transformAnyValue(e)}))}}:{stringValue:String(t)}}}const Ce=[];class Ie{constructor(t,e={}){this.exporter=t,this.options=e,this.pendingSpans=new Map,this.transforms=[this.userTransform.bind(this)]}addTransform(t){this.transforms.unshift(t)}userTransform(t){this.options.transformSpan&&this.options.transformSpan({span:t})}applyTransforms(t){for(const e of this.transforms)try{e(t)}catch(t){tt.error("Error running span transform callback",t)}}onStart(t,e){this.pendingSpans.set(t.span.spanContext.spanId,t)}onEnd(t){this.applyTransforms(t.span),this.exporter.export([t.export()]),this.pendingSpans.delete(t.span.spanContext.spanId)}}class ke{constructor(t){return this.usePerformance=t.usePerformance,this.initReadableSpan(t),this.spanProcessor=t.spanProcessor,this.spanProcessor.onStart(this,t.context),t.attributes&&this.setAttributes(t.attributes),this}initReadableSpan(t){this.span={name:t.name,kind:t.kind,spanContext:t.spanContext,parentSpanId:t.parentSpanId,startTime:t.startTime||ve.now(t.usePerformance),endTime:[0,0],status:{code:0,message:""},attributes:{"session.id":t.session?.id},links:[],events:[],duration:0,ended:!1,resource:t.resource,instrumentationScope:t.scope,droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0}}spanContext(){return this.span.spanContext}get spanId(){return this.span.spanContext.spanId}get traceId(){return this.span.spanContext.traceId}setAttribute(t,e){return null==e||this.span.ended||0===t.length||(this.span.attributes[t]=e),this}setAttributes(t){for(const[e,r]of Object.entries(t))this.setAttribute(e,r);return this}addEvent(t,e={},r){return this.span.ended||this.span.events.push({name:t,attributes:e,time:r||ve.now(),droppedAttributesCount:0}),this}isRecording(){return!1===this.span.ended}end(t,e){t&&this.setAttributes(t),this.span.endTime=e||ve.now(this.usePerformance),this.span.ended=!0,this.spanProcessor.onEnd(this)}export(){return this.span}}class xe{constructor(t,e){this.spanProcessor=e,this.tracing=t}startSpan(t,e={},r=this.tracing.contextManager.active()){const n=this.tracing.getSpan(r),s=n?.spanContext(),o=me(8);let i,a,l=null;s?(i=s.traceId,l=s.traceState,a=s.spanId):i=me(16);const c={traceId:i,spanId:o,traceFlags:0,traceState:l},u={attributes:{...this.tracing.resource?.attributes||{},...e.resource?.attributes||{}}};return new ke({resource:u,scope:this.tracing.scope,session:this.tracing.session.session,context:r,spanContext:c,name:t,kind:0,parentSpanId:a,spanProcessor:this.spanProcessor,startTime:e.startTime,usePerformance:e.usePerformance})}}const _e=Symbol.for("Rollbar Context Key SPAN");var Ee,Re=Object.defineProperty,Oe=(t,e,r)=>((t,e,r)=>e in t?Re(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),Me=Object.defineProperty,Ae=(t,e,r)=>((t,e,r)=>e in t?Me(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),Te=(t=>(t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment",t))(Te||{});const Le={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},Pe={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},Ne={};function De(t){if(Ne[t])return Ne[t];const e=globalThis[t],r=e.prototype,n=t in Le?Le[t]:void 0,s=Boolean(n&&n.every(t=>{var e,n;return Boolean(null==(n=null==(e=Object.getOwnPropertyDescriptor(r,t))?void 0:e.get)?void 0:n.toString().includes("[native code]"))})),o=t in Pe?Pe[t]:void 0,i=Boolean(o&&o.every(t=>{var e;return"function"==typeof r[t]&&(null==(e=r[t])?void 0:e.toString().includes("[native code]"))}));if(s&&i&&!globalThis.Zone)return Ne[t]=e.prototype,e.prototype;try{const n=document.createElement("iframe");document.body.appendChild(n);const s=n.contentWindow;if(!s)return e.prototype;const o=s[t].prototype;return document.body.removeChild(n),o?Ne[t]=o:r}catch{return r}}const Fe={};function Ue(t,e,r){var n;const s=`${t}.${String(r)}`;if(Fe[s])return Fe[s].call(e);const o=De(t),i=null==(n=Object.getOwnPropertyDescriptor(o,r))?void 0:n.get;return i?(Fe[s]=i,i.call(e)):e[r]}const je=function(t){return Ue("Node",t,"childNodes")},Be=function(t){return Ue("Node",t,"parentNode")},ze=function(t){return Ue("Node",t,"parentElement")},We=function(t){return Ue("Node",t,"textContent")},Ve=function(t){return t&&"host"in t?Ue("ShadowRoot",t,"host"):null},He=function(t){return t&&"shadowRoot"in t?Ue("Element",t,"shadowRoot"):null};function Ge(t){return t.nodeType===t.ELEMENT_NODE}function Je(t){const e=t&&"host"in t&&"mode"in t&&Ve(t)||null;return Boolean(e&&"shadowRoot"in e&&He(e)===t)}function qe(t){return"[object ShadowRoot]"===Object.prototype.toString.call(t)}function Ze(t){try{const r=t.rules||t.cssRules;if(!r)return null;let n=t.href;!n&&t.ownerNode&&t.ownerNode.ownerDocument&&(n=t.ownerNode.ownerDocument.location.href);return(e=Array.from(r,t=>Ye(t,n)).join("")).includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e}catch(t){return null}var e}function Ye(t,e){if(function(t){return"styleSheet"in t}(t)){let e;try{e=Ze(t.styleSheet)||function(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const r=["@import",`url(${JSON.stringify(t.href)})`];return""===t.layerName?r.push("layer"):t.layerName&&r.push(`layer(${t.layerName})`),t.supportsText&&r.push(`supports(${t.supportsText})`),t.media.length&&r.push(t.media.mediaText),r.join(" ")+";"}(t)}catch(r){e=t.cssText}return t.styleSheet.href?ir(e,t.styleSheet.href):e}{let r=t.cssText;return function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":")&&(r=r.replace(/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,"$1\\$2")),e?ir(r,e):r}}class Xe{constructor(){Ae(this,"idNodeMap",new Map),Ae(this,"nodeMetaMap",new WeakMap)}getId(t){var e;return t?(null==(e=this.getMeta(t))?void 0:e.id)??-1:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const e=this.getId(t);this.idNodeMap.delete(e),t.childNodes&&t.childNodes.forEach(t=>this.removeNodeFromMap(t))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,e){const r=e.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,e)}replace(t,e){const r=this.getNode(t);if(r){const t=this.nodeMetaMap.get(r);t&&this.nodeMetaMap.set(e,t)}this.idNodeMap.set(t,e)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function $e({element:t,maskInputOptions:e,tagName:r,type:n,value:s,maskInputFn:o}){let i=s||"";const a=n&&Ke(n);return(e[r.toLowerCase()]||a&&e[a])&&(i=o?o(i,t):"*".repeat(i.length)),i}function Ke(t){return t.toLowerCase()}const Qe="__rrweb_original__";function tr(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?Ke(e):null}function er(t,e){let r;try{r=new URL(t,e??window.location.href)}catch(t){return null}const n=r.pathname.match(/\.([0-9a-z]+)(?:$)/i);return(null==n?void 0:n[1])??null}const rr=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,nr=/^(?:[a-z+]+:)?\/\//i,sr=/^www\..*/i,or=/^(data:)([^,]*),(.*)/i;function ir(t,e){return(t||"").replace(rr,(t,r,n,s,o,i)=>{const a=n||o||i,l=r||s||"";if(!a)return t;if(nr.test(a)||sr.test(a))return`url(${l}${a}${l})`;if(or.test(a))return`url(${l}${a}${l})`;if("/"===a[0])return`url(${l}${function(t){let e="";return e=t.indexOf("//")>-1?t.split("/").slice(0,3).join("/"):t.split("/")[0],e=e.split("?")[0],e}(e)+a}${l})`;const c=e.split("/"),u=a.split("/");c.pop();for(const t of u)"."!==t&&(".."===t?c.pop():c.push(t));return`url(${l}${c.join("/")}${l})`})}function ar(t){return t.replace(/(\/\*[^*]*\*\/)|[\s;]/g,"")}let lr=1;const cr=new RegExp("[^a-z0-9-_:]");function ur(){return lr++}let hr,pr;const dr=/^[^ \t\n\r\u000c]+/,fr=/^[, \t\n\r\u000c]+/,mr=new WeakMap;function gr(t,e){return e&&""!==e.trim()?yr(t,e):e}function yr(t,e){let r=mr.get(t);if(r||(r=t.createElement("a"),mr.set(t,r)),e){if(e.startsWith("blob:")||e.startsWith("data:"))return e}else e="";return r.setAttribute("href",e),r.href}function br(t,e,r,n){return n?"src"===r||"href"===r&&("use"!==e||"#"!==n[0])||"xlink:href"===r&&"#"!==n[0]?gr(t,n):"background"!==r||"table"!==e&&"td"!==e&&"th"!==e?"srcset"===r?function(t,e){if(""===e.trim())return e;let r=0;function n(t){let n;const s=t.exec(e.substring(r));return s?(n=s[0],r+=n.length,n):""}const s=[];for(;n(fr),!(r>=e.length);){let o=n(dr);if(","===o.slice(-1))o=gr(t,o.substring(0,o.length-1)),s.push(o);else{let n="";o=gr(t,o);let i=!1;for(;;){const t=e.charAt(r);if(""===t){s.push((o+n).trim());break}if(i)")"===t&&(i=!1);else{if(","===t){r+=1,s.push((o+n).trim());break}"("===t&&(i=!0)}n+=t,r+=1}}}return s.join(", ")}(t,n):"style"===r?ir(n,yr(t)):"object"===e&&"data"===r?gr(t,n):n:gr(t,n):n}function wr(t,e,r){return("video"===t||"audio"===t)&&"autoplay"===e}function vr(t,e,r){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return!!r&&vr(Be(t),e,r);for(let r=t.classList.length;r--;){const n=t.classList[r];if(e.test(n))return!0}return!!r&&vr(Be(t),e,r)}function Sr(t,e,r,n){let s;if(Ge(t)){if(s=t,!je(s).length)return!1}else{if(null===ze(t))return!1;s=ze(t)}try{if("string"==typeof e){if(n){if(s.closest(`.${e}`))return!0}else if(s.classList.contains(e))return!0}else if(vr(s,e,n))return!0;if(r)if(n){if(s.closest(r))return!0}else if(s.matches(r))return!0}catch(t){}return!1}function Cr(t,e){const{doc:r,mirror:n,blockClass:s,blockSelector:o,needsMask:i,inlineStylesheet:a,maskInputOptions:l={},maskTextFn:c,maskInputFn:u,dataURLOptions:h={},inlineImages:p,recordCanvas:d,keepIframeSrcFn:f,newlyAddedElement:m=!1,cssCaptured:g=!1}=e,y=function(t,e){if(!e.hasNode(t))return;const r=e.getId(t);return 1===r?void 0:r}(r,n);switch(t.nodeType){case t.DOCUMENT_NODE:return"CSS1Compat"!==t.compatMode?{type:Te.Document,childNodes:[],compatMode:t.compatMode}:{type:Te.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:Te.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:y};case t.ELEMENT_NODE:return function(t,e){const{doc:r,blockClass:n,blockSelector:s,inlineStylesheet:o,maskInputOptions:i={},maskInputFn:a,dataURLOptions:l={},inlineImages:c,recordCanvas:u,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:d}=e,f=function(t,e,r){try{if("string"==typeof e){if(t.classList.contains(e))return!0}else for(let r=t.classList.length;r--;){const n=t.classList[r];if(e.test(n))return!0}if(r)return t.matches(r)}catch(t){}return!1}(t,n,s),m=function(t){if(t instanceof HTMLFormElement)return"form";const e=Ke(t.tagName);return cr.test(e)?"div":e}(t);let g={};const y=t.attributes.length;for(let e=0;e<y;e++){const n=t.attributes[e];wr(m,n.name,n.value)||(g[n.name]=br(r,m,Ke(n.name),n.value))}if("link"===m&&o){const e=Array.from(r.styleSheets).find(e=>e.href===t.href);let n=null;e&&(n=Ze(e)),n&&(delete g.rel,delete g.href,g._cssText=n)}if("style"===m&&t.sheet){let e=Ze(t.sheet);e&&(t.childNodes.length>1&&(e=function(t,e){return function(t,e){const r=Array.from(e.childNodes),n=[];if(r.length>1&&t&&"string"==typeof t){const e=ar(t);for(let s=1;s<r.length;s++)if(r[s].textContent&&"string"==typeof r[s].textContent){const o=ar(r[s].textContent);for(let r=3;r<o.length;r++){const s=o.substring(0,r);if(2===e.split(s).length){const r=e.indexOf(s);for(let e=r;e<t.length;e++)if(ar(t.substring(0,e)).length===r){n.push(t.substring(0,e)),t=t.substring(e);break}break}}}}return n.push(t),n}(t,e).join("/* rr_split */")}(e,t)),g._cssText=e)}if("input"===m||"textarea"===m||"select"===m){const e=t.value,r=t.checked;"radio"!==g.type&&"checkbox"!==g.type&&"submit"!==g.type&&"button"!==g.type&&e?g.value=$e({element:t,type:tr(t),tagName:m,value:e,maskInputOptions:i,maskInputFn:a}):r&&(g.checked=r)}if("option"===m&&(t.selected&&!i.select?g.selected=!0:delete g.selected),"dialog"===m&&t.open&&(g.rr_open_mode=t.matches("dialog:modal")?"modal":"non-modal"),"canvas"===m&&u)if("2d"===t.__context)(function(t){const e=t.getContext("2d");if(!e)return!0;for(let r=0;r<t.width;r+=50)for(let n=0;n<t.height;n+=50){const s=e.getImageData,o=Qe in s?s[Qe]:s;if(new Uint32Array(o.call(e,r,n,Math.min(50,t.width-r),Math.min(50,t.height-n)).data.buffer).some(t=>0!==t))return!1}return!0})(t)||(g.rr_dataURL=t.toDataURL(l.type,l.quality));else if(!("__context"in t)){const e=t.toDataURL(l.type,l.quality),n=r.createElement("canvas");n.width=t.width,n.height=t.height,e!==n.toDataURL(l.type,l.quality)&&(g.rr_dataURL=e)}if("img"===m&&c){hr||(hr=r.createElement("canvas"),pr=hr.getContext("2d"));const e=t,n=e.currentSrc||e.getAttribute("src")||"<unknown-src>",s=e.crossOrigin,o=()=>{e.removeEventListener("load",o);try{hr.width=e.naturalWidth,hr.height=e.naturalHeight,pr.drawImage(e,0,0),g.rr_dataURL=hr.toDataURL(l.type,l.quality)}catch(t){if("anonymous"!==e.crossOrigin)return e.crossOrigin="anonymous",void(e.complete&&0!==e.naturalWidth?o():e.addEventListener("load",o));console.warn(`Cannot inline img src=${n}! Error: ${t}`)}"anonymous"===e.crossOrigin&&(s?g.crossOrigin=s:e.removeAttribute("crossorigin"))};e.complete&&0!==e.naturalWidth?o():e.addEventListener("load",o)}if("audio"===m||"video"===m){const e=g;e.rr_mediaState=t.paused?"paused":"played",e.rr_mediaCurrentTime=t.currentTime,e.rr_mediaPlaybackRate=t.playbackRate,e.rr_mediaMuted=t.muted,e.rr_mediaLoop=t.loop,e.rr_mediaVolume=t.volume}if(p||(t.scrollLeft&&(g.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(g.rr_scrollTop=t.scrollTop)),f){const{width:e,height:r}=t.getBoundingClientRect();g={class:g.class,rr_width:`${e}px`,rr_height:`${r}px`}}let b;"iframe"!==m||h(g.src)||(t.contentDocument||(g.rr_src=g.src),delete g.src);try{customElements.get(m)&&(b=!0)}catch(t){}return{type:Te.Element,tagName:m,attributes:g,childNodes:[],isSVG:(w=t,Boolean("svg"===w.tagName||w.ownerSVGElement)||void 0),needBlock:f,rootId:d,isCustom:b};var w}(t,{doc:r,blockClass:s,blockSelector:o,inlineStylesheet:a,maskInputOptions:l,maskInputFn:u,dataURLOptions:h,inlineImages:p,recordCanvas:d,keepIframeSrcFn:f,newlyAddedElement:m,rootId:y});case t.TEXT_NODE:return function(t,e){const{needsMask:r,maskTextFn:n,rootId:s,cssCaptured:o}=e,i=Be(t),a=i&&i.tagName;let l="";const c="STYLE"===a||void 0,u="SCRIPT"===a||void 0;return u?l="SCRIPT_PLACEHOLDER":o||(l=We(t),c&&l&&(l=ir(l,yr(e.doc)))),!c&&!u&&l&&r&&(l=n?n(l,ze(t)):l.replace(/[\S]/g,"*")),{type:Te.Text,textContent:l||"",rootId:s}}(t,{doc:r,needsMask:i,maskTextFn:c,rootId:y,cssCaptured:g});case t.CDATA_SECTION_NODE:return{type:Te.CDATA,textContent:"",rootId:y};case t.COMMENT_NODE:return{type:Te.Comment,textContent:We(t)||"",rootId:y};default:return!1}}function Ir(t){return null==t?"":t.toLowerCase()}function kr(t,e){const{doc:r,mirror:n,blockClass:s,blockSelector:o,maskTextClass:i,maskTextSelector:a,skipChild:l=!1,inlineStylesheet:c=!0,maskInputOptions:u={},maskTextFn:h,maskInputFn:p,slimDOMOptions:d,dataURLOptions:f={},inlineImages:m=!1,recordCanvas:g=!1,onSerialize:y,onIframeLoad:b,iframeLoadTimeout:w=5e3,onStylesheetLoad:v,stylesheetLoadTimeout:S=5e3,keepIframeSrcFn:C=()=>!1,newlyAddedElement:I=!1,cssCaptured:k=!1}=e;let{needsMask:x}=e,{preserveWhiteSpace:_=!0}=e;x||(x=Sr(t,i,a,void 0===x));const E=Cr(t,{doc:r,mirror:n,blockClass:s,blockSelector:o,needsMask:x,inlineStylesheet:c,maskInputOptions:u,maskTextFn:h,maskInputFn:p,dataURLOptions:f,inlineImages:m,recordCanvas:g,keepIframeSrcFn:C,newlyAddedElement:I,cssCaptured:k});if(!E)return console.warn(t,"not serialized"),null;let R;R=n.hasNode(t)?n.getId(t):function(t,e){if(e.comment&&t.type===Te.Comment)return!0;if(t.type===Te.Element){if(e.script&&("script"===t.tagName||"link"===t.tagName&&("preload"===t.attributes.rel||"modulepreload"===t.attributes.rel)&&"script"===t.attributes.as||"link"===t.tagName&&"prefetch"===t.attributes.rel&&"string"==typeof t.attributes.href&&"js"===er(t.attributes.href)))return!0;if(e.headFavicon&&("link"===t.tagName&&"shortcut icon"===t.attributes.rel||"meta"===t.tagName&&(Ir(t.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Ir(t.attributes.name)||"icon"===Ir(t.attributes.rel)||"apple-touch-icon"===Ir(t.attributes.rel)||"shortcut icon"===Ir(t.attributes.rel))))return!0;if("meta"===t.tagName){if(e.headMetaDescKeywords&&Ir(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(Ir(t.attributes.property).match(/^(og|twitter|fb):/)||Ir(t.attributes.name).match(/^(og|twitter):/)||"pinterest"===Ir(t.attributes.name)))return!0;if(e.headMetaRobots&&("robots"===Ir(t.attributes.name)||"googlebot"===Ir(t.attributes.name)||"bingbot"===Ir(t.attributes.name)))return!0;if(e.headMetaHttpEquiv&&void 0!==t.attributes["http-equiv"])return!0;if(e.headMetaAuthorship&&("author"===Ir(t.attributes.name)||"generator"===Ir(t.attributes.name)||"framework"===Ir(t.attributes.name)||"publisher"===Ir(t.attributes.name)||"progid"===Ir(t.attributes.name)||Ir(t.attributes.property).match(/^article:/)||Ir(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&("google-site-verification"===Ir(t.attributes.name)||"yandex-verification"===Ir(t.attributes.name)||"csrf-token"===Ir(t.attributes.name)||"p:domain_verify"===Ir(t.attributes.name)||"verify-v1"===Ir(t.attributes.name)||"verification"===Ir(t.attributes.name)||"shopify-checkout-api-token"===Ir(t.attributes.name)))return!0}}return!1}(E,d)||!_&&E.type===Te.Text&&!E.textContent.replace(/^\s+|\s+$/gm,"").length?-2:ur();const O=Object.assign(E,{id:R});if(n.add(t,O),-2===R)return null;y&&y(t);let M=!l;if(O.type===Te.Element){M=M&&!O.needBlock,delete O.needBlock;const e=He(t);e&&qe(e)&&(O.isShadowHost=!0)}if((O.type===Te.Document||O.type===Te.Element)&&M){d.headWhitespace&&O.type===Te.Element&&"head"===O.tagName&&(_=!1);const e={doc:r,mirror:n,blockClass:s,blockSelector:o,needsMask:x,maskTextClass:i,maskTextSelector:a,skipChild:l,inlineStylesheet:c,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:d,dataURLOptions:f,inlineImages:m,recordCanvas:g,preserveWhiteSpace:_,onSerialize:y,onIframeLoad:b,iframeLoadTimeout:w,onStylesheetLoad:v,stylesheetLoadTimeout:S,keepIframeSrcFn:C,cssCaptured:!1};if(O.type===Te.Element&&"textarea"===O.tagName&&void 0!==O.attributes.value);else{O.type===Te.Element&&void 0!==O.attributes._cssText&&"string"==typeof O.attributes._cssText&&(e.cssCaptured=!0);for(const r of Array.from(je(t))){const t=kr(r,e);t&&O.childNodes.push(t)}}let I=null;if(Ge(t)&&(I=He(t)))for(const t of Array.from(je(I))){const r=kr(t,e);r&&(qe(I)&&(r.isShadow=!0),O.childNodes.push(r))}}const A=Be(t);return A&&Je(A)&&qe(A)&&(O.isShadow=!0),O.type===Te.Element&&"iframe"===O.tagName&&function(t,e,r){const n=t.contentWindow;if(!n)return;let s,o=!1;try{s=n.document.readyState}catch(t){return}if("complete"!==s){const n=setTimeout(()=>{o||(e(),o=!0)},r);return void t.addEventListener("load",()=>{clearTimeout(n),o=!0,e()})}const i="about:blank";if(n.location.href!==i||t.src===i||""===t.src)return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}(t,()=>{const e=t.contentDocument;if(e&&b){const r=kr(e,{doc:e,mirror:n,blockClass:s,blockSelector:o,needsMask:x,maskTextClass:i,maskTextSelector:a,skipChild:!1,inlineStylesheet:c,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:d,dataURLOptions:f,inlineImages:m,recordCanvas:g,preserveWhiteSpace:_,onSerialize:y,onIframeLoad:b,iframeLoadTimeout:w,onStylesheetLoad:v,stylesheetLoadTimeout:S,keepIframeSrcFn:C});r&&b(t,r)}},w),O.type===Te.Element&&"link"===O.tagName&&"string"==typeof O.attributes.rel&&("stylesheet"===O.attributes.rel||"preload"===O.attributes.rel&&"string"==typeof O.attributes.href&&"css"===er(O.attributes.href))&&function(t,e,r){let n,s=!1;try{n=t.sheet}catch(t){return}if(n)return;const o=setTimeout(()=>{s||(e(),s=!0)},r);t.addEventListener("load",()=>{clearTimeout(o),s=!0,e()})}(t,()=>{if(v){const e=kr(t,{doc:r,mirror:n,blockClass:s,blockSelector:o,needsMask:x,maskTextClass:i,maskTextSelector:a,skipChild:!1,inlineStylesheet:c,maskInputOptions:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:d,dataURLOptions:f,inlineImages:m,recordCanvas:g,preserveWhiteSpace:_,onSerialize:y,onIframeLoad:b,iframeLoadTimeout:w,onStylesheetLoad:v,stylesheetLoadTimeout:S,keepIframeSrcFn:C});e&&v(t,e)}},S),O}function xr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function _r(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),r}var Er={exports:{}},Rr=String,Or=function(){return{isColorSupported:!1,reset:Rr,bold:Rr,dim:Rr,italic:Rr,underline:Rr,inverse:Rr,hidden:Rr,strikethrough:Rr,black:Rr,red:Rr,green:Rr,yellow:Rr,blue:Rr,magenta:Rr,cyan:Rr,white:Rr,gray:Rr,bgBlack:Rr,bgRed:Rr,bgGreen:Rr,bgYellow:Rr,bgBlue:Rr,bgMagenta:Rr,bgCyan:Rr,bgWhite:Rr}};Er.exports=Or(),Er.exports.createColors=Or;var Mr=Er.exports;const Ar=_r(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));let Tr=Mr,Lr=Ar,Pr=class t extends Error{constructor(e,r,n,s,o,i){super(e),this.name="CssSyntaxError",this.reason=e,o&&(this.file=o),s&&(this.source=s),i&&(this.plugin=i),void 0!==r&&void 0!==n&&("number"==typeof r?(this.line=r,this.column=n):(this.line=r.line,this.column=r.column,this.endLine=n.line,this.endColumn=n.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,t)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(t){if(!this.source)return"";let e=this.source;null==t&&(t=Tr.isColorSupported),Lr&&t&&(e=Lr(e));let r,n,s=e.split(/\r?\n/),o=Math.max(this.line-3,0),i=Math.min(this.line+2,s.length),a=String(i).length;if(t){let{bold:t,gray:e,red:s}=Tr.createColors(!0);r=e=>t(s(e)),n=t=>e(t)}else r=n=t=>t;return s.slice(o,i).map((t,e)=>{let s=o+1+e,i=" "+(" "+s).slice(-a)+" | ";if(s===this.line){let e=n(i.replace(/\d/g," "))+t.slice(0,this.column-1).replace(/[^\t]/g," ");return r(">")+n(i)+t+"\n "+e+r("^")}return" "+n(i)+t}).join("\n")}toString(){let t=this.showSourceCode();return t&&(t="\n\n"+t+"\n"),this.name+": "+this.message+t}};var Nr=Pr;Pr.default=Pr;var Dr={};Dr.isClean=Symbol("isClean"),Dr.my=Symbol("my");const Fr={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};let Ur=class{constructor(t){this.builder=t}atrule(t,e){let r="@"+t.name,n=t.params?this.rawValue(t,"params"):"";if(void 0!==t.raws.afterName?r+=t.raws.afterName:n&&(r+=" "),t.nodes)this.block(t,r+n);else{let s=(t.raws.between||"")+(e?";":"");this.builder(r+n+s,t)}}beforeAfter(t,e){let r;r="decl"===t.type?this.raw(t,null,"beforeDecl"):"comment"===t.type?this.raw(t,null,"beforeComment"):"before"===e?this.raw(t,null,"beforeRule"):this.raw(t,null,"beforeClose");let n=t.parent,s=0;for(;n&&"root"!==n.type;)s+=1,n=n.parent;if(r.includes("\n")){let e=this.raw(t,null,"indent");if(e.length)for(let t=0;t<s;t++)r+=e}return r}block(t,e){let r,n=this.raw(t,"between","beforeOpen");this.builder(e+n+"{",t,"start"),t.nodes&&t.nodes.length?(this.body(t),r=this.raw(t,"after")):r=this.raw(t,"after","emptyBody"),r&&this.builder(r),this.builder("}",t,"end")}body(t){let e=t.nodes.length-1;for(;e>0&&"comment"===t.nodes[e].type;)e-=1;let r=this.raw(t,"semicolon");for(let n=0;n<t.nodes.length;n++){let s=t.nodes[n],o=this.raw(s,"before");o&&this.builder(o),this.stringify(s,e!==n||r)}}comment(t){let e=this.raw(t,"left","commentLeft"),r=this.raw(t,"right","commentRight");this.builder("/*"+e+t.text+r+"*/",t)}decl(t,e){let r=this.raw(t,"between","colon"),n=t.prop+r+this.rawValue(t,"value");t.important&&(n+=t.raws.important||" !important"),e&&(n+=";"),this.builder(n,t)}document(t){this.body(t)}raw(t,e,r){let n;if(r||(r=e),e&&(n=t.raws[e],void 0!==n))return n;let s=t.parent;if("before"===r){if(!s||"root"===s.type&&s.first===t)return"";if(s&&"document"===s.type)return""}if(!s)return Fr[r];let o=t.root();if(o.rawCache||(o.rawCache={}),void 0!==o.rawCache[r])return o.rawCache[r];if("before"===r||"after"===r)return this.beforeAfter(t,r);{let s="raw"+((i=r)[0].toUpperCase()+i.slice(1));this[s]?n=this[s](o,t):o.walk(t=>{if(n=t.raws[e],void 0!==n)return!1})}var i;return void 0===n&&(n=Fr[r]),o.rawCache[r]=n,n}rawBeforeClose(t){let e;return t.walk(t=>{if(t.nodes&&t.nodes.length>0&&void 0!==t.raws.after)return e=t.raws.after,e.includes("\n")&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawBeforeComment(t,e){let r;return t.walkComments(t=>{if(void 0!==t.raws.before)return r=t.raws.before,r.includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(e,null,"beforeDecl"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeDecl(t,e){let r;return t.walkDecls(t=>{if(void 0!==t.raws.before)return r=t.raws.before,r.includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(e,null,"beforeRule"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeOpen(t){let e;return t.walk(t=>{if("decl"!==t.type&&(e=t.raws.between,void 0!==e))return!1}),e}rawBeforeRule(t){let e;return t.walk(r=>{if(r.nodes&&(r.parent!==t||t.first!==r)&&void 0!==r.raws.before)return e=r.raws.before,e.includes("\n")&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawColon(t){let e;return t.walkDecls(t=>{if(void 0!==t.raws.between)return e=t.raws.between.replace(/[^\s:]/g,""),!1}),e}rawEmptyBody(t){let e;return t.walk(t=>{if(t.nodes&&0===t.nodes.length&&(e=t.raws.after,void 0!==e))return!1}),e}rawIndent(t){if(t.raws.indent)return t.raws.indent;let e;return t.walk(r=>{let n=r.parent;if(n&&n!==t&&n.parent&&n.parent===t&&void 0!==r.raws.before){let t=r.raws.before.split("\n");return e=t[t.length-1],e=e.replace(/\S/g,""),!1}}),e}rawSemicolon(t){let e;return t.walk(t=>{if(t.nodes&&t.nodes.length&&"decl"===t.last.type&&(e=t.raws.semicolon,void 0!==e))return!1}),e}rawValue(t,e){let r=t[e],n=t.raws[e];return n&&n.value===r?n.raw:r}root(t){this.body(t),t.raws.after&&this.builder(t.raws.after)}rule(t){this.block(t,this.rawValue(t,"selector")),t.raws.ownSemicolon&&this.builder(t.raws.ownSemicolon,t,"end")}stringify(t,e){if(!this[t.type])throw new Error("Unknown AST node type "+t.type+". Maybe you need to change PostCSS stringifier.");this[t.type](t,e)}};var jr=Ur;Ur.default=Ur;let Br=jr;function zr(t,e){new Br(e).stringify(t)}var Wr=zr;zr.default=zr;let{isClean:Vr,my:Hr}=Dr,Gr=Nr,Jr=jr,qr=Wr;function Zr(t,e){let r=new t.constructor;for(let n in t){if(!Object.prototype.hasOwnProperty.call(t,n))continue;if("proxyCache"===n)continue;let s=t[n],o=typeof s;"parent"===n&&"object"===o?e&&(r[n]=e):"source"===n?r[n]=s:Array.isArray(s)?r[n]=s.map(t=>Zr(t,r)):("object"===o&&null!==s&&(s=Zr(s)),r[n]=s)}return r}let Yr=class{constructor(t={}){this.raws={},this[Vr]=!1,this[Hr]=!0;for(let e in t)if("nodes"===e){this.nodes=[];for(let r of t[e])"function"==typeof r.clone?this.append(r.clone()):this.append(r)}else this[e]=t[e]}addToError(t){if(t.postcssNode=this,t.stack&&this.source&&/\n\s{4}at /.test(t.stack)){let e=this.source;t.stack=t.stack.replace(/\n\s{4}at /,`$&${e.input.from}:${e.start.line}:${e.start.column}$&`)}return t}after(t){return this.parent.insertAfter(this,t),this}assign(t={}){for(let e in t)this[e]=t[e];return this}before(t){return this.parent.insertBefore(this,t),this}cleanRaws(t){delete this.raws.before,delete this.raws.after,t||delete this.raws.between}clone(t={}){let e=Zr(this);for(let r in t)e[r]=t[r];return e}cloneAfter(t={}){let e=this.clone(t);return this.parent.insertAfter(this,e),e}cloneBefore(t={}){let e=this.clone(t);return this.parent.insertBefore(this,e),e}error(t,e={}){if(this.source){let{end:r,start:n}=this.rangeBy(e);return this.source.input.error(t,{column:n.column,line:n.line},{column:r.column,line:r.line},e)}return new Gr(t)}getProxyProcessor(){return{get:(t,e)=>"proxyOf"===e?t:"root"===e?()=>t.root().toProxy():t[e],set:(t,e,r)=>(t[e]===r||(t[e]=r,"prop"!==e&&"value"!==e&&"name"!==e&&"params"!==e&&"important"!==e&&"text"!==e||t.markDirty()),!0)}}markDirty(){if(this[Vr]){this[Vr]=!1;let t=this;for(;t=t.parent;)t[Vr]=!1}}next(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t+1]}positionBy(t,e){let r=this.source.start;if(t.index)r=this.positionInside(t.index,e);else if(t.word){let n=(e=this.toString()).indexOf(t.word);-1!==n&&(r=this.positionInside(n,e))}return r}positionInside(t,e){let r=e||this.toString(),n=this.source.start.column,s=this.source.start.line;for(let e=0;e<t;e++)"\n"===r[e]?(n=1,s+=1):n+=1;return{column:n,line:s}}prev(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t-1]}rangeBy(t){let e={column:this.source.start.column,line:this.source.start.line},r=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:e.column+1,line:e.line};if(t.word){let n=this.toString(),s=n.indexOf(t.word);-1!==s&&(e=this.positionInside(s,n),r=this.positionInside(s+t.word.length,n))}else t.start?e={column:t.start.column,line:t.start.line}:t.index&&(e=this.positionInside(t.index)),t.end?r={column:t.end.column,line:t.end.line}:"number"==typeof t.endIndex?r=this.positionInside(t.endIndex):t.index&&(r=this.positionInside(t.index+1));return(r.line<e.line||r.line===e.line&&r.column<=e.column)&&(r={column:e.column+1,line:e.line}),{end:r,start:e}}raw(t,e){return(new Jr).raw(this,t,e)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...t){if(this.parent){let e=this,r=!1;for(let n of t)n===this?r=!0:r?(this.parent.insertAfter(e,n),e=n):this.parent.insertBefore(e,n);r||this.remove()}return this}root(){let t=this;for(;t.parent&&"document"!==t.parent.type;)t=t.parent;return t}toJSON(t,e){let r={},n=null==e;e=e||new Map;let s=0;for(let t in this){if(!Object.prototype.hasOwnProperty.call(this,t))continue;if("parent"===t||"proxyCache"===t)continue;let n=this[t];if(Array.isArray(n))r[t]=n.map(t=>"object"==typeof t&&t.toJSON?t.toJSON(null,e):t);else if("object"==typeof n&&n.toJSON)r[t]=n.toJSON(null,e);else if("source"===t){let o=e.get(n.input);null==o&&(o=s,e.set(n.input,s),s++),r[t]={end:n.end,inputId:o,start:n.start}}else r[t]=n}return n&&(r.inputs=[...e.keys()].map(t=>t.toJSON())),r}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(t=qr){t.stringify&&(t=t.stringify);let e="";return t(this,t=>{e+=t}),e}warn(t,e,r){let n={node:this};for(let t in r)n[t]=r[t];return t.warn(e,n)}get proxyOf(){return this}};var Xr=Yr;Yr.default=Yr;let $r=Xr,Kr=class extends $r{constructor(t){t&&void 0!==t.value&&"string"!=typeof t.value&&(t={...t,value:String(t.value)}),super(t),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}};var Qr=Kr;Kr.default=Kr;var tn={nanoid:(t=21)=>{let e="",r=t;for(;r--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e},customAlphabet:(t,e=21)=>(r=e)=>{let n="",s=r;for(;s--;)n+=t[Math.random()*t.length|0];return n}};let{SourceMapConsumer:en,SourceMapGenerator:rn}=Ar,{existsSync:nn,readFileSync:sn}=Ar,{dirname:on,join:an}=Ar,ln=class{constructor(t,e){if(!1===e.map)return;this.loadAnnotation(t),this.inline=this.startWith(this.annotation,"data:");let r=e.map?e.map.prev:void 0,n=this.loadMap(e.from,r);!this.mapFile&&e.from&&(this.mapFile=e.from),this.mapFile&&(this.root=on(this.mapFile)),n&&(this.text=n)}consumer(){return this.consumerCache||(this.consumerCache=new en(this.text)),this.consumerCache}decodeInline(t){if(/^data:application\/json;charset=utf-?8,/.test(t)||/^data:application\/json,/.test(t))return decodeURIComponent(t.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(t)||/^data:application\/json;base64,/.test(t))return e=t.substr(RegExp.lastMatch.length),Buffer?Buffer.from(e,"base64").toString():window.atob(e);var e;let r=t.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+r)}getAnnotationURL(t){return t.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(t){return"object"==typeof t&&("string"==typeof t.mappings||"string"==typeof t._mappings||Array.isArray(t.sections))}loadAnnotation(t){let e=t.match(/\/\*\s*# sourceMappingURL=/gm);if(!e)return;let r=t.lastIndexOf(e.pop()),n=t.indexOf("*/",r);r>-1&&n>-1&&(this.annotation=this.getAnnotationURL(t.substring(r,n)))}loadFile(t){if(this.root=on(t),nn(t))return this.mapFile=t,sn(t,"utf-8").toString().trim()}loadMap(t,e){if(!1===e)return!1;if(e){if("string"==typeof e)return e;if("function"!=typeof e){if(e instanceof en)return rn.fromSourceMap(e).toString();if(e instanceof rn)return e.toString();if(this.isMap(e))return JSON.stringify(e);throw new Error("Unsupported previous source map format: "+e.toString())}{let r=e(t);if(r){let t=this.loadFile(r);if(!t)throw new Error("Unable to load previous source map: "+r.toString());return t}}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let e=this.annotation;return t&&(e=an(on(t),e)),this.loadFile(e)}}}startWith(t,e){return!!t&&t.substr(0,e.length)===e}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};var cn=ln;ln.default=ln;let{SourceMapConsumer:un,SourceMapGenerator:hn}=Ar,{fileURLToPath:pn,pathToFileURL:dn}=Ar,{isAbsolute:fn,resolve:mn}=Ar,{nanoid:gn}=tn,yn=Ar,bn=Nr,wn=cn,vn=Symbol("fromOffsetCache"),Sn=Boolean(un&&hn),Cn=Boolean(mn&&fn),In=class{constructor(t,e={}){if(null==t||"object"==typeof t&&!t.toString)throw new Error(`PostCSS received ${t} instead of CSS string`);if(this.css=t.toString(),"\ufeff"===this.css[0]||""===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,e.from&&(!Cn||/^\w+:\/\//.test(e.from)||fn(e.from)?this.file=e.from:this.file=mn(e.from)),Cn&&Sn){let t=new wn(this.css,e);if(t.text){this.map=t;let e=t.consumer().file;!this.file&&e&&(this.file=this.mapResolve(e))}}this.file||(this.id="<input css "+gn(6)+">"),this.map&&(this.map.file=this.from)}error(t,e,r,n={}){let s,o,i;if(e&&"object"==typeof e){let t=e,n=r;if("number"==typeof t.offset){let n=this.fromOffset(t.offset);e=n.line,r=n.col}else e=t.line,r=t.column;if("number"==typeof n.offset){let t=this.fromOffset(n.offset);o=t.line,i=t.col}else o=n.line,i=n.column}else if(!r){let t=this.fromOffset(e);e=t.line,r=t.col}let a=this.origin(e,r,o,i);return s=a?new bn(t,void 0===a.endLine?a.line:{column:a.column,line:a.line},void 0===a.endLine?a.column:{column:a.endColumn,line:a.endLine},a.source,a.file,n.plugin):new bn(t,void 0===o?e:{column:r,line:e},void 0===o?r:{column:i,line:o},this.css,this.file,n.plugin),s.input={column:r,endColumn:i,endLine:o,line:e,source:this.css},this.file&&(dn&&(s.input.url=dn(this.file).toString()),s.input.file=this.file),s}fromOffset(t){let e,r;if(this[vn])r=this[vn];else{let t=this.css.split("\n");r=new Array(t.length);let e=0;for(let n=0,s=t.length;n<s;n++)r[n]=e,e+=t[n].length+1;this[vn]=r}e=r[r.length-1];let n=0;if(t>=e)n=r.length-1;else{let e,s=r.length-2;for(;n<s;)if(e=n+(s-n>>1),t<r[e])s=e-1;else{if(!(t>=r[e+1])){n=e;break}n=e+1}}return{col:t-r[n]+1,line:n+1}}mapResolve(t){return/^\w+:\/\//.test(t)?t:mn(this.map.consumer().sourceRoot||this.map.root||".",t)}origin(t,e,r,n){if(!this.map)return!1;let s,o,i=this.map.consumer(),a=i.originalPositionFor({column:e,line:t});if(!a.source)return!1;"number"==typeof r&&(s=i.originalPositionFor({column:n,line:r})),o=fn(a.source)?dn(a.source):new URL(a.source,this.map.consumer().sourceRoot||dn(this.map.mapFile));let l={column:a.column,endColumn:s&&s.column,endLine:s&&s.line,line:a.line,url:o.toString()};if("file:"===o.protocol){if(!pn)throw new Error("file: protocol is not available in this PostCSS build");l.file=pn(o)}let c=i.sourceContentFor(a.source);return c&&(l.source=c),l}toJSON(){let t={};for(let e of["hasBOM","css","file","id"])null!=this[e]&&(t[e]=this[e]);return this.map&&(t.map={...this.map},t.map.consumerCache&&(t.map.consumerCache=void 0)),t}get from(){return this.file||this.id}};var kn=In;In.default=In,yn&&yn.registerInput&&yn.registerInput(In);let{SourceMapConsumer:xn,SourceMapGenerator:_n}=Ar,{dirname:En,relative:Rn,resolve:On,sep:Mn}=Ar,{pathToFileURL:An}=Ar,Tn=kn,Ln=Boolean(xn&&_n),Pn=Boolean(En&&On&&Rn&&Mn);var Nn=class{constructor(t,e,r,n){this.stringify=t,this.mapOpts=r.map||{},this.root=e,this.opts=r,this.css=n,this.originalCSS=n,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let t;t=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let e="\n";this.css.includes("\r\n")&&(e="\r\n"),this.css+=e+"/*# sourceMappingURL="+t+" */"}applyPrevMaps(){for(let t of this.previous()){let e,r=this.toUrl(this.path(t.file)),n=t.root||En(t.file);!1===this.mapOpts.sourcesContent?(e=new xn(t.text),e.sourcesContent&&(e.sourcesContent=null)):e=t.consumer(),this.map.applySourceMap(e,r,this.toUrl(this.path(n)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let t;for(let e=this.root.nodes.length-1;e>=0;e--)t=this.root.nodes[e],"comment"===t.type&&0===t.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(e)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),Pn&&Ln&&this.isMap())return this.generateMap();{let t="";return this.stringify(this.root,e=>{t+=e}),[t]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let t=this.previous()[0].consumer();t.file=this.outputFile(),this.map=_n.fromSourceMap(t,{ignoreInvalidMapping:!0})}else this.map=new _n({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new _n({file:this.outputFile(),ignoreInvalidMapping:!0});let t,e,r=1,n=1,s="<no source>",o={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,(i,a,l)=>{if(this.css+=i,a&&"end"!==l&&(o.generated.line=r,o.generated.column=n-1,a.source&&a.source.start?(o.source=this.sourcePath(a),o.original.line=a.source.start.line,o.original.column=a.source.start.column-1,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,this.map.addMapping(o))),t=i.match(/\n/g),t?(r+=t.length,e=i.lastIndexOf("\n"),n=i.length-e):n+=i.length,a&&"start"!==l){let t=a.parent||{raws:{}};("decl"===a.type||"atrule"===a.type&&!a.nodes)&&a===t.last&&!t.raws.semicolon||(a.source&&a.source.end?(o.source=this.sourcePath(a),o.original.line=a.source.end.line,o.original.column=a.source.end.column-1,o.generated.line=r,o.generated.column=n-2,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,o.generated.line=r,o.generated.column=n-1,this.map.addMapping(o)))}})}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(t=>t.annotation))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let t=this.mapOpts.annotation;return(void 0===t||!0===t)&&(!this.previous().length||this.previous().some(t=>t.inline))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(t=>t.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(t){if(this.mapOpts.absolute)return t;if(60===t.charCodeAt(0))return t;if(/^\w+:\/\//.test(t))return t;let e=this.memoizedPaths.get(t);if(e)return e;let r=this.opts.to?En(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(r=En(On(r,this.mapOpts.annotation)));let n=Rn(r,t);return this.memoizedPaths.set(t,n),n}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(t=>{if(t.source&&t.source.input.map){let e=t.source.input.map;this.previousMaps.includes(e)||this.previousMaps.push(e)}});else{let t=new Tn(this.originalCSS,this.opts);t.map&&this.previousMaps.push(t.map)}return this.previousMaps}setSourcesContent(){let t={};if(this.root)this.root.walk(e=>{if(e.source){let r=e.source.input.from;if(r&&!t[r]){t[r]=!0;let n=this.usesFileUrls?this.toFileUrl(r):this.toUrl(this.path(r));this.map.setSourceContent(n,e.source.input.css)}}});else if(this.css){let t=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(t,this.css)}}sourcePath(t){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(t.source.input.from):this.toUrl(this.path(t.source.input.from))}toBase64(t){return Buffer?Buffer.from(t).toString("base64"):window.btoa(unescape(encodeURIComponent(t)))}toFileUrl(t){let e=this.memoizedFileURLs.get(t);if(e)return e;if(An){let e=An(t).toString();return this.memoizedFileURLs.set(t,e),e}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(t){let e=this.memoizedURLs.get(t);if(e)return e;"\\"===Mn&&(t=t.replace(/\\/g,"/"));let r=encodeURI(t).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(t,r),r}};let Dn=Xr,Fn=class extends Dn{constructor(t){super(t),this.type="comment"}};var Un=Fn;Fn.default=Fn;let jn,Bn,zn,Wn,{isClean:Vn,my:Hn}=Dr,Gn=Qr,Jn=Un,qn=Xr;function Zn(t){return t.map(t=>(t.nodes&&(t.nodes=Zn(t.nodes)),delete t.source,t))}function Yn(t){if(t[Vn]=!1,t.proxyOf.nodes)for(let e of t.proxyOf.nodes)Yn(e)}let Xn=class t extends qn{append(...t){for(let e of t){let t=this.normalize(e,this.last);for(let e of t)this.proxyOf.nodes.push(e)}return this.markDirty(),this}cleanRaws(t){if(super.cleanRaws(t),this.nodes)for(let e of this.nodes)e.cleanRaws(t)}each(t){if(!this.proxyOf.nodes)return;let e,r,n=this.getIterator();for(;this.indexes[n]<this.proxyOf.nodes.length&&(e=this.indexes[n],r=t(this.proxyOf.nodes[e],e),!1!==r);)this.indexes[n]+=1;return delete this.indexes[n],r}every(t){return this.nodes.every(t)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let t=this.lastEach;return this.indexes[t]=0,t}getProxyProcessor(){return{get:(t,e)=>"proxyOf"===e?t:t[e]?"each"===e||"string"==typeof e&&e.startsWith("walk")?(...r)=>t[e](...r.map(t=>"function"==typeof t?(e,r)=>t(e.toProxy(),r):t)):"every"===e||"some"===e?r=>t[e]((t,...e)=>r(t.toProxy(),...e)):"root"===e?()=>t.root().toProxy():"nodes"===e?t.nodes.map(t=>t.toProxy()):"first"===e||"last"===e?t[e].toProxy():t[e]:t[e],set:(t,e,r)=>(t[e]===r||(t[e]=r,"name"!==e&&"params"!==e&&"selector"!==e||t.markDirty()),!0)}}index(t){return"number"==typeof t?t:(t.proxyOf&&(t=t.proxyOf),this.proxyOf.nodes.indexOf(t))}insertAfter(t,e){let r,n=this.index(t),s=this.normalize(e,this.proxyOf.nodes[n]).reverse();n=this.index(t);for(let t of s)this.proxyOf.nodes.splice(n+1,0,t);for(let t in this.indexes)r=this.indexes[t],n<r&&(this.indexes[t]=r+s.length);return this.markDirty(),this}insertBefore(t,e){let r,n=this.index(t),s=0===n&&"prepend",o=this.normalize(e,this.proxyOf.nodes[n],s).reverse();n=this.index(t);for(let t of o)this.proxyOf.nodes.splice(n,0,t);for(let t in this.indexes)r=this.indexes[t],n<=r&&(this.indexes[t]=r+o.length);return this.markDirty(),this}normalize(e,r){if("string"==typeof e)e=Zn(jn(e).nodes);else if(void 0===e)e=[];else if(Array.isArray(e)){e=e.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if("root"===e.type&&"document"!==this.type){e=e.nodes.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if(e.type)e=[e];else if(e.prop){if(void 0===e.value)throw new Error("Value field is missed in node creation");"string"!=typeof e.value&&(e.value=String(e.value)),e=[new Gn(e)]}else if(e.selector)e=[new Bn(e)];else if(e.name)e=[new zn(e)];else{if(!e.text)throw new Error("Unknown node type in node creation");e=[new Jn(e)]}return e.map(e=>(e[Hn]||t.rebuild(e),(e=e.proxyOf).parent&&e.parent.removeChild(e),e[Vn]&&Yn(e),void 0===e.raws.before&&r&&void 0!==r.raws.before&&(e.raws.before=r.raws.before.replace(/\S/g,"")),e.parent=this.proxyOf,e))}prepend(...t){t=t.reverse();for(let e of t){let t=this.normalize(e,this.first,"prepend").reverse();for(let e of t)this.proxyOf.nodes.unshift(e);for(let e in this.indexes)this.indexes[e]=this.indexes[e]+t.length}return this.markDirty(),this}push(t){return t.parent=this,this.proxyOf.nodes.push(t),this}removeAll(){for(let t of this.proxyOf.nodes)t.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(t){let e;t=this.index(t),this.proxyOf.nodes[t].parent=void 0,this.proxyOf.nodes.splice(t,1);for(let r in this.indexes)e=this.indexes[r],e>=t&&(this.indexes[r]=e-1);return this.markDirty(),this}replaceValues(t,e,r){return r||(r=e,e={}),this.walkDecls(n=>{e.props&&!e.props.includes(n.prop)||e.fast&&!n.value.includes(e.fast)||(n.value=n.value.replace(t,r))}),this.markDirty(),this}some(t){return this.nodes.some(t)}walk(t){return this.each((e,r)=>{let n;try{n=t(e,r)}catch(t){throw e.addToError(t)}return!1!==n&&e.walk&&(n=e.walk(t)),n})}walkAtRules(t,e){return e?t instanceof RegExp?this.walk((r,n)=>{if("atrule"===r.type&&t.test(r.name))return e(r,n)}):this.walk((r,n)=>{if("atrule"===r.type&&r.name===t)return e(r,n)}):(e=t,this.walk((t,r)=>{if("atrule"===t.type)return e(t,r)}))}walkComments(t){return this.walk((e,r)=>{if("comment"===e.type)return t(e,r)})}walkDecls(t,e){return e?t instanceof RegExp?this.walk((r,n)=>{if("decl"===r.type&&t.test(r.prop))return e(r,n)}):this.walk((r,n)=>{if("decl"===r.type&&r.prop===t)return e(r,n)}):(e=t,this.walk((t,r)=>{if("decl"===t.type)return e(t,r)}))}walkRules(t,e){return e?t instanceof RegExp?this.walk((r,n)=>{if("rule"===r.type&&t.test(r.selector))return e(r,n)}):this.walk((r,n)=>{if("rule"===r.type&&r.selector===t)return e(r,n)}):(e=t,this.walk((t,r)=>{if("rule"===t.type)return e(t,r)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};Xn.registerParse=t=>{jn=t},Xn.registerRule=t=>{Bn=t},Xn.registerAtRule=t=>{zn=t},Xn.registerRoot=t=>{Wn=t};var $n=Xn;Xn.default=Xn,Xn.rebuild=t=>{"atrule"===t.type?Object.setPrototypeOf(t,zn.prototype):"rule"===t.type?Object.setPrototypeOf(t,Bn.prototype):"decl"===t.type?Object.setPrototypeOf(t,Gn.prototype):"comment"===t.type?Object.setPrototypeOf(t,Jn.prototype):"root"===t.type&&Object.setPrototypeOf(t,Wn.prototype),t[Hn]=!0,t.nodes&&t.nodes.forEach(t=>{Xn.rebuild(t)})};let Kn,Qn,ts=$n,es=class extends ts{constructor(t){super({type:"document",...t}),this.nodes||(this.nodes=[])}toResult(t={}){return new Kn(new Qn,this,t).stringify()}};es.registerLazyResult=t=>{Kn=t},es.registerProcessor=t=>{Qn=t};var rs=es;es.default=es;let ns=class{constructor(t,e={}){if(this.type="warning",this.text=t,e.node&&e.node.source){let t=e.node.rangeBy(e);this.line=t.start.line,this.column=t.start.column,this.endLine=t.end.line,this.endColumn=t.end.column}for(let t in e)this[t]=e[t]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};var ss=ns;ns.default=ns;let os=ss,is=class{constructor(t,e,r){this.processor=t,this.messages=[],this.root=e,this.opts=r,this.css=void 0,this.map=void 0}toString(){return this.css}warn(t,e={}){e.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(e.plugin=this.lastPlugin.postcssPlugin);let r=new os(t,e);return this.messages.push(r),r}warnings(){return this.messages.filter(t=>"warning"===t.type)}get content(){return this.css}};var as=is;is.default=is;const ls="'".charCodeAt(0),cs='"'.charCodeAt(0),us="\\".charCodeAt(0),hs="/".charCodeAt(0),ps="\n".charCodeAt(0),ds=" ".charCodeAt(0),fs="\f".charCodeAt(0),ms="\t".charCodeAt(0),gs="\r".charCodeAt(0),ys="[".charCodeAt(0),bs="]".charCodeAt(0),ws="(".charCodeAt(0),vs=")".charCodeAt(0),Ss="{".charCodeAt(0),Cs="}".charCodeAt(0),Is=";".charCodeAt(0),ks="*".charCodeAt(0),xs=":".charCodeAt(0),_s="@".charCodeAt(0),Es=/[\t\n\f\r "#'()/;[\\\]{}]/g,Rs=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,Os=/.[\r\n"'(/\\]/,Ms=/[\da-f]/i;let As=$n,Ts=class extends As{constructor(t){super(t),this.type="atrule"}append(...t){return this.proxyOf.nodes||(this.nodes=[]),super.append(...t)}prepend(...t){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...t)}};var Ls=Ts;Ts.default=Ts,As.registerAtRule(Ts);let Ps,Ns,Ds=$n,Fs=class extends Ds{constructor(t){super(t),this.type="root",this.nodes||(this.nodes=[])}normalize(t,e,r){let n=super.normalize(t);if(e)if("prepend"===r)this.nodes.length>1?e.raws.before=this.nodes[1].raws.before:delete e.raws.before;else if(this.first!==e)for(let t of n)t.raws.before=e.raws.before;return n}removeChild(t,e){let r=this.index(t);return!e&&0===r&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[r].raws.before),super.removeChild(t)}toResult(t={}){return new Ps(new Ns,this,t).stringify()}};Fs.registerLazyResult=t=>{Ps=t},Fs.registerProcessor=t=>{Ns=t};var Us=Fs;Fs.default=Fs,Ds.registerRoot(Fs);let js={comma:t=>js.split(t,[","],!0),space:t=>js.split(t,[" ","\n","\t"]),split(t,e,r){let n=[],s="",o=!1,i=0,a=!1,l="",c=!1;for(let r of t)c?c=!1:"\\"===r?c=!0:a?r===l&&(a=!1):'"'===r||"'"===r?(a=!0,l=r):"("===r?i+=1:")"===r?i>0&&(i-=1):0===i&&e.includes(r)&&(o=!0),o?(""!==s&&n.push(s.trim()),s="",o=!1):s+=r;return(r||""!==s)&&n.push(s.trim()),n}};var Bs=js;js.default=js;let zs=$n,Ws=Bs,Vs=class extends zs{constructor(t){super(t),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return Ws.comma(this.selector)}set selectors(t){let e=this.selector?this.selector.match(/,\s*/):null,r=e?e[0]:","+this.raw("between","beforeOpen");this.selector=t.join(r)}};var Hs=Vs;Vs.default=Vs,zs.registerRule(Vs);let Gs=Qr,Js=Un,qs=Ls,Zs=Us,Ys=Hs;const Xs={empty:!0,space:!0};let $s=$n,Ks=class{constructor(t){this.input=t,this.root=new Zs,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:t,start:{column:1,line:1,offset:0}}}atrule(t){let e,r,n,s=new qs;s.name=t[1].slice(1),""===s.name&&this.unnamedAtrule(s,t),this.init(s,t[2]);let o=!1,i=!1,a=[],l=[];for(;!this.tokenizer.endOfFile();){if(e=(t=this.tokenizer.nextToken())[0],"("===e||"["===e?l.push("("===e?")":"]"):"{"===e&&l.length>0?l.push("}"):e===l[l.length-1]&&l.pop(),0===l.length){if(";"===e){s.source.end=this.getPosition(t[2]),s.source.end.offset++,this.semicolon=!0;break}if("{"===e){i=!0;break}if("}"===e){if(a.length>0){for(n=a.length-1,r=a[n];r&&"space"===r[0];)r=a[--n];r&&(s.source.end=this.getPosition(r[3]||r[2]),s.source.end.offset++)}this.end(t);break}a.push(t)}else a.push(t);if(this.tokenizer.endOfFile()){o=!0;break}}s.raws.between=this.spacesAndCommentsFromEnd(a),a.length?(s.raws.afterName=this.spacesAndCommentsFromStart(a),this.raw(s,"params",a),o&&(t=a[a.length-1],s.source.end=this.getPosition(t[3]||t[2]),s.source.end.offset++,this.spaces=s.raws.between,s.raws.between="")):(s.raws.afterName="",s.params=""),i&&(s.nodes=[],this.current=s)}checkMissedSemicolon(t){let e=this.colon(t);if(!1===e)return;let r,n=0;for(let s=e-1;s>=0&&(r=t[s],"space"===r[0]||(n+=1,2!==n));s--);throw this.input.error("Missed semicolon","word"===r[0]?r[3]+1:r[2])}colon(t){let e,r,n,s=0;for(let[o,i]of t.entries()){if(e=i,r=e[0],"("===r&&(s+=1),")"===r&&(s-=1),0===s&&":"===r){if(n){if("word"===n[0]&&"progid"===n[1])continue;return o}this.doubleColon(e)}n=e}return!1}comment(t){let e=new Js;this.init(e,t[2]),e.source.end=this.getPosition(t[3]||t[2]),e.source.end.offset++;let r=t[1].slice(2,-2);if(/^\s*$/.test(r))e.text="",e.raws.left=r,e.raws.right="";else{let t=r.match(/^(\s*)([^]*\S)(\s*)$/);e.text=t[2],e.raws.left=t[1],e.raws.right=t[3]}}createTokenizer(){this.tokenizer=function(t,e={}){let r,n,s,o,i,a,l,c,u,h,p=t.css.valueOf(),d=e.ignoreErrors,f=p.length,m=0,g=[],y=[];function b(e){throw t.error("Unclosed "+e,m)}return{back:function(t){y.push(t)},endOfFile:function(){return 0===y.length&&m>=f},nextToken:function(t){if(y.length)return y.pop();if(m>=f)return;let e=!!t&&t.ignoreUnclosed;switch(r=p.charCodeAt(m),r){case ps:case ds:case ms:case gs:case fs:n=m;do{n+=1,r=p.charCodeAt(n)}while(r===ds||r===ps||r===ms||r===gs||r===fs);h=["space",p.slice(m,n)],m=n-1;break;case ys:case bs:case Ss:case Cs:case xs:case Is:case vs:{let t=String.fromCharCode(r);h=[t,t,m];break}case ws:if(c=g.length?g.pop()[1]:"",u=p.charCodeAt(m+1),"url"===c&&u!==ls&&u!==cs&&u!==ds&&u!==ps&&u!==ms&&u!==fs&&u!==gs){n=m;do{if(a=!1,n=p.indexOf(")",n+1),-1===n){if(d||e){n=m;break}b("bracket")}for(l=n;p.charCodeAt(l-1)===us;)l-=1,a=!a}while(a);h=["brackets",p.slice(m,n+1),m,n],m=n}else n=p.indexOf(")",m+1),o=p.slice(m,n+1),-1===n||Os.test(o)?h=["(","(",m]:(h=["brackets",o,m,n],m=n);break;case ls:case cs:s=r===ls?"'":'"',n=m;do{if(a=!1,n=p.indexOf(s,n+1),-1===n){if(d||e){n=m+1;break}b("string")}for(l=n;p.charCodeAt(l-1)===us;)l-=1,a=!a}while(a);h=["string",p.slice(m,n+1),m,n],m=n;break;case _s:Es.lastIndex=m+1,Es.test(p),n=0===Es.lastIndex?p.length-1:Es.lastIndex-2,h=["at-word",p.slice(m,n+1),m,n],m=n;break;case us:for(n=m,i=!0;p.charCodeAt(n+1)===us;)n+=1,i=!i;if(r=p.charCodeAt(n+1),i&&r!==hs&&r!==ds&&r!==ps&&r!==ms&&r!==gs&&r!==fs&&(n+=1,Ms.test(p.charAt(n)))){for(;Ms.test(p.charAt(n+1));)n+=1;p.charCodeAt(n+1)===ds&&(n+=1)}h=["word",p.slice(m,n+1),m,n],m=n;break;default:r===hs&&p.charCodeAt(m+1)===ks?(n=p.indexOf("*/",m+2)+1,0===n&&(d||e?n=p.length:b("comment")),h=["comment",p.slice(m,n+1),m,n],m=n):(Rs.lastIndex=m+1,Rs.test(p),n=0===Rs.lastIndex?p.length-1:Rs.lastIndex-2,h=["word",p.slice(m,n+1),m,n],g.push(h),m=n)}return m++,h},position:function(){return m}}}(this.input)}decl(t,e){let r=new Gs;this.init(r,t[0][2]);let n,s=t[t.length-1];for(";"===s[0]&&(this.semicolon=!0,t.pop()),r.source.end=this.getPosition(s[3]||s[2]||function(t){for(let e=t.length-1;e>=0;e--){let r=t[e],n=r[3]||r[2];if(n)return n}}(t)),r.source.end.offset++;"word"!==t[0][0];)1===t.length&&this.unknownWord(t),r.raws.before+=t.shift()[1];for(r.source.start=this.getPosition(t[0][2]),r.prop="";t.length;){let e=t[0][0];if(":"===e||"space"===e||"comment"===e)break;r.prop+=t.shift()[1]}for(r.raws.between="";t.length;){if(n=t.shift(),":"===n[0]){r.raws.between+=n[1];break}"word"===n[0]&&/\w/.test(n[1])&&this.unknownWord([n]),r.raws.between+=n[1]}"_"!==r.prop[0]&&"*"!==r.prop[0]||(r.raws.before+=r.prop[0],r.prop=r.prop.slice(1));let o,i=[];for(;t.length&&(o=t[0][0],"space"===o||"comment"===o);)i.push(t.shift());this.precheckMissedSemicolon(t);for(let e=t.length-1;e>=0;e--){if(n=t[e],"!important"===n[1].toLowerCase()){r.important=!0;let n=this.stringFrom(t,e);n=this.spacesFromEnd(t)+n," !important"!==n&&(r.raws.important=n);break}if("important"===n[1].toLowerCase()){let n=t.slice(0),s="";for(let t=e;t>0;t--){let e=n[t][0];if(0===s.trim().indexOf("!")&&"space"!==e)break;s=n.pop()[1]+s}0===s.trim().indexOf("!")&&(r.important=!0,r.raws.important=s,t=n)}if("space"!==n[0]&&"comment"!==n[0])break}t.some(t=>"space"!==t[0]&&"comment"!==t[0])&&(r.raws.between+=i.map(t=>t[1]).join(""),i=[]),this.raw(r,"value",i.concat(t),e),r.value.includes(":")&&!e&&this.checkMissedSemicolon(t)}doubleColon(t){throw this.input.error("Double colon",{offset:t[2]},{offset:t[2]+t[1].length})}emptyRule(t){let e=new Ys;this.init(e,t[2]),e.selector="",e.raws.between="",this.current=e}end(t){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(t[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(t)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(t){if(this.spaces+=t[1],this.current.nodes){let t=this.current.nodes[this.current.nodes.length-1];t&&"rule"===t.type&&!t.raws.ownSemicolon&&(t.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(t){let e=this.input.fromOffset(t);return{column:e.col,line:e.line,offset:t}}init(t,e){this.current.push(t),t.source={input:this.input,start:this.getPosition(e)},t.raws.before=this.spaces,this.spaces="","comment"!==t.type&&(this.semicolon=!1)}other(t){let e=!1,r=null,n=!1,s=null,o=[],i=t[1].startsWith("--"),a=[],l=t;for(;l;){if(r=l[0],a.push(l),"("===r||"["===r)s||(s=l),o.push("("===r?")":"]");else if(i&&n&&"{"===r)s||(s=l),o.push("}");else if(0===o.length){if(";"===r){if(n)return void this.decl(a,i);break}if("{"===r)return void this.rule(a);if("}"===r){this.tokenizer.back(a.pop()),e=!0;break}":"===r&&(n=!0)}else r===o[o.length-1]&&(o.pop(),0===o.length&&(s=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(e=!0),o.length>0&&this.unclosedBracket(s),e&&n){if(!i)for(;a.length&&(l=a[a.length-1][0],"space"===l||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,i)}else this.unknownWord(a)}parse(){let t;for(;!this.tokenizer.endOfFile();)switch(t=this.tokenizer.nextToken(),t[0]){case"space":this.spaces+=t[1];break;case";":this.freeSemicolon(t);break;case"}":this.end(t);break;case"comment":this.comment(t);break;case"at-word":this.atrule(t);break;case"{":this.emptyRule(t);break;default:this.other(t)}this.endFile()}precheckMissedSemicolon(){}raw(t,e,r,n){let s,o,i,a,l=r.length,c="",u=!0;for(let t=0;t<l;t+=1)s=r[t],o=s[0],"space"!==o||t!==l-1||n?"comment"===o?(a=r[t-1]?r[t-1][0]:"empty",i=r[t+1]?r[t+1][0]:"empty",Xs[a]||Xs[i]||","===c.slice(-1)?u=!1:c+=s[1]):c+=s[1]:u=!1;if(!u){let n=r.reduce((t,e)=>t+e[1],"");t.raws[e]={raw:n,value:c}}t[e]=c}rule(t){t.pop();let e=new Ys;this.init(e,t[0][2]),e.raws.between=this.spacesAndCommentsFromEnd(t),this.raw(e,"selector",t),this.current=e}spacesAndCommentsFromEnd(t){let e,r="";for(;t.length&&(e=t[t.length-1][0],"space"===e||"comment"===e);)r=t.pop()[1]+r;return r}spacesAndCommentsFromStart(t){let e,r="";for(;t.length&&(e=t[0][0],"space"===e||"comment"===e);)r+=t.shift()[1];return r}spacesFromEnd(t){let e,r="";for(;t.length&&(e=t[t.length-1][0],"space"===e);)r=t.pop()[1]+r;return r}stringFrom(t,e){let r="";for(let n=e;n<t.length;n++)r+=t[n][1];return t.splice(e,t.length-e),r}unclosedBlock(){let t=this.current.source.start;throw this.input.error("Unclosed block",t.line,t.column)}unclosedBracket(t){throw this.input.error("Unclosed bracket",{offset:t[2]},{offset:t[2]+1})}unexpectedClose(t){throw this.input.error("Unexpected }",{offset:t[2]},{offset:t[2]+1})}unknownWord(t){throw this.input.error("Unknown word",{offset:t[0][2]},{offset:t[0][2]+t[0][1].length})}unnamedAtrule(t,e){throw this.input.error("At-rule without name",{offset:e[2]},{offset:e[2]+e[1].length})}},Qs=kn;function to(t,e){let r=new Qs(t,e),n=new Ks(r);try{n.parse()}catch(t){throw t}return n.root}var eo=to;to.default=to,$s.registerParse(to);let{isClean:ro,my:no}=Dr,so=Nn,oo=Wr,io=$n,ao=rs,lo=as,co=eo,uo=Us;const ho={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},po={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},fo={Once:!0,postcssPlugin:!0,prepare:!0};function mo(t){return"object"==typeof t&&"function"==typeof t.then}function go(t){let e=!1,r=ho[t.type];return"decl"===t.type?e=t.prop.toLowerCase():"atrule"===t.type&&(e=t.name.toLowerCase()),e&&t.append?[r,r+"-"+e,0,r+"Exit",r+"Exit-"+e]:e?[r,r+"-"+e,r+"Exit",r+"Exit-"+e]:t.append?[r,0,r+"Exit"]:[r,r+"Exit"]}function yo(t){let e;return e="document"===t.type?["Document",0,"DocumentExit"]:"root"===t.type?["Root",0,"RootExit"]:go(t),{eventIndex:0,events:e,iterator:0,node:t,visitorIndex:0,visitors:[]}}function bo(t){return t[ro]=!1,t.nodes&&t.nodes.forEach(t=>bo(t)),t}let wo={},vo=class t{constructor(e,r,n){let s;if(this.stringified=!1,this.processed=!1,"object"!=typeof r||null===r||"root"!==r.type&&"document"!==r.type)if(r instanceof t||r instanceof lo)s=bo(r.root),r.map&&(void 0===n.map&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=r.map);else{let t=co;n.syntax&&(t=n.syntax.parse),n.parser&&(t=n.parser),t.parse&&(t=t.parse);try{s=t(r,n)}catch(t){this.processed=!0,this.error=t}s&&!s[no]&&io.rebuild(s)}else s=bo(r);this.result=new lo(e,s,n),this.helpers={...wo,postcss:wo,result:this.result},this.plugins=this.processor.plugins.map(t=>"object"==typeof t&&t.prepare?{...t,...t.prepare(this.result)}:t)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(t){return this.async().catch(t)}finally(t){return this.async().then(t,t)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(t,e){let r=this.result.lastPlugin;try{e&&e.addToError(t),this.error=t,"CssSyntaxError"!==t.name||t.plugin?r.postcssVersion:(t.plugin=r.postcssPlugin,t.setMessage())}catch(t){console&&console.error&&console.error(t)}return t}prepareVisitors(){this.listeners={};let t=(t,e,r)=>{this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push([t,r])};for(let e of this.plugins)if("object"==typeof e)for(let r in e){if(!po[r]&&/^[A-Z]/.test(r))throw new Error(`Unknown event ${r} in ${e.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!fo[r])if("object"==typeof e[r])for(let n in e[r])t(e,"*"===n?r:r+"-"+n.toLowerCase(),e[r][n]);else"function"==typeof e[r]&&t(e,r,e[r])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let t=0;t<this.plugins.length;t++){let e=this.plugins[t],r=this.runOnRoot(e);if(mo(r))try{await r}catch(t){throw this.handleError(t)}}if(this.prepareVisitors(),this.hasListener){let t=this.result.root;for(;!t[ro];){t[ro]=!0;let e=[yo(t)];for(;e.length>0;){let t=this.visitTick(e);if(mo(t))try{await t}catch(t){let r=e[e.length-1].node;throw this.handleError(t,r)}}}if(this.listeners.OnceExit)for(let[e,r]of this.listeners.OnceExit){this.result.lastPlugin=e;try{if("document"===t.type){let e=t.nodes.map(t=>r(t,this.helpers));await Promise.all(e)}else await r(t,this.helpers)}catch(t){throw this.handleError(t)}}}return this.processed=!0,this.stringify()}runOnRoot(t){this.result.lastPlugin=t;try{if("object"==typeof t&&t.Once){if("document"===this.result.root.type){let e=this.result.root.nodes.map(e=>t.Once(e,this.helpers));return mo(e[0])?Promise.all(e):e}return t.Once(this.result.root,this.helpers)}if("function"==typeof t)return t(this.result.root,this.result)}catch(t){throw this.handleError(t)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let t=this.result.opts,e=oo;t.syntax&&(e=t.syntax.stringify),t.stringifier&&(e=t.stringifier),e.stringify&&(e=e.stringify);let r=new so(e,this.result.root,this.result.opts).generate();return this.result.css=r[0],this.result.map=r[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let t of this.plugins)if(mo(this.runOnRoot(t)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){let t=this.result.root;for(;!t[ro];)t[ro]=!0,this.walkSync(t);if(this.listeners.OnceExit)if("document"===t.type)for(let e of t.nodes)this.visitSync(this.listeners.OnceExit,e);else this.visitSync(this.listeners.OnceExit,t)}return this.result}then(t,e){return this.async().then(t,e)}toString(){return this.css}visitSync(t,e){for(let[r,n]of t){let t;this.result.lastPlugin=r;try{t=n(e,this.helpers)}catch(t){throw this.handleError(t,e.proxyOf)}if("root"!==e.type&&"document"!==e.type&&!e.parent)return!0;if(mo(t))throw this.getAsyncError()}}visitTick(t){let e=t[t.length-1],{node:r,visitors:n}=e;if("root"!==r.type&&"document"!==r.type&&!r.parent)return void t.pop();if(n.length>0&&e.visitorIndex<n.length){let[t,s]=n[e.visitorIndex];e.visitorIndex+=1,e.visitorIndex===n.length&&(e.visitors=[],e.visitorIndex=0),this.result.lastPlugin=t;try{return s(r.toProxy(),this.helpers)}catch(t){throw this.handleError(t,r)}}if(0!==e.iterator){let n,s=e.iterator;for(;n=r.nodes[r.indexes[s]];)if(r.indexes[s]+=1,!n[ro])return n[ro]=!0,void t.push(yo(n));e.iterator=0,delete r.indexes[s]}let s=e.events;for(;e.eventIndex<s.length;){let t=s[e.eventIndex];if(e.eventIndex+=1,0===t)return void(r.nodes&&r.nodes.length&&(r[ro]=!0,e.iterator=r.getIterator()));if(this.listeners[t])return void(e.visitors=this.listeners[t])}t.pop()}walkSync(t){t[ro]=!0;let e=go(t);for(let r of e)if(0===r)t.nodes&&t.each(t=>{t[ro]||this.walkSync(t)});else{let e=this.listeners[r];if(e&&this.visitSync(e,t.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};vo.registerPostcss=t=>{wo=t};var So=vo;vo.default=vo,uo.registerLazyResult(vo),ao.registerLazyResult(vo);let Co=Nn,Io=Wr,ko=eo;const xo=as;let _o=class{constructor(t,e,r){let n;e=e.toString(),this.stringified=!1,this._processor=t,this._css=e,this._opts=r,this._map=void 0;let s=Io;this.result=new xo(this._processor,n,this._opts),this.result.css=e;let o=this;Object.defineProperty(this.result,"root",{get:()=>o.root});let i=new Co(s,n,this._opts,e);if(i.isMap()){let[t,e]=i.generate();t&&(this.result.css=t),e&&(this.result.map=e)}else i.clearAnnotation(),this.result.css=i.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(t){return this.async().catch(t)}finally(t){return this.async().then(t,t)}sync(){if(this.error)throw this.error;return this.result}then(t,e){return this.async().then(t,e)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let t,e=ko;try{t=e(this._css,this._opts)}catch(t){this.error=t}if(this.error)throw this.error;return this._root=t,t}get[Symbol.toStringTag](){return"NoWorkResult"}};var Eo=_o;_o.default=_o;let Ro=Eo,Oo=So,Mo=rs,Ao=Us,To=class{constructor(t=[]){this.version="8.4.38",this.plugins=this.normalize(t)}normalize(t){let e=[];for(let r of t)if(!0===r.postcss?r=r():r.postcss&&(r=r.postcss),"object"==typeof r&&Array.isArray(r.plugins))e=e.concat(r.plugins);else if("object"==typeof r&&r.postcssPlugin)e.push(r);else if("function"==typeof r)e.push(r);else if("object"!=typeof r||!r.parse&&!r.stringify)throw new Error(r+" is not a PostCSS plugin");return e}process(t,e={}){return this.plugins.length||e.parser||e.stringifier||e.syntax?new Oo(this,t,e):new Ro(this,t,e)}use(t){return this.plugins=this.plugins.concat(this.normalize([t])),this}};var Lo=To;To.default=To,Ao.registerProcessor(To),Mo.registerProcessor(To);let Po=Qr,No=cn,Do=Un,Fo=Ls,Uo=kn,jo=Us,Bo=Hs;function zo(t,e){if(Array.isArray(t))return t.map(t=>zo(t));let{inputs:r,...n}=t;if(r){e=[];for(let t of r){let r={...t,__proto__:Uo.prototype};r.map&&(r.map={...r.map,__proto__:No.prototype}),e.push(r)}}if(n.nodes&&(n.nodes=t.nodes.map(t=>zo(t,e))),n.source){let{inputId:t,...r}=n.source;n.source=r,null!=t&&(n.source.input=e[t])}if("root"===n.type)return new jo(n);if("decl"===n.type)return new Po(n);if("rule"===n.type)return new Bo(n);if("comment"===n.type)return new Do(n);if("atrule"===n.type)return new Fo(n);throw new Error("Unknown node type: "+t.type)}var Wo=zo;zo.default=zo;let Vo=Nr,Ho=Qr,Go=So,Jo=$n,qo=Lo,Zo=Wr,Yo=Wo,Xo=rs,$o=ss,Ko=Un,Qo=Ls,ti=as,ei=kn,ri=eo,ni=Bs,si=Hs,oi=Us,ii=Xr;function ai(...t){return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),new qo(t)}ai.plugin=function(t,e){let r,n=!1;function s(...r){console&&console.warn&&!n&&(n=!0,console.warn(t+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(t+":  postcss.plugin . :\nhttps://www.w3ctech.com/topic/2226"));let s=e(...r);return s.postcssPlugin=t,s.postcssVersion=(new qo).version,s}return Object.defineProperty(s,"postcss",{get:()=>(r||(r=s()),r)}),s.process=function(t,e,r){return ai([s(r)]).process(t,e)},s},ai.stringify=Zo,ai.parse=ri,ai.fromJSON=Yo,ai.list=ni,ai.comment=t=>new Ko(t),ai.atRule=t=>new Qo(t),ai.decl=t=>new Ho(t),ai.rule=t=>new si(t),ai.root=t=>new oi(t),ai.document=t=>new Xo(t),ai.CssSyntaxError=Vo,ai.Declaration=Ho,ai.Container=Jo,ai.Processor=qo,ai.Document=Xo,ai.Comment=Ko,ai.Warning=$o,ai.AtRule=Qo,ai.Result=ti,ai.Input=ei,ai.Rule=si,ai.Root=oi,ai.Node=ii,Go.registerPostcss(ai);var li=ai;ai.default=ai;const ci=xr(li);ci.stringify,ci.fromJSON,ci.plugin,ci.parse,ci.list,ci.document,ci.comment,ci.atRule,ci.rule,ci.decl,ci.root,ci.CssSyntaxError,ci.Declaration,ci.Container,ci.Processor,ci.Document,ci.Comment,ci.Warning,ci.AtRule,ci.Result,ci.Input,ci.Rule,ci.Root,ci.Node;var ui=Object.defineProperty,hi=(t,e,r)=>((t,e,r)=>e in t?ui(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r);function pi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function di(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),r}var fi={exports:{}},mi=String,gi=function(){return{isColorSupported:!1,reset:mi,bold:mi,dim:mi,italic:mi,underline:mi,inverse:mi,hidden:mi,strikethrough:mi,black:mi,red:mi,green:mi,yellow:mi,blue:mi,magenta:mi,cyan:mi,white:mi,gray:mi,bgBlack:mi,bgRed:mi,bgGreen:mi,bgYellow:mi,bgBlue:mi,bgMagenta:mi,bgCyan:mi,bgWhite:mi}};fi.exports=gi(),fi.exports.createColors=gi;var yi=fi.exports;const bi=di(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));let wi=yi,vi=bi,Si=class t extends Error{constructor(e,r,n,s,o,i){super(e),this.name="CssSyntaxError",this.reason=e,o&&(this.file=o),s&&(this.source=s),i&&(this.plugin=i),void 0!==r&&void 0!==n&&("number"==typeof r?(this.line=r,this.column=n):(this.line=r.line,this.column=r.column,this.endLine=n.line,this.endColumn=n.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,t)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",void 0!==this.line&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(t){if(!this.source)return"";let e=this.source;null==t&&(t=wi.isColorSupported),vi&&t&&(e=vi(e));let r,n,s=e.split(/\r?\n/),o=Math.max(this.line-3,0),i=Math.min(this.line+2,s.length),a=String(i).length;if(t){let{bold:t,gray:e,red:s}=wi.createColors(!0);r=e=>t(s(e)),n=t=>e(t)}else r=n=t=>t;return s.slice(o,i).map((t,e)=>{let s=o+1+e,i=" "+(" "+s).slice(-a)+" | ";if(s===this.line){let e=n(i.replace(/\d/g," "))+t.slice(0,this.column-1).replace(/[^\t]/g," ");return r(">")+n(i)+t+"\n "+e+r("^")}return" "+n(i)+t}).join("\n")}toString(){let t=this.showSourceCode();return t&&(t="\n\n"+t+"\n"),this.name+": "+this.message+t}};var Ci=Si;Si.default=Si;var Ii={};Ii.isClean=Symbol("isClean"),Ii.my=Symbol("my");const ki={after:"\n",beforeClose:"\n",beforeComment:"\n",beforeDecl:"\n",beforeOpen:" ",beforeRule:"\n",colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};let xi=class{constructor(t){this.builder=t}atrule(t,e){let r="@"+t.name,n=t.params?this.rawValue(t,"params"):"";if(void 0!==t.raws.afterName?r+=t.raws.afterName:n&&(r+=" "),t.nodes)this.block(t,r+n);else{let s=(t.raws.between||"")+(e?";":"");this.builder(r+n+s,t)}}beforeAfter(t,e){let r;r="decl"===t.type?this.raw(t,null,"beforeDecl"):"comment"===t.type?this.raw(t,null,"beforeComment"):"before"===e?this.raw(t,null,"beforeRule"):this.raw(t,null,"beforeClose");let n=t.parent,s=0;for(;n&&"root"!==n.type;)s+=1,n=n.parent;if(r.includes("\n")){let e=this.raw(t,null,"indent");if(e.length)for(let t=0;t<s;t++)r+=e}return r}block(t,e){let r,n=this.raw(t,"between","beforeOpen");this.builder(e+n+"{",t,"start"),t.nodes&&t.nodes.length?(this.body(t),r=this.raw(t,"after")):r=this.raw(t,"after","emptyBody"),r&&this.builder(r),this.builder("}",t,"end")}body(t){let e=t.nodes.length-1;for(;e>0&&"comment"===t.nodes[e].type;)e-=1;let r=this.raw(t,"semicolon");for(let n=0;n<t.nodes.length;n++){let s=t.nodes[n],o=this.raw(s,"before");o&&this.builder(o),this.stringify(s,e!==n||r)}}comment(t){let e=this.raw(t,"left","commentLeft"),r=this.raw(t,"right","commentRight");this.builder("/*"+e+t.text+r+"*/",t)}decl(t,e){let r=this.raw(t,"between","colon"),n=t.prop+r+this.rawValue(t,"value");t.important&&(n+=t.raws.important||" !important"),e&&(n+=";"),this.builder(n,t)}document(t){this.body(t)}raw(t,e,r){let n;if(r||(r=e),e&&(n=t.raws[e],void 0!==n))return n;let s=t.parent;if("before"===r){if(!s||"root"===s.type&&s.first===t)return"";if(s&&"document"===s.type)return""}if(!s)return ki[r];let o=t.root();if(o.rawCache||(o.rawCache={}),void 0!==o.rawCache[r])return o.rawCache[r];if("before"===r||"after"===r)return this.beforeAfter(t,r);{let s="raw"+((i=r)[0].toUpperCase()+i.slice(1));this[s]?n=this[s](o,t):o.walk(t=>{if(n=t.raws[e],void 0!==n)return!1})}var i;return void 0===n&&(n=ki[r]),o.rawCache[r]=n,n}rawBeforeClose(t){let e;return t.walk(t=>{if(t.nodes&&t.nodes.length>0&&void 0!==t.raws.after)return e=t.raws.after,e.includes("\n")&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawBeforeComment(t,e){let r;return t.walkComments(t=>{if(void 0!==t.raws.before)return r=t.raws.before,r.includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(e,null,"beforeDecl"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeDecl(t,e){let r;return t.walkDecls(t=>{if(void 0!==t.raws.before)return r=t.raws.before,r.includes("\n")&&(r=r.replace(/[^\n]+$/,"")),!1}),void 0===r?r=this.raw(e,null,"beforeRule"):r&&(r=r.replace(/\S/g,"")),r}rawBeforeOpen(t){let e;return t.walk(t=>{if("decl"!==t.type&&(e=t.raws.between,void 0!==e))return!1}),e}rawBeforeRule(t){let e;return t.walk(r=>{if(r.nodes&&(r.parent!==t||t.first!==r)&&void 0!==r.raws.before)return e=r.raws.before,e.includes("\n")&&(e=e.replace(/[^\n]+$/,"")),!1}),e&&(e=e.replace(/\S/g,"")),e}rawColon(t){let e;return t.walkDecls(t=>{if(void 0!==t.raws.between)return e=t.raws.between.replace(/[^\s:]/g,""),!1}),e}rawEmptyBody(t){let e;return t.walk(t=>{if(t.nodes&&0===t.nodes.length&&(e=t.raws.after,void 0!==e))return!1}),e}rawIndent(t){if(t.raws.indent)return t.raws.indent;let e;return t.walk(r=>{let n=r.parent;if(n&&n!==t&&n.parent&&n.parent===t&&void 0!==r.raws.before){let t=r.raws.before.split("\n");return e=t[t.length-1],e=e.replace(/\S/g,""),!1}}),e}rawSemicolon(t){let e;return t.walk(t=>{if(t.nodes&&t.nodes.length&&"decl"===t.last.type&&(e=t.raws.semicolon,void 0!==e))return!1}),e}rawValue(t,e){let r=t[e],n=t.raws[e];return n&&n.value===r?n.raw:r}root(t){this.body(t),t.raws.after&&this.builder(t.raws.after)}rule(t){this.block(t,this.rawValue(t,"selector")),t.raws.ownSemicolon&&this.builder(t.raws.ownSemicolon,t,"end")}stringify(t,e){if(!this[t.type])throw new Error("Unknown AST node type "+t.type+". Maybe you need to change PostCSS stringifier.");this[t.type](t,e)}};var _i=xi;xi.default=xi;let Ei=_i;function Ri(t,e){new Ei(e).stringify(t)}var Oi=Ri;Ri.default=Ri;let{isClean:Mi,my:Ai}=Ii,Ti=Ci,Li=_i,Pi=Oi;function Ni(t,e){let r=new t.constructor;for(let n in t){if(!Object.prototype.hasOwnProperty.call(t,n))continue;if("proxyCache"===n)continue;let s=t[n],o=typeof s;"parent"===n&&"object"===o?e&&(r[n]=e):"source"===n?r[n]=s:Array.isArray(s)?r[n]=s.map(t=>Ni(t,r)):("object"===o&&null!==s&&(s=Ni(s)),r[n]=s)}return r}let Di=class{constructor(t={}){this.raws={},this[Mi]=!1,this[Ai]=!0;for(let e in t)if("nodes"===e){this.nodes=[];for(let r of t[e])"function"==typeof r.clone?this.append(r.clone()):this.append(r)}else this[e]=t[e]}addToError(t){if(t.postcssNode=this,t.stack&&this.source&&/\n\s{4}at /.test(t.stack)){let e=this.source;t.stack=t.stack.replace(/\n\s{4}at /,`$&${e.input.from}:${e.start.line}:${e.start.column}$&`)}return t}after(t){return this.parent.insertAfter(this,t),this}assign(t={}){for(let e in t)this[e]=t[e];return this}before(t){return this.parent.insertBefore(this,t),this}cleanRaws(t){delete this.raws.before,delete this.raws.after,t||delete this.raws.between}clone(t={}){let e=Ni(this);for(let r in t)e[r]=t[r];return e}cloneAfter(t={}){let e=this.clone(t);return this.parent.insertAfter(this,e),e}cloneBefore(t={}){let e=this.clone(t);return this.parent.insertBefore(this,e),e}error(t,e={}){if(this.source){let{end:r,start:n}=this.rangeBy(e);return this.source.input.error(t,{column:n.column,line:n.line},{column:r.column,line:r.line},e)}return new Ti(t)}getProxyProcessor(){return{get:(t,e)=>"proxyOf"===e?t:"root"===e?()=>t.root().toProxy():t[e],set:(t,e,r)=>(t[e]===r||(t[e]=r,"prop"!==e&&"value"!==e&&"name"!==e&&"params"!==e&&"important"!==e&&"text"!==e||t.markDirty()),!0)}}markDirty(){if(this[Mi]){this[Mi]=!1;let t=this;for(;t=t.parent;)t[Mi]=!1}}next(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t+1]}positionBy(t,e){let r=this.source.start;if(t.index)r=this.positionInside(t.index,e);else if(t.word){let n=(e=this.toString()).indexOf(t.word);-1!==n&&(r=this.positionInside(n,e))}return r}positionInside(t,e){let r=e||this.toString(),n=this.source.start.column,s=this.source.start.line;for(let e=0;e<t;e++)"\n"===r[e]?(n=1,s+=1):n+=1;return{column:n,line:s}}prev(){if(!this.parent)return;let t=this.parent.index(this);return this.parent.nodes[t-1]}rangeBy(t){let e={column:this.source.start.column,line:this.source.start.line},r=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:e.column+1,line:e.line};if(t.word){let n=this.toString(),s=n.indexOf(t.word);-1!==s&&(e=this.positionInside(s,n),r=this.positionInside(s+t.word.length,n))}else t.start?e={column:t.start.column,line:t.start.line}:t.index&&(e=this.positionInside(t.index)),t.end?r={column:t.end.column,line:t.end.line}:"number"==typeof t.endIndex?r=this.positionInside(t.endIndex):t.index&&(r=this.positionInside(t.index+1));return(r.line<e.line||r.line===e.line&&r.column<=e.column)&&(r={column:e.column+1,line:e.line}),{end:r,start:e}}raw(t,e){return(new Li).raw(this,t,e)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...t){if(this.parent){let e=this,r=!1;for(let n of t)n===this?r=!0:r?(this.parent.insertAfter(e,n),e=n):this.parent.insertBefore(e,n);r||this.remove()}return this}root(){let t=this;for(;t.parent&&"document"!==t.parent.type;)t=t.parent;return t}toJSON(t,e){let r={},n=null==e;e=e||new Map;let s=0;for(let t in this){if(!Object.prototype.hasOwnProperty.call(this,t))continue;if("parent"===t||"proxyCache"===t)continue;let n=this[t];if(Array.isArray(n))r[t]=n.map(t=>"object"==typeof t&&t.toJSON?t.toJSON(null,e):t);else if("object"==typeof n&&n.toJSON)r[t]=n.toJSON(null,e);else if("source"===t){let o=e.get(n.input);null==o&&(o=s,e.set(n.input,s),s++),r[t]={end:n.end,inputId:o,start:n.start}}else r[t]=n}return n&&(r.inputs=[...e.keys()].map(t=>t.toJSON())),r}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(t=Pi){t.stringify&&(t=t.stringify);let e="";return t(this,t=>{e+=t}),e}warn(t,e,r){let n={node:this};for(let t in r)n[t]=r[t];return t.warn(e,n)}get proxyOf(){return this}};var Fi=Di;Di.default=Di;let Ui=Fi,ji=class extends Ui{constructor(t){t&&void 0!==t.value&&"string"!=typeof t.value&&(t={...t,value:String(t.value)}),super(t),this.type="decl"}get variable(){return this.prop.startsWith("--")||"$"===this.prop[0]}};var Bi=ji;ji.default=ji;var zi={nanoid:(t=21)=>{let e="",r=t;for(;r--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e},customAlphabet:(t,e=21)=>(r=e)=>{let n="",s=r;for(;s--;)n+=t[Math.random()*t.length|0];return n}};let{SourceMapConsumer:Wi,SourceMapGenerator:Vi}=bi,{existsSync:Hi,readFileSync:Gi}=bi,{dirname:Ji,join:qi}=bi,Zi=class{constructor(t,e){if(!1===e.map)return;this.loadAnnotation(t),this.inline=this.startWith(this.annotation,"data:");let r=e.map?e.map.prev:void 0,n=this.loadMap(e.from,r);!this.mapFile&&e.from&&(this.mapFile=e.from),this.mapFile&&(this.root=Ji(this.mapFile)),n&&(this.text=n)}consumer(){return this.consumerCache||(this.consumerCache=new Wi(this.text)),this.consumerCache}decodeInline(t){if(/^data:application\/json;charset=utf-?8,/.test(t)||/^data:application\/json,/.test(t))return decodeURIComponent(t.substr(RegExp.lastMatch.length));if(/^data:application\/json;charset=utf-?8;base64,/.test(t)||/^data:application\/json;base64,/.test(t))return e=t.substr(RegExp.lastMatch.length),Buffer?Buffer.from(e,"base64").toString():window.atob(e);var e;let r=t.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+r)}getAnnotationURL(t){return t.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(t){return"object"==typeof t&&("string"==typeof t.mappings||"string"==typeof t._mappings||Array.isArray(t.sections))}loadAnnotation(t){let e=t.match(/\/\*\s*# sourceMappingURL=/gm);if(!e)return;let r=t.lastIndexOf(e.pop()),n=t.indexOf("*/",r);r>-1&&n>-1&&(this.annotation=this.getAnnotationURL(t.substring(r,n)))}loadFile(t){if(this.root=Ji(t),Hi(t))return this.mapFile=t,Gi(t,"utf-8").toString().trim()}loadMap(t,e){if(!1===e)return!1;if(e){if("string"==typeof e)return e;if("function"!=typeof e){if(e instanceof Wi)return Vi.fromSourceMap(e).toString();if(e instanceof Vi)return e.toString();if(this.isMap(e))return JSON.stringify(e);throw new Error("Unsupported previous source map format: "+e.toString())}{let r=e(t);if(r){let t=this.loadFile(r);if(!t)throw new Error("Unable to load previous source map: "+r.toString());return t}}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let e=this.annotation;return t&&(e=qi(Ji(t),e)),this.loadFile(e)}}}startWith(t,e){return!!t&&t.substr(0,e.length)===e}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};var Yi=Zi;Zi.default=Zi;let{SourceMapConsumer:Xi,SourceMapGenerator:$i}=bi,{fileURLToPath:Ki,pathToFileURL:Qi}=bi,{isAbsolute:ta,resolve:ea}=bi,{nanoid:ra}=zi,na=bi,sa=Ci,oa=Yi,ia=Symbol("fromOffsetCache"),aa=Boolean(Xi&&$i),la=Boolean(ea&&ta),ca=class{constructor(t,e={}){if(null==t||"object"==typeof t&&!t.toString)throw new Error(`PostCSS received ${t} instead of CSS string`);if(this.css=t.toString(),"\ufeff"===this.css[0]||""===this.css[0]?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,e.from&&(!la||/^\w+:\/\//.test(e.from)||ta(e.from)?this.file=e.from:this.file=ea(e.from)),la&&aa){let t=new oa(this.css,e);if(t.text){this.map=t;let e=t.consumer().file;!this.file&&e&&(this.file=this.mapResolve(e))}}this.file||(this.id="<input css "+ra(6)+">"),this.map&&(this.map.file=this.from)}error(t,e,r,n={}){let s,o,i;if(e&&"object"==typeof e){let t=e,n=r;if("number"==typeof t.offset){let n=this.fromOffset(t.offset);e=n.line,r=n.col}else e=t.line,r=t.column;if("number"==typeof n.offset){let t=this.fromOffset(n.offset);o=t.line,i=t.col}else o=n.line,i=n.column}else if(!r){let t=this.fromOffset(e);e=t.line,r=t.col}let a=this.origin(e,r,o,i);return s=a?new sa(t,void 0===a.endLine?a.line:{column:a.column,line:a.line},void 0===a.endLine?a.column:{column:a.endColumn,line:a.endLine},a.source,a.file,n.plugin):new sa(t,void 0===o?e:{column:r,line:e},void 0===o?r:{column:i,line:o},this.css,this.file,n.plugin),s.input={column:r,endColumn:i,endLine:o,line:e,source:this.css},this.file&&(Qi&&(s.input.url=Qi(this.file).toString()),s.input.file=this.file),s}fromOffset(t){let e,r;if(this[ia])r=this[ia];else{let t=this.css.split("\n");r=new Array(t.length);let e=0;for(let n=0,s=t.length;n<s;n++)r[n]=e,e+=t[n].length+1;this[ia]=r}e=r[r.length-1];let n=0;if(t>=e)n=r.length-1;else{let e,s=r.length-2;for(;n<s;)if(e=n+(s-n>>1),t<r[e])s=e-1;else{if(!(t>=r[e+1])){n=e;break}n=e+1}}return{col:t-r[n]+1,line:n+1}}mapResolve(t){return/^\w+:\/\//.test(t)?t:ea(this.map.consumer().sourceRoot||this.map.root||".",t)}origin(t,e,r,n){if(!this.map)return!1;let s,o,i=this.map.consumer(),a=i.originalPositionFor({column:e,line:t});if(!a.source)return!1;"number"==typeof r&&(s=i.originalPositionFor({column:n,line:r})),o=ta(a.source)?Qi(a.source):new URL(a.source,this.map.consumer().sourceRoot||Qi(this.map.mapFile));let l={column:a.column,endColumn:s&&s.column,endLine:s&&s.line,line:a.line,url:o.toString()};if("file:"===o.protocol){if(!Ki)throw new Error("file: protocol is not available in this PostCSS build");l.file=Ki(o)}let c=i.sourceContentFor(a.source);return c&&(l.source=c),l}toJSON(){let t={};for(let e of["hasBOM","css","file","id"])null!=this[e]&&(t[e]=this[e]);return this.map&&(t.map={...this.map},t.map.consumerCache&&(t.map.consumerCache=void 0)),t}get from(){return this.file||this.id}};var ua=ca;ca.default=ca,na&&na.registerInput&&na.registerInput(ca);let{SourceMapConsumer:ha,SourceMapGenerator:pa}=bi,{dirname:da,relative:fa,resolve:ma,sep:ga}=bi,{pathToFileURL:ya}=bi,ba=ua,wa=Boolean(ha&&pa),va=Boolean(da&&ma&&fa&&ga);var Sa=class{constructor(t,e,r,n){this.stringify=t,this.mapOpts=r.map||{},this.root=e,this.opts=r,this.css=n,this.originalCSS=n,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute,this.memoizedFileURLs=new Map,this.memoizedPaths=new Map,this.memoizedURLs=new Map}addAnnotation(){let t;t=this.isInline()?"data:application/json;base64,"+this.toBase64(this.map.toString()):"string"==typeof this.mapOpts.annotation?this.mapOpts.annotation:"function"==typeof this.mapOpts.annotation?this.mapOpts.annotation(this.opts.to,this.root):this.outputFile()+".map";let e="\n";this.css.includes("\r\n")&&(e="\r\n"),this.css+=e+"/*# sourceMappingURL="+t+" */"}applyPrevMaps(){for(let t of this.previous()){let e,r=this.toUrl(this.path(t.file)),n=t.root||da(t.file);!1===this.mapOpts.sourcesContent?(e=new ha(t.text),e.sourcesContent&&(e.sourcesContent=null)):e=t.consumer(),this.map.applySourceMap(e,r,this.toUrl(this.path(n)))}}clearAnnotation(){if(!1!==this.mapOpts.annotation)if(this.root){let t;for(let e=this.root.nodes.length-1;e>=0;e--)t=this.root.nodes[e],"comment"===t.type&&0===t.text.indexOf("# sourceMappingURL=")&&this.root.removeChild(e)}else this.css&&(this.css=this.css.replace(/\n*?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),va&&wa&&this.isMap())return this.generateMap();{let t="";return this.stringify(this.root,e=>{t+=e}),[t]}}generateMap(){if(this.root)this.generateString();else if(1===this.previous().length){let t=this.previous()[0].consumer();t.file=this.outputFile(),this.map=pa.fromSourceMap(t,{ignoreInvalidMapping:!0})}else this.map=new pa({file:this.outputFile(),ignoreInvalidMapping:!0}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new pa({file:this.outputFile(),ignoreInvalidMapping:!0});let t,e,r=1,n=1,s="<no source>",o={generated:{column:0,line:0},original:{column:0,line:0},source:""};this.stringify(this.root,(i,a,l)=>{if(this.css+=i,a&&"end"!==l&&(o.generated.line=r,o.generated.column=n-1,a.source&&a.source.start?(o.source=this.sourcePath(a),o.original.line=a.source.start.line,o.original.column=a.source.start.column-1,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,this.map.addMapping(o))),t=i.match(/\n/g),t?(r+=t.length,e=i.lastIndexOf("\n"),n=i.length-e):n+=i.length,a&&"start"!==l){let t=a.parent||{raws:{}};("decl"===a.type||"atrule"===a.type&&!a.nodes)&&a===t.last&&!t.raws.semicolon||(a.source&&a.source.end?(o.source=this.sourcePath(a),o.original.line=a.source.end.line,o.original.column=a.source.end.column-1,o.generated.line=r,o.generated.column=n-2,this.map.addMapping(o)):(o.source=s,o.original.line=1,o.original.column=0,o.generated.line=r,o.generated.column=n-1,this.map.addMapping(o)))}})}isAnnotation(){return!!this.isInline()||(void 0!==this.mapOpts.annotation?this.mapOpts.annotation:!this.previous().length||this.previous().some(t=>t.annotation))}isInline(){if(void 0!==this.mapOpts.inline)return this.mapOpts.inline;let t=this.mapOpts.annotation;return(void 0===t||!0===t)&&(!this.previous().length||this.previous().some(t=>t.inline))}isMap(){return void 0!==this.opts.map?!!this.opts.map:this.previous().length>0}isSourcesContent(){return void 0!==this.mapOpts.sourcesContent?this.mapOpts.sourcesContent:!this.previous().length||this.previous().some(t=>t.withContent())}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(t){if(this.mapOpts.absolute)return t;if(60===t.charCodeAt(0))return t;if(/^\w+:\/\//.test(t))return t;let e=this.memoizedPaths.get(t);if(e)return e;let r=this.opts.to?da(this.opts.to):".";"string"==typeof this.mapOpts.annotation&&(r=da(ma(r,this.mapOpts.annotation)));let n=fa(r,t);return this.memoizedPaths.set(t,n),n}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(t=>{if(t.source&&t.source.input.map){let e=t.source.input.map;this.previousMaps.includes(e)||this.previousMaps.push(e)}});else{let t=new ba(this.originalCSS,this.opts);t.map&&this.previousMaps.push(t.map)}return this.previousMaps}setSourcesContent(){let t={};if(this.root)this.root.walk(e=>{if(e.source){let r=e.source.input.from;if(r&&!t[r]){t[r]=!0;let n=this.usesFileUrls?this.toFileUrl(r):this.toUrl(this.path(r));this.map.setSourceContent(n,e.source.input.css)}}});else if(this.css){let t=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(t,this.css)}}sourcePath(t){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(t.source.input.from):this.toUrl(this.path(t.source.input.from))}toBase64(t){return Buffer?Buffer.from(t).toString("base64"):window.btoa(unescape(encodeURIComponent(t)))}toFileUrl(t){let e=this.memoizedFileURLs.get(t);if(e)return e;if(ya){let e=ya(t).toString();return this.memoizedFileURLs.set(t,e),e}throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(t){let e=this.memoizedURLs.get(t);if(e)return e;"\\"===ga&&(t=t.replace(/\\/g,"/"));let r=encodeURI(t).replace(/[#?]/g,encodeURIComponent);return this.memoizedURLs.set(t,r),r}};let Ca=Fi,Ia=class extends Ca{constructor(t){super(t),this.type="comment"}};var ka=Ia;Ia.default=Ia;let xa,_a,Ea,Ra,{isClean:Oa,my:Ma}=Ii,Aa=Bi,Ta=ka,La=Fi;function Pa(t){return t.map(t=>(t.nodes&&(t.nodes=Pa(t.nodes)),delete t.source,t))}function Na(t){if(t[Oa]=!1,t.proxyOf.nodes)for(let e of t.proxyOf.nodes)Na(e)}let Da=class t extends La{append(...t){for(let e of t){let t=this.normalize(e,this.last);for(let e of t)this.proxyOf.nodes.push(e)}return this.markDirty(),this}cleanRaws(t){if(super.cleanRaws(t),this.nodes)for(let e of this.nodes)e.cleanRaws(t)}each(t){if(!this.proxyOf.nodes)return;let e,r,n=this.getIterator();for(;this.indexes[n]<this.proxyOf.nodes.length&&(e=this.indexes[n],r=t(this.proxyOf.nodes[e],e),!1!==r);)this.indexes[n]+=1;return delete this.indexes[n],r}every(t){return this.nodes.every(t)}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let t=this.lastEach;return this.indexes[t]=0,t}getProxyProcessor(){return{get:(t,e)=>"proxyOf"===e?t:t[e]?"each"===e||"string"==typeof e&&e.startsWith("walk")?(...r)=>t[e](...r.map(t=>"function"==typeof t?(e,r)=>t(e.toProxy(),r):t)):"every"===e||"some"===e?r=>t[e]((t,...e)=>r(t.toProxy(),...e)):"root"===e?()=>t.root().toProxy():"nodes"===e?t.nodes.map(t=>t.toProxy()):"first"===e||"last"===e?t[e].toProxy():t[e]:t[e],set:(t,e,r)=>(t[e]===r||(t[e]=r,"name"!==e&&"params"!==e&&"selector"!==e||t.markDirty()),!0)}}index(t){return"number"==typeof t?t:(t.proxyOf&&(t=t.proxyOf),this.proxyOf.nodes.indexOf(t))}insertAfter(t,e){let r,n=this.index(t),s=this.normalize(e,this.proxyOf.nodes[n]).reverse();n=this.index(t);for(let t of s)this.proxyOf.nodes.splice(n+1,0,t);for(let t in this.indexes)r=this.indexes[t],n<r&&(this.indexes[t]=r+s.length);return this.markDirty(),this}insertBefore(t,e){let r,n=this.index(t),s=0===n&&"prepend",o=this.normalize(e,this.proxyOf.nodes[n],s).reverse();n=this.index(t);for(let t of o)this.proxyOf.nodes.splice(n,0,t);for(let t in this.indexes)r=this.indexes[t],n<=r&&(this.indexes[t]=r+o.length);return this.markDirty(),this}normalize(e,r){if("string"==typeof e)e=Pa(xa(e).nodes);else if(void 0===e)e=[];else if(Array.isArray(e)){e=e.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if("root"===e.type&&"document"!==this.type){e=e.nodes.slice(0);for(let t of e)t.parent&&t.parent.removeChild(t,"ignore")}else if(e.type)e=[e];else if(e.prop){if(void 0===e.value)throw new Error("Value field is missed in node creation");"string"!=typeof e.value&&(e.value=String(e.value)),e=[new Aa(e)]}else if(e.selector)e=[new _a(e)];else if(e.name)e=[new Ea(e)];else{if(!e.text)throw new Error("Unknown node type in node creation");e=[new Ta(e)]}return e.map(e=>(e[Ma]||t.rebuild(e),(e=e.proxyOf).parent&&e.parent.removeChild(e),e[Oa]&&Na(e),void 0===e.raws.before&&r&&void 0!==r.raws.before&&(e.raws.before=r.raws.before.replace(/\S/g,"")),e.parent=this.proxyOf,e))}prepend(...t){t=t.reverse();for(let e of t){let t=this.normalize(e,this.first,"prepend").reverse();for(let e of t)this.proxyOf.nodes.unshift(e);for(let e in this.indexes)this.indexes[e]=this.indexes[e]+t.length}return this.markDirty(),this}push(t){return t.parent=this,this.proxyOf.nodes.push(t),this}removeAll(){for(let t of this.proxyOf.nodes)t.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(t){let e;t=this.index(t),this.proxyOf.nodes[t].parent=void 0,this.proxyOf.nodes.splice(t,1);for(let r in this.indexes)e=this.indexes[r],e>=t&&(this.indexes[r]=e-1);return this.markDirty(),this}replaceValues(t,e,r){return r||(r=e,e={}),this.walkDecls(n=>{e.props&&!e.props.includes(n.prop)||e.fast&&!n.value.includes(e.fast)||(n.value=n.value.replace(t,r))}),this.markDirty(),this}some(t){return this.nodes.some(t)}walk(t){return this.each((e,r)=>{let n;try{n=t(e,r)}catch(t){throw e.addToError(t)}return!1!==n&&e.walk&&(n=e.walk(t)),n})}walkAtRules(t,e){return e?t instanceof RegExp?this.walk((r,n)=>{if("atrule"===r.type&&t.test(r.name))return e(r,n)}):this.walk((r,n)=>{if("atrule"===r.type&&r.name===t)return e(r,n)}):(e=t,this.walk((t,r)=>{if("atrule"===t.type)return e(t,r)}))}walkComments(t){return this.walk((e,r)=>{if("comment"===e.type)return t(e,r)})}walkDecls(t,e){return e?t instanceof RegExp?this.walk((r,n)=>{if("decl"===r.type&&t.test(r.prop))return e(r,n)}):this.walk((r,n)=>{if("decl"===r.type&&r.prop===t)return e(r,n)}):(e=t,this.walk((t,r)=>{if("decl"===t.type)return e(t,r)}))}walkRules(t,e){return e?t instanceof RegExp?this.walk((r,n)=>{if("rule"===r.type&&t.test(r.selector))return e(r,n)}):this.walk((r,n)=>{if("rule"===r.type&&r.selector===t)return e(r,n)}):(e=t,this.walk((t,r)=>{if("rule"===t.type)return e(t,r)}))}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}};Da.registerParse=t=>{xa=t},Da.registerRule=t=>{_a=t},Da.registerAtRule=t=>{Ea=t},Da.registerRoot=t=>{Ra=t};var Fa=Da;Da.default=Da,Da.rebuild=t=>{"atrule"===t.type?Object.setPrototypeOf(t,Ea.prototype):"rule"===t.type?Object.setPrototypeOf(t,_a.prototype):"decl"===t.type?Object.setPrototypeOf(t,Aa.prototype):"comment"===t.type?Object.setPrototypeOf(t,Ta.prototype):"root"===t.type&&Object.setPrototypeOf(t,Ra.prototype),t[Ma]=!0,t.nodes&&t.nodes.forEach(t=>{Da.rebuild(t)})};let Ua,ja,Ba=Fa,za=class extends Ba{constructor(t){super({type:"document",...t}),this.nodes||(this.nodes=[])}toResult(t={}){return new Ua(new ja,this,t).stringify()}};za.registerLazyResult=t=>{Ua=t},za.registerProcessor=t=>{ja=t};var Wa=za;za.default=za;let Va=class{constructor(t,e={}){if(this.type="warning",this.text=t,e.node&&e.node.source){let t=e.node.rangeBy(e);this.line=t.start.line,this.column=t.start.column,this.endLine=t.end.line,this.endColumn=t.end.column}for(let t in e)this[t]=e[t]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};var Ha=Va;Va.default=Va;let Ga=Ha,Ja=class{constructor(t,e,r){this.processor=t,this.messages=[],this.root=e,this.opts=r,this.css=void 0,this.map=void 0}toString(){return this.css}warn(t,e={}){e.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(e.plugin=this.lastPlugin.postcssPlugin);let r=new Ga(t,e);return this.messages.push(r),r}warnings(){return this.messages.filter(t=>"warning"===t.type)}get content(){return this.css}};var qa=Ja;Ja.default=Ja;const Za="'".charCodeAt(0),Ya='"'.charCodeAt(0),Xa="\\".charCodeAt(0),$a="/".charCodeAt(0),Ka="\n".charCodeAt(0),Qa=" ".charCodeAt(0),tl="\f".charCodeAt(0),el="\t".charCodeAt(0),rl="\r".charCodeAt(0),nl="[".charCodeAt(0),sl="]".charCodeAt(0),ol="(".charCodeAt(0),il=")".charCodeAt(0),al="{".charCodeAt(0),ll="}".charCodeAt(0),cl=";".charCodeAt(0),ul="*".charCodeAt(0),hl=":".charCodeAt(0),pl="@".charCodeAt(0),dl=/[\t\n\f\r "#'()/;[\\\]{}]/g,fl=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,ml=/.[\r\n"'(/\\]/,gl=/[\da-f]/i;let yl=Fa,bl=class extends yl{constructor(t){super(t),this.type="atrule"}append(...t){return this.proxyOf.nodes||(this.nodes=[]),super.append(...t)}prepend(...t){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...t)}};var wl=bl;bl.default=bl,yl.registerAtRule(bl);let vl,Sl,Cl=Fa,Il=class extends Cl{constructor(t){super(t),this.type="root",this.nodes||(this.nodes=[])}normalize(t,e,r){let n=super.normalize(t);if(e)if("prepend"===r)this.nodes.length>1?e.raws.before=this.nodes[1].raws.before:delete e.raws.before;else if(this.first!==e)for(let t of n)t.raws.before=e.raws.before;return n}removeChild(t,e){let r=this.index(t);return!e&&0===r&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[r].raws.before),super.removeChild(t)}toResult(t={}){return new vl(new Sl,this,t).stringify()}};Il.registerLazyResult=t=>{vl=t},Il.registerProcessor=t=>{Sl=t};var kl=Il;Il.default=Il,Cl.registerRoot(Il);let xl={comma:t=>xl.split(t,[","],!0),space:t=>xl.split(t,[" ","\n","\t"]),split(t,e,r){let n=[],s="",o=!1,i=0,a=!1,l="",c=!1;for(let r of t)c?c=!1:"\\"===r?c=!0:a?r===l&&(a=!1):'"'===r||"'"===r?(a=!0,l=r):"("===r?i+=1:")"===r?i>0&&(i-=1):0===i&&e.includes(r)&&(o=!0),o?(""!==s&&n.push(s.trim()),s="",o=!1):s+=r;return(r||""!==s)&&n.push(s.trim()),n}};var _l=xl;xl.default=xl;let El=Fa,Rl=_l,Ol=class extends El{constructor(t){super(t),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return Rl.comma(this.selector)}set selectors(t){let e=this.selector?this.selector.match(/,\s*/):null,r=e?e[0]:","+this.raw("between","beforeOpen");this.selector=t.join(r)}};var Ml=Ol;Ol.default=Ol,El.registerRule(Ol);let Al=Bi,Tl=ka,Ll=wl,Pl=kl,Nl=Ml;const Dl={empty:!0,space:!0};let Fl=Fa,Ul=class{constructor(t){this.input=t,this.root=new Pl,this.current=this.root,this.spaces="",this.semicolon=!1,this.createTokenizer(),this.root.source={input:t,start:{column:1,line:1,offset:0}}}atrule(t){let e,r,n,s=new Ll;s.name=t[1].slice(1),""===s.name&&this.unnamedAtrule(s,t),this.init(s,t[2]);let o=!1,i=!1,a=[],l=[];for(;!this.tokenizer.endOfFile();){if(e=(t=this.tokenizer.nextToken())[0],"("===e||"["===e?l.push("("===e?")":"]"):"{"===e&&l.length>0?l.push("}"):e===l[l.length-1]&&l.pop(),0===l.length){if(";"===e){s.source.end=this.getPosition(t[2]),s.source.end.offset++,this.semicolon=!0;break}if("{"===e){i=!0;break}if("}"===e){if(a.length>0){for(n=a.length-1,r=a[n];r&&"space"===r[0];)r=a[--n];r&&(s.source.end=this.getPosition(r[3]||r[2]),s.source.end.offset++)}this.end(t);break}a.push(t)}else a.push(t);if(this.tokenizer.endOfFile()){o=!0;break}}s.raws.between=this.spacesAndCommentsFromEnd(a),a.length?(s.raws.afterName=this.spacesAndCommentsFromStart(a),this.raw(s,"params",a),o&&(t=a[a.length-1],s.source.end=this.getPosition(t[3]||t[2]),s.source.end.offset++,this.spaces=s.raws.between,s.raws.between="")):(s.raws.afterName="",s.params=""),i&&(s.nodes=[],this.current=s)}checkMissedSemicolon(t){let e=this.colon(t);if(!1===e)return;let r,n=0;for(let s=e-1;s>=0&&(r=t[s],"space"===r[0]||(n+=1,2!==n));s--);throw this.input.error("Missed semicolon","word"===r[0]?r[3]+1:r[2])}colon(t){let e,r,n,s=0;for(let[o,i]of t.entries()){if(e=i,r=e[0],"("===r&&(s+=1),")"===r&&(s-=1),0===s&&":"===r){if(n){if("word"===n[0]&&"progid"===n[1])continue;return o}this.doubleColon(e)}n=e}return!1}comment(t){let e=new Tl;this.init(e,t[2]),e.source.end=this.getPosition(t[3]||t[2]),e.source.end.offset++;let r=t[1].slice(2,-2);if(/^\s*$/.test(r))e.text="",e.raws.left=r,e.raws.right="";else{let t=r.match(/^(\s*)([^]*\S)(\s*)$/);e.text=t[2],e.raws.left=t[1],e.raws.right=t[3]}}createTokenizer(){this.tokenizer=function(t,e={}){let r,n,s,o,i,a,l,c,u,h,p=t.css.valueOf(),d=e.ignoreErrors,f=p.length,m=0,g=[],y=[];function b(e){throw t.error("Unclosed "+e,m)}return{back:function(t){y.push(t)},endOfFile:function(){return 0===y.length&&m>=f},nextToken:function(t){if(y.length)return y.pop();if(m>=f)return;let e=!!t&&t.ignoreUnclosed;switch(r=p.charCodeAt(m),r){case Ka:case Qa:case el:case rl:case tl:n=m;do{n+=1,r=p.charCodeAt(n)}while(r===Qa||r===Ka||r===el||r===rl||r===tl);h=["space",p.slice(m,n)],m=n-1;break;case nl:case sl:case al:case ll:case hl:case cl:case il:{let t=String.fromCharCode(r);h=[t,t,m];break}case ol:if(c=g.length?g.pop()[1]:"",u=p.charCodeAt(m+1),"url"===c&&u!==Za&&u!==Ya&&u!==Qa&&u!==Ka&&u!==el&&u!==tl&&u!==rl){n=m;do{if(a=!1,n=p.indexOf(")",n+1),-1===n){if(d||e){n=m;break}b("bracket")}for(l=n;p.charCodeAt(l-1)===Xa;)l-=1,a=!a}while(a);h=["brackets",p.slice(m,n+1),m,n],m=n}else n=p.indexOf(")",m+1),o=p.slice(m,n+1),-1===n||ml.test(o)?h=["(","(",m]:(h=["brackets",o,m,n],m=n);break;case Za:case Ya:s=r===Za?"'":'"',n=m;do{if(a=!1,n=p.indexOf(s,n+1),-1===n){if(d||e){n=m+1;break}b("string")}for(l=n;p.charCodeAt(l-1)===Xa;)l-=1,a=!a}while(a);h=["string",p.slice(m,n+1),m,n],m=n;break;case pl:dl.lastIndex=m+1,dl.test(p),n=0===dl.lastIndex?p.length-1:dl.lastIndex-2,h=["at-word",p.slice(m,n+1),m,n],m=n;break;case Xa:for(n=m,i=!0;p.charCodeAt(n+1)===Xa;)n+=1,i=!i;if(r=p.charCodeAt(n+1),i&&r!==$a&&r!==Qa&&r!==Ka&&r!==el&&r!==rl&&r!==tl&&(n+=1,gl.test(p.charAt(n)))){for(;gl.test(p.charAt(n+1));)n+=1;p.charCodeAt(n+1)===Qa&&(n+=1)}h=["word",p.slice(m,n+1),m,n],m=n;break;default:r===$a&&p.charCodeAt(m+1)===ul?(n=p.indexOf("*/",m+2)+1,0===n&&(d||e?n=p.length:b("comment")),h=["comment",p.slice(m,n+1),m,n],m=n):(fl.lastIndex=m+1,fl.test(p),n=0===fl.lastIndex?p.length-1:fl.lastIndex-2,h=["word",p.slice(m,n+1),m,n],g.push(h),m=n)}return m++,h},position:function(){return m}}}(this.input)}decl(t,e){let r=new Al;this.init(r,t[0][2]);let n,s=t[t.length-1];for(";"===s[0]&&(this.semicolon=!0,t.pop()),r.source.end=this.getPosition(s[3]||s[2]||function(t){for(let e=t.length-1;e>=0;e--){let r=t[e],n=r[3]||r[2];if(n)return n}}(t)),r.source.end.offset++;"word"!==t[0][0];)1===t.length&&this.unknownWord(t),r.raws.before+=t.shift()[1];for(r.source.start=this.getPosition(t[0][2]),r.prop="";t.length;){let e=t[0][0];if(":"===e||"space"===e||"comment"===e)break;r.prop+=t.shift()[1]}for(r.raws.between="";t.length;){if(n=t.shift(),":"===n[0]){r.raws.between+=n[1];break}"word"===n[0]&&/\w/.test(n[1])&&this.unknownWord([n]),r.raws.between+=n[1]}"_"!==r.prop[0]&&"*"!==r.prop[0]||(r.raws.before+=r.prop[0],r.prop=r.prop.slice(1));let o,i=[];for(;t.length&&(o=t[0][0],"space"===o||"comment"===o);)i.push(t.shift());this.precheckMissedSemicolon(t);for(let e=t.length-1;e>=0;e--){if(n=t[e],"!important"===n[1].toLowerCase()){r.important=!0;let n=this.stringFrom(t,e);n=this.spacesFromEnd(t)+n," !important"!==n&&(r.raws.important=n);break}if("important"===n[1].toLowerCase()){let n=t.slice(0),s="";for(let t=e;t>0;t--){let e=n[t][0];if(0===s.trim().indexOf("!")&&"space"!==e)break;s=n.pop()[1]+s}0===s.trim().indexOf("!")&&(r.important=!0,r.raws.important=s,t=n)}if("space"!==n[0]&&"comment"!==n[0])break}t.some(t=>"space"!==t[0]&&"comment"!==t[0])&&(r.raws.between+=i.map(t=>t[1]).join(""),i=[]),this.raw(r,"value",i.concat(t),e),r.value.includes(":")&&!e&&this.checkMissedSemicolon(t)}doubleColon(t){throw this.input.error("Double colon",{offset:t[2]},{offset:t[2]+t[1].length})}emptyRule(t){let e=new Nl;this.init(e,t[2]),e.selector="",e.raws.between="",this.current=e}end(t){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(t[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(t)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(t){if(this.spaces+=t[1],this.current.nodes){let t=this.current.nodes[this.current.nodes.length-1];t&&"rule"===t.type&&!t.raws.ownSemicolon&&(t.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(t){let e=this.input.fromOffset(t);return{column:e.col,line:e.line,offset:t}}init(t,e){this.current.push(t),t.source={input:this.input,start:this.getPosition(e)},t.raws.before=this.spaces,this.spaces="","comment"!==t.type&&(this.semicolon=!1)}other(t){let e=!1,r=null,n=!1,s=null,o=[],i=t[1].startsWith("--"),a=[],l=t;for(;l;){if(r=l[0],a.push(l),"("===r||"["===r)s||(s=l),o.push("("===r?")":"]");else if(i&&n&&"{"===r)s||(s=l),o.push("}");else if(0===o.length){if(";"===r){if(n)return void this.decl(a,i);break}if("{"===r)return void this.rule(a);if("}"===r){this.tokenizer.back(a.pop()),e=!0;break}":"===r&&(n=!0)}else r===o[o.length-1]&&(o.pop(),0===o.length&&(s=null));l=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(e=!0),o.length>0&&this.unclosedBracket(s),e&&n){if(!i)for(;a.length&&(l=a[a.length-1][0],"space"===l||"comment"===l);)this.tokenizer.back(a.pop());this.decl(a,i)}else this.unknownWord(a)}parse(){let t;for(;!this.tokenizer.endOfFile();)switch(t=this.tokenizer.nextToken(),t[0]){case"space":this.spaces+=t[1];break;case";":this.freeSemicolon(t);break;case"}":this.end(t);break;case"comment":this.comment(t);break;case"at-word":this.atrule(t);break;case"{":this.emptyRule(t);break;default:this.other(t)}this.endFile()}precheckMissedSemicolon(){}raw(t,e,r,n){let s,o,i,a,l=r.length,c="",u=!0;for(let t=0;t<l;t+=1)s=r[t],o=s[0],"space"!==o||t!==l-1||n?"comment"===o?(a=r[t-1]?r[t-1][0]:"empty",i=r[t+1]?r[t+1][0]:"empty",Dl[a]||Dl[i]||","===c.slice(-1)?u=!1:c+=s[1]):c+=s[1]:u=!1;if(!u){let n=r.reduce((t,e)=>t+e[1],"");t.raws[e]={raw:n,value:c}}t[e]=c}rule(t){t.pop();let e=new Nl;this.init(e,t[0][2]),e.raws.between=this.spacesAndCommentsFromEnd(t),this.raw(e,"selector",t),this.current=e}spacesAndCommentsFromEnd(t){let e,r="";for(;t.length&&(e=t[t.length-1][0],"space"===e||"comment"===e);)r=t.pop()[1]+r;return r}spacesAndCommentsFromStart(t){let e,r="";for(;t.length&&(e=t[0][0],"space"===e||"comment"===e);)r+=t.shift()[1];return r}spacesFromEnd(t){let e,r="";for(;t.length&&(e=t[t.length-1][0],"space"===e);)r=t.pop()[1]+r;return r}stringFrom(t,e){let r="";for(let n=e;n<t.length;n++)r+=t[n][1];return t.splice(e,t.length-e),r}unclosedBlock(){let t=this.current.source.start;throw this.input.error("Unclosed block",t.line,t.column)}unclosedBracket(t){throw this.input.error("Unclosed bracket",{offset:t[2]},{offset:t[2]+1})}unexpectedClose(t){throw this.input.error("Unexpected }",{offset:t[2]},{offset:t[2]+1})}unknownWord(t){throw this.input.error("Unknown word",{offset:t[0][2]},{offset:t[0][2]+t[0][1].length})}unnamedAtrule(t,e){throw this.input.error("At-rule without name",{offset:e[2]},{offset:e[2]+e[1].length})}},jl=ua;function Bl(t,e){let r=new jl(t,e),n=new Ul(r);try{n.parse()}catch(t){throw t}return n.root}var zl=Bl;Bl.default=Bl,Fl.registerParse(Bl);let{isClean:Wl,my:Vl}=Ii,Hl=Sa,Gl=Oi,Jl=Fa,ql=Wa,Zl=qa,Yl=zl,Xl=kl;const $l={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},Kl={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},Ql={Once:!0,postcssPlugin:!0,prepare:!0};function tc(t){return"object"==typeof t&&"function"==typeof t.then}function ec(t){let e=!1,r=$l[t.type];return"decl"===t.type?e=t.prop.toLowerCase():"atrule"===t.type&&(e=t.name.toLowerCase()),e&&t.append?[r,r+"-"+e,0,r+"Exit",r+"Exit-"+e]:e?[r,r+"-"+e,r+"Exit",r+"Exit-"+e]:t.append?[r,0,r+"Exit"]:[r,r+"Exit"]}function rc(t){let e;return e="document"===t.type?["Document",0,"DocumentExit"]:"root"===t.type?["Root",0,"RootExit"]:ec(t),{eventIndex:0,events:e,iterator:0,node:t,visitorIndex:0,visitors:[]}}function nc(t){return t[Wl]=!1,t.nodes&&t.nodes.forEach(t=>nc(t)),t}let sc={},oc=class t{constructor(e,r,n){let s;if(this.stringified=!1,this.processed=!1,"object"!=typeof r||null===r||"root"!==r.type&&"document"!==r.type)if(r instanceof t||r instanceof Zl)s=nc(r.root),r.map&&(void 0===n.map&&(n.map={}),n.map.inline||(n.map.inline=!1),n.map.prev=r.map);else{let t=Yl;n.syntax&&(t=n.syntax.parse),n.parser&&(t=n.parser),t.parse&&(t=t.parse);try{s=t(r,n)}catch(t){this.processed=!0,this.error=t}s&&!s[Vl]&&Jl.rebuild(s)}else s=nc(r);this.result=new Zl(e,s,n),this.helpers={...sc,postcss:sc,result:this.result},this.plugins=this.processor.plugins.map(t=>"object"==typeof t&&t.prepare?{...t,...t.prepare(this.result)}:t)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(t){return this.async().catch(t)}finally(t){return this.async().then(t,t)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(t,e){let r=this.result.lastPlugin;try{e&&e.addToError(t),this.error=t,"CssSyntaxError"!==t.name||t.plugin?r.postcssVersion:(t.plugin=r.postcssPlugin,t.setMessage())}catch(t){console&&console.error&&console.error(t)}return t}prepareVisitors(){this.listeners={};let t=(t,e,r)=>{this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push([t,r])};for(let e of this.plugins)if("object"==typeof e)for(let r in e){if(!Kl[r]&&/^[A-Z]/.test(r))throw new Error(`Unknown event ${r} in ${e.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!Ql[r])if("object"==typeof e[r])for(let n in e[r])t(e,"*"===n?r:r+"-"+n.toLowerCase(),e[r][n]);else"function"==typeof e[r]&&t(e,r,e[r])}this.hasListener=Object.keys(this.listeners).length>0}async runAsync(){this.plugin=0;for(let t=0;t<this.plugins.length;t++){let e=this.plugins[t],r=this.runOnRoot(e);if(tc(r))try{await r}catch(t){throw this.handleError(t)}}if(this.prepareVisitors(),this.hasListener){let t=this.result.root;for(;!t[Wl];){t[Wl]=!0;let e=[rc(t)];for(;e.length>0;){let t=this.visitTick(e);if(tc(t))try{await t}catch(t){let r=e[e.length-1].node;throw this.handleError(t,r)}}}if(this.listeners.OnceExit)for(let[e,r]of this.listeners.OnceExit){this.result.lastPlugin=e;try{if("document"===t.type){let e=t.nodes.map(t=>r(t,this.helpers));await Promise.all(e)}else await r(t,this.helpers)}catch(t){throw this.handleError(t)}}}return this.processed=!0,this.stringify()}runOnRoot(t){this.result.lastPlugin=t;try{if("object"==typeof t&&t.Once){if("document"===this.result.root.type){let e=this.result.root.nodes.map(e=>t.Once(e,this.helpers));return tc(e[0])?Promise.all(e):e}return t.Once(this.result.root,this.helpers)}if("function"==typeof t)return t(this.result.root,this.result)}catch(t){throw this.handleError(t)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let t=this.result.opts,e=Gl;t.syntax&&(e=t.syntax.stringify),t.stringifier&&(e=t.stringifier),e.stringify&&(e=e.stringify);let r=new Hl(e,this.result.root,this.result.opts).generate();return this.result.css=r[0],this.result.map=r[1],this.result}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let t of this.plugins)if(tc(this.runOnRoot(t)))throw this.getAsyncError();if(this.prepareVisitors(),this.hasListener){let t=this.result.root;for(;!t[Wl];)t[Wl]=!0,this.walkSync(t);if(this.listeners.OnceExit)if("document"===t.type)for(let e of t.nodes)this.visitSync(this.listeners.OnceExit,e);else this.visitSync(this.listeners.OnceExit,t)}return this.result}then(t,e){return this.async().then(t,e)}toString(){return this.css}visitSync(t,e){for(let[r,n]of t){let t;this.result.lastPlugin=r;try{t=n(e,this.helpers)}catch(t){throw this.handleError(t,e.proxyOf)}if("root"!==e.type&&"document"!==e.type&&!e.parent)return!0;if(tc(t))throw this.getAsyncError()}}visitTick(t){let e=t[t.length-1],{node:r,visitors:n}=e;if("root"!==r.type&&"document"!==r.type&&!r.parent)return void t.pop();if(n.length>0&&e.visitorIndex<n.length){let[t,s]=n[e.visitorIndex];e.visitorIndex+=1,e.visitorIndex===n.length&&(e.visitors=[],e.visitorIndex=0),this.result.lastPlugin=t;try{return s(r.toProxy(),this.helpers)}catch(t){throw this.handleError(t,r)}}if(0!==e.iterator){let n,s=e.iterator;for(;n=r.nodes[r.indexes[s]];)if(r.indexes[s]+=1,!n[Wl])return n[Wl]=!0,void t.push(rc(n));e.iterator=0,delete r.indexes[s]}let s=e.events;for(;e.eventIndex<s.length;){let t=s[e.eventIndex];if(e.eventIndex+=1,0===t)return void(r.nodes&&r.nodes.length&&(r[Wl]=!0,e.iterator=r.getIterator()));if(this.listeners[t])return void(e.visitors=this.listeners[t])}t.pop()}walkSync(t){t[Wl]=!0;let e=ec(t);for(let r of e)if(0===r)t.nodes&&t.each(t=>{t[Wl]||this.walkSync(t)});else{let e=this.listeners[r];if(e&&this.visitSync(e,t.toProxy()))return}}warnings(){return this.sync().warnings()}get content(){return this.stringify().content}get css(){return this.stringify().css}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){return this.sync().root}get[Symbol.toStringTag](){return"LazyResult"}};oc.registerPostcss=t=>{sc=t};var ic=oc;oc.default=oc,Xl.registerLazyResult(oc),ql.registerLazyResult(oc);let ac=Sa,lc=Oi,cc=zl;const uc=qa;let hc=class{constructor(t,e,r){let n;e=e.toString(),this.stringified=!1,this._processor=t,this._css=e,this._opts=r,this._map=void 0;let s=lc;this.result=new uc(this._processor,n,this._opts),this.result.css=e;let o=this;Object.defineProperty(this.result,"root",{get:()=>o.root});let i=new ac(s,n,this._opts,e);if(i.isMap()){let[t,e]=i.generate();t&&(this.result.css=t),e&&(this.result.map=e)}else i.clearAnnotation(),this.result.css=i.css}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(t){return this.async().catch(t)}finally(t){return this.async().then(t,t)}sync(){if(this.error)throw this.error;return this.result}then(t,e){return this.async().then(t,e)}toString(){return this._css}warnings(){return[]}get content(){return this.result.css}get css(){return this.result.css}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let t,e=cc;try{t=e(this._css,this._opts)}catch(t){this.error=t}if(this.error)throw this.error;return this._root=t,t}get[Symbol.toStringTag](){return"NoWorkResult"}};var pc=hc;hc.default=hc;let dc=pc,fc=ic,mc=Wa,gc=kl,yc=class{constructor(t=[]){this.version="8.4.38",this.plugins=this.normalize(t)}normalize(t){let e=[];for(let r of t)if(!0===r.postcss?r=r():r.postcss&&(r=r.postcss),"object"==typeof r&&Array.isArray(r.plugins))e=e.concat(r.plugins);else if("object"==typeof r&&r.postcssPlugin)e.push(r);else if("function"==typeof r)e.push(r);else if("object"!=typeof r||!r.parse&&!r.stringify)throw new Error(r+" is not a PostCSS plugin");return e}process(t,e={}){return this.plugins.length||e.parser||e.stringifier||e.syntax?new fc(this,t,e):new dc(this,t,e)}use(t){return this.plugins=this.plugins.concat(this.normalize([t])),this}};var bc=yc;yc.default=yc,gc.registerProcessor(yc),mc.registerProcessor(yc);let wc=Bi,vc=Yi,Sc=ka,Cc=wl,Ic=ua,kc=kl,xc=Ml;function _c(t,e){if(Array.isArray(t))return t.map(t=>_c(t));let{inputs:r,...n}=t;if(r){e=[];for(let t of r){let r={...t,__proto__:Ic.prototype};r.map&&(r.map={...r.map,__proto__:vc.prototype}),e.push(r)}}if(n.nodes&&(n.nodes=t.nodes.map(t=>_c(t,e))),n.source){let{inputId:t,...r}=n.source;n.source=r,null!=t&&(n.source.input=e[t])}if("root"===n.type)return new kc(n);if("decl"===n.type)return new wc(n);if("rule"===n.type)return new xc(n);if("comment"===n.type)return new Sc(n);if("atrule"===n.type)return new Cc(n);throw new Error("Unknown node type: "+t.type)}var Ec=_c;_c.default=_c;let Rc=Ci,Oc=Bi,Mc=ic,Ac=Fa,Tc=bc,Lc=Oi,Pc=Ec,Nc=Wa,Dc=Ha,Fc=ka,Uc=wl,jc=qa,Bc=ua,zc=zl,Wc=_l,Vc=Ml,Hc=kl,Gc=Fi;function Jc(...t){return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),new Tc(t)}Jc.plugin=function(t,e){let r,n=!1;function s(...r){console&&console.warn&&!n&&(n=!0,console.warn(t+": postcss.plugin was deprecated. Migration guide:\nhttps://evilmartians.com/chronicles/postcss-8-plugin-migration"),process.env.LANG&&process.env.LANG.startsWith("cn")&&console.warn(t+":  postcss.plugin . :\nhttps://www.w3ctech.com/topic/2226"));let s=e(...r);return s.postcssPlugin=t,s.postcssVersion=(new Tc).version,s}return Object.defineProperty(s,"postcss",{get:()=>(r||(r=s()),r)}),s.process=function(t,e,r){return Jc([s(r)]).process(t,e)},s},Jc.stringify=Lc,Jc.parse=zc,Jc.fromJSON=Pc,Jc.list=Wc,Jc.comment=t=>new Fc(t),Jc.atRule=t=>new Uc(t),Jc.decl=t=>new Oc(t),Jc.rule=t=>new Vc(t),Jc.root=t=>new Hc(t),Jc.document=t=>new Nc(t),Jc.CssSyntaxError=Rc,Jc.Declaration=Oc,Jc.Container=Ac,Jc.Processor=Tc,Jc.Document=Nc,Jc.Comment=Fc,Jc.Warning=Dc,Jc.AtRule=Uc,Jc.Result=jc,Jc.Input=Bc,Jc.Rule=Vc,Jc.Root=Hc,Jc.Node=Gc,Mc.registerPostcss(Jc);var qc=Jc;Jc.default=Jc;const Zc=pi(qc);Zc.stringify,Zc.fromJSON,Zc.plugin,Zc.parse,Zc.list,Zc.document,Zc.comment,Zc.atRule,Zc.rule,Zc.decl,Zc.root,Zc.CssSyntaxError,Zc.Declaration,Zc.Container,Zc.Processor,Zc.Document,Zc.Comment,Zc.Warning,Zc.AtRule,Zc.Result,Zc.Input,Zc.Rule,Zc.Root,Zc.Node;class Yc{constructor(...t){hi(this,"parentElement",null),hi(this,"parentNode",null),hi(this,"ownerDocument"),hi(this,"firstChild",null),hi(this,"lastChild",null),hi(this,"previousSibling",null),hi(this,"nextSibling",null),hi(this,"ELEMENT_NODE",1),hi(this,"TEXT_NODE",3),hi(this,"nodeType"),hi(this,"nodeName"),hi(this,"RRNodeType")}get childNodes(){const t=[];let e=this.firstChild;for(;e;)t.push(e),e=e.nextSibling;return t}contains(t){if(!(t instanceof Yc))return!1;if(t.ownerDocument!==this.ownerDocument)return!1;if(t===this)return!0;for(;t.parentNode;){if(t.parentNode===this)return!0;t=t.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,e){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}const Xc={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},$c={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},Kc={};function Qc(t){if(Kc[t])return Kc[t];const e=globalThis[t],r=e.prototype,n=t in Xc?Xc[t]:void 0,s=Boolean(n&&n.every(t=>{var e,n;return Boolean(null==(n=null==(e=Object.getOwnPropertyDescriptor(r,t))?void 0:e.get)?void 0:n.toString().includes("[native code]"))})),o=t in $c?$c[t]:void 0,i=Boolean(o&&o.every(t=>{var e;return"function"==typeof r[t]&&(null==(e=r[t])?void 0:e.toString().includes("[native code]"))}));if(s&&i&&!globalThis.Zone)return Kc[t]=e.prototype,e.prototype;try{const n=document.createElement("iframe");document.body.appendChild(n);const s=n.contentWindow;if(!s)return e.prototype;const o=s[t].prototype;return document.body.removeChild(n),o?Kc[t]=o:r}catch{return r}}const tu={};function eu(t,e,r){var n;const s=`${t}.${String(r)}`;if(tu[s])return tu[s].call(e);const o=Qc(t),i=null==(n=Object.getOwnPropertyDescriptor(o,r))?void 0:n.get;return i?(tu[s]=i,i.call(e)):e[r]}const ru={};function nu(t,e,r){const n=`${t}.${String(r)}`;if(ru[n])return ru[n].bind(e);const s=Qc(t)[r];return"function"!=typeof s?e[r]:(ru[n]=s,s.bind(e))}function su(){return Qc("MutationObserver").constructor}const ou=function(t){return eu("Node",t,"childNodes")},iu=function(t){return eu("Node",t,"parentNode")},au=function(t){return eu("Node",t,"parentElement")},lu=function(t){return eu("Node",t,"textContent")},cu=function(t,e){return nu("Node",t,"contains")(e)},uu=function(t){return nu("Node",t,"getRootNode")()},hu=function(t){return t&&"host"in t?eu("ShadowRoot",t,"host"):null},pu=function(t){return t&&"shadowRoot"in t?eu("Element",t,"shadowRoot"):null};function du(t,e,r=document){const n={capture:!0,passive:!0};return r.addEventListener(t,e,n),()=>r.removeEventListener(t,e,n)}const fu="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let mu={map:{},getId:()=>(console.error(fu),-1),getNode:()=>(console.error(fu),null),removeNodeFromMap(){console.error(fu)},has:()=>(console.error(fu),!1),reset(){console.error(fu)}};function gu(t,e,r={}){let n=null,s=0;return function(...o){const i=Date.now();s||!1!==r.leading||(s=i);const a=e-(i-s),l=this;a<=0||a>e?(n&&(clearTimeout(n),n=null),s=i,t.apply(l,o)):n||!1===r.trailing||(n=setTimeout(()=>{s=!1===r.leading?0:Date.now(),n=null,t.apply(l,o)},a))}}function yu(t,e,r,n,s=window){const o=s.Object.getOwnPropertyDescriptor(t,e);return s.Object.defineProperty(t,e,n?r:{set(t){setTimeout(()=>{r.set.call(this,t)},0),o&&o.set&&o.set.call(this,t)}}),()=>yu(t,e,o||{},!0)}function bu(t,e,r){try{if(!(e in t))return()=>{};const n=t[e],s=r(n);return"function"==typeof s&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:n}})),t[e]=s,()=>{t[e]=n}}catch{return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(mu=new Proxy(mu,{get:(t,e,r)=>("map"===e&&console.error(fu),Reflect.get(t,e,r))}));let wu=Date.now;function vu(t){var e,r,n,s;const o=t.document;return{left:o.scrollingElement?o.scrollingElement.scrollLeft:void 0!==t.pageXOffset?t.pageXOffset:o.documentElement.scrollLeft||(null==o?void 0:o.body)&&(null==(e=au(o.body))?void 0:e.scrollLeft)||(null==(r=null==o?void 0:o.body)?void 0:r.scrollLeft)||0,top:o.scrollingElement?o.scrollingElement.scrollTop:void 0!==t.pageYOffset?t.pageYOffset:(null==o?void 0:o.documentElement.scrollTop)||(null==o?void 0:o.body)&&(null==(n=au(o.body))?void 0:n.scrollTop)||(null==(s=null==o?void 0:o.body)?void 0:s.scrollTop)||0}}function Su(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Cu(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Iu(t){return t?t.nodeType===t.ELEMENT_NODE?t:au(t):null}function ku(t,e,r,n){if(!t)return!1;const s=Iu(t);if(!s)return!1;try{if("string"==typeof e){if(s.classList.contains(e))return!0;if(n&&null!==s.closest("."+e))return!0}else if(vr(s,e,n))return!0}catch(t){}if(r){if(s.matches(r))return!0;if(n&&null!==s.closest(r))return!0}return!1}function xu(t,e,r){return!("TITLE"!==t.tagName||!r.headTitleMutations)||-2===e.getId(t)}function _u(t,e){if(Je(t))return!1;const r=e.getId(t);if(!e.has(r))return!0;const n=iu(t);return(!n||n.nodeType!==t.DOCUMENT_NODE)&&(!n||_u(n,e))}function Eu(t){return Boolean(t.changedTouches)}function Ru(t,e){return Boolean("IFRAME"===t.nodeName&&e.getMeta(t))}function Ou(t,e){return Boolean("LINK"===t.nodeName&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&"stylesheet"===t.getAttribute("rel")&&e.getMeta(t))}function Mu(t){return!!t&&(t instanceof Yc&&"shadowRoot"in t?Boolean(t.shadowRoot):Boolean(pu(t)))}/[1-9][0-9]{12}/.test(Date.now().toString())||(wu=()=>(new Date).getTime());class Au{constructor(){Oe(this,"id",1),Oe(this,"styleIDMap",new WeakMap),Oe(this,"idStyleMap",new Map)}getId(t){return this.styleIDMap.get(t)??-1}has(t){return this.styleIDMap.has(t)}add(t,e){if(this.has(t))return this.getId(t);let r;return r=void 0===e?this.id++:e,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function Tu(t){var e;let r=null;return"getRootNode"in t&&(null==(e=uu(t))?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&hu(uu(t))&&(r=hu(uu(t))),r}function Lu(t){const e=t.ownerDocument;return!!e&&(cu(e,t)||function(t){const e=t.ownerDocument;if(!e)return!1;const r=function(t){let e,r=t;for(;e=Tu(r);)r=e;return r}(t);return cu(e,r)}(t))}var Pu=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(Pu||{}),Nu=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(Nu||{}),Du=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(Du||{}),Fu=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(Fu||{}),Uu=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(Uu||{}),ju=(t=>(t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Seeked=2]="Seeked",t[t.VolumeChange=3]="VolumeChange",t[t.RateChange=4]="RateChange",t))(ju||{}),Bu=(t=>(t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment",t))(Bu||{});function zu(t){return"__ln"in t}class Wu{constructor(){Oe(this,"length",0),Oe(this,"head",null),Oe(this,"tail",null)}get(t){if(t>=this.length)throw new Error("Position outside of list range");let e=this.head;for(let r=0;r<t;r++)e=(null==e?void 0:e.next)||null;return e}addNode(t){const e={value:t,previous:null,next:null};if(t.__ln=e,t.previousSibling&&zu(t.previousSibling)){const r=t.previousSibling.__ln.next;e.next=r,e.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=e,r&&(r.previous=e)}else if(t.nextSibling&&zu(t.nextSibling)&&t.nextSibling.__ln.previous){const r=t.nextSibling.__ln.previous;e.previous=r,e.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=e,r&&(r.next=e)}else this.head&&(this.head.previous=e),e.next=this.head,this.head=e;null===e.next&&(this.tail=e),this.length++}removeNode(t){const e=t.__ln;this.head&&(e.previous?(e.previous.next=e.next,e.next?e.next.previous=e.previous:this.tail=e.previous):(this.head=e.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const Vu=(t,e)=>`${t}@${e}`;class Hu{constructor(){Oe(this,"frozen",!1),Oe(this,"locked",!1),Oe(this,"texts",[]),Oe(this,"attributes",[]),Oe(this,"attributeMap",new WeakMap),Oe(this,"removes",[]),Oe(this,"mapRemoves",[]),Oe(this,"movedMap",{}),Oe(this,"addedSet",new Set),Oe(this,"movedSet",new Set),Oe(this,"droppedSet",new Set),Oe(this,"removesSubTreeCache",new Set),Oe(this,"mutationCb"),Oe(this,"blockClass"),Oe(this,"blockSelector"),Oe(this,"maskTextClass"),Oe(this,"maskTextSelector"),Oe(this,"inlineStylesheet"),Oe(this,"maskInputOptions"),Oe(this,"maskTextFn"),Oe(this,"maskInputFn"),Oe(this,"keepIframeSrcFn"),Oe(this,"recordCanvas"),Oe(this,"inlineImages"),Oe(this,"slimDOMOptions"),Oe(this,"dataURLOptions"),Oe(this,"doc"),Oe(this,"mirror"),Oe(this,"iframeManager"),Oe(this,"stylesheetManager"),Oe(this,"shadowDomManager"),Oe(this,"canvasManager"),Oe(this,"processedNodeManager"),Oe(this,"unattachedDoc"),Oe(this,"processMutations",t=>{t.forEach(this.processMutation),this.emit()}),Oe(this,"emit",()=>{if(this.frozen||this.locked)return;const t=[],e=new Set,r=new Wu,n=t=>{let e=t,r=-2;for(;-2===r;)e=e&&e.nextSibling,r=e&&this.mirror.getId(e);return r},s=s=>{const o=iu(s);if(!o||!Lu(s))return;let i=!1;if(s.nodeType===Node.TEXT_NODE){const t=o.tagName;if("TEXTAREA"===t)return;"STYLE"===t&&this.addedSet.has(o)&&(i=!0)}const a=Je(o)?this.mirror.getId(Tu(s)):this.mirror.getId(o),l=n(s);if(-1===a||-1===l)return r.addNode(s);const c=kr(s,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:t=>{Ru(t,this.mirror)&&this.iframeManager.addIframe(t),Ou(t,this.mirror)&&this.stylesheetManager.trackLinkElement(t),Mu(s)&&this.shadowDomManager.addShadowRoot(pu(s),this.doc)},onIframeLoad:(t,e)=>{this.iframeManager.attachIframe(t,e),this.shadowDomManager.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{this.stylesheetManager.attachLinkElement(t,e)},cssCaptured:i});c&&(t.push({parentId:a,nextId:l,node:c}),e.add(c.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const t of this.movedSet)Ju(this.removesSubTreeCache,t,this.mirror)&&!this.movedSet.has(iu(t))||s(t);for(const t of this.addedSet)qu(this.droppedSet,t)||Ju(this.removesSubTreeCache,t,this.mirror)?qu(this.movedSet,t)?s(t):this.droppedSet.add(t):s(t);let o=null;for(;r.length;){let t=null;if(o){const e=this.mirror.getId(iu(o.value)),r=n(o.value);-1!==e&&-1!==r&&(t=o)}if(!t){let e=r.tail;for(;e;){const r=e;if(e=e.previous,r){const e=this.mirror.getId(iu(r.value));if(-1===n(r.value))continue;if(-1!==e){t=r;break}{const e=r.value,n=iu(e);if(n&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const e=hu(n);if(-1!==this.mirror.getId(e)){t=r;break}}}}}}if(!t){for(;r.head;)r.removeNode(r.head.value);break}o=t.previous,r.removeNode(t.value),s(t.value)}const i={texts:this.texts.map(t=>{const e=t.node,r=iu(e);return r&&"TEXTAREA"===r.tagName&&this.genTextAreaValueMutation(r),{id:this.mirror.getId(e),value:t.value}}).filter(t=>!e.has(t.id)).filter(t=>this.mirror.has(t.id)),attributes:this.attributes.map(t=>{const{attributes:e}=t;if("string"==typeof e.style){const r=JSON.stringify(t.styleDiff),n=JSON.stringify(t._unchangedStyles);r.length<e.style.length&&(r+n).split("var(").length===e.style.split("var(").length&&(e.style=t.styleDiff)}return{id:this.mirror.getId(t.node),attributes:e}}).filter(t=>!e.has(t.id)).filter(t=>this.mirror.has(t.id)),removes:this.removes,adds:t};(i.texts.length||i.attributes.length||i.removes.length||i.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.removesSubTreeCache=new Set,this.movedMap={},this.mutationCb(i))}),Oe(this,"genTextAreaValueMutation",t=>{let e=this.attributeMap.get(t);e||(e={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(e),this.attributeMap.set(t,e)),e.attributes.value=Array.from(ou(t),t=>lu(t)||"").join("")}),Oe(this,"processMutation",t=>{if(!xu(t.target,this.mirror,this.slimDOMOptions))switch(t.type){case"characterData":{const e=lu(t.target);ku(t.target,this.blockClass,this.blockSelector,!1)||e===t.oldValue||this.texts.push({value:Sr(t.target,this.maskTextClass,this.maskTextSelector,!0)&&e?this.maskTextFn?this.maskTextFn(e,Iu(t.target)):e.replace(/[\S]/g,"*"):e,node:t.target});break}case"attributes":{const e=t.target;let r=t.attributeName,n=t.target.getAttribute(r);if("value"===r){const t=tr(e);n=$e({element:e,maskInputOptions:this.maskInputOptions,tagName:e.tagName,type:t,value:n,maskInputFn:this.maskInputFn})}if(ku(t.target,this.blockClass,this.blockSelector,!1)||n===t.oldValue)return;let s=this.attributeMap.get(t.target);if("IFRAME"===e.tagName&&"src"===r&&!this.keepIframeSrcFn(n)){if(e.contentDocument)return;r="rr_src"}if(s||(s={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(s),this.attributeMap.set(t.target,s)),"type"===r&&"INPUT"===e.tagName&&"password"===(t.oldValue||"").toLowerCase()&&e.setAttribute("data-rr-is-password","true"),!wr(e.tagName,r))if(s.attributes[r]=br(this.doc,Ke(e.tagName),Ke(r),n),"style"===r){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(t){this.unattachedDoc=this.doc}const r=this.unattachedDoc.createElement("span");t.oldValue&&r.setAttribute("style",t.oldValue);for(const t of Array.from(e.style)){const n=e.style.getPropertyValue(t),o=e.style.getPropertyPriority(t);n!==r.style.getPropertyValue(t)||o!==r.style.getPropertyPriority(t)?s.styleDiff[t]=""===o?n:[n,o]:s._unchangedStyles[t]=[n,o]}for(const t of Array.from(r.style))""===e.style.getPropertyValue(t)&&(s.styleDiff[t]=!1)}else"open"===r&&"DIALOG"===e.tagName&&(e.matches("dialog:modal")?s.attributes.rr_open_mode="modal":s.attributes.rr_open_mode="non-modal");break}case"childList":if(ku(t.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===t.target.tagName)return void this.genTextAreaValueMutation(t.target);t.addedNodes.forEach(e=>this.genAdds(e,t.target)),t.removedNodes.forEach(e=>{const r=this.mirror.getId(e),n=Je(t.target)?this.mirror.getId(hu(t.target)):this.mirror.getId(t.target);ku(t.target,this.blockClass,this.blockSelector,!1)||xu(e,this.mirror,this.slimDOMOptions)||!function(t,e){return-1!==e.getId(t)}(e,this.mirror)||(this.addedSet.has(e)?(Gu(this.addedSet,e),this.droppedSet.add(e)):this.addedSet.has(t.target)&&-1===r||_u(t.target,this.mirror)||(this.movedSet.has(e)&&this.movedMap[Vu(r,n)]?Gu(this.movedSet,e):(this.removes.push({parentId:n,id:r,isShadow:!(!Je(t.target)||!qe(t.target))||void 0}),function(t,e){const r=[t];for(;r.length;){const t=r.pop();e.has(t)||(e.add(t),ou(t).forEach(t=>r.push(t)))}}(e,this.removesSubTreeCache))),this.mapRemoves.push(e))})}}),Oe(this,"genAdds",(t,e)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!this.addedSet.has(t)&&!this.movedSet.has(t)){if(this.mirror.hasNode(t)){if(xu(t,this.mirror,this.slimDOMOptions))return;this.movedSet.add(t);let r=null;e&&this.mirror.hasNode(e)&&(r=this.mirror.getId(e)),r&&-1!==r&&(this.movedMap[Vu(this.mirror.getId(t),r)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);ku(t,this.blockClass,this.blockSelector,!1)||(ou(t).forEach(t=>this.genAdds(t)),Mu(t)&&ou(pu(t)).forEach(e=>{this.processedNodeManager.add(e,this),this.genAdds(e,t)}))}})}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(e=>{this[e]=t[e]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Gu(t,e){t.delete(e),ou(e).forEach(e=>Gu(t,e))}function Ju(t,e,r){return 0!==t.size&&function(t,e){const r=iu(e);return!!r&&t.has(r)}(t,e)}function qu(t,e){return 0!==t.size&&Zu(t,e)}function Zu(t,e){const r=iu(e);return!!r&&(!!t.has(r)||Zu(t,r))}let Yu;const Xu=t=>Yu?(...e)=>{try{return t(...e)}catch(t){if(Yu&&!0===Yu(t))return;throw t}}:t,$u=[];function Ku(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function Qu(t,e){const r=new Hu;$u.push(r),r.init(t);const n=new(su())(Xu(r.processMutations.bind(r)));return n.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),n}function th({scrollCb:t,doc:e,mirror:r,blockClass:n,blockSelector:s,sampling:o}){const i=Xu(gu(Xu(o=>{const i=Ku(o);if(!i||ku(i,n,s,!0))return;const a=r.getId(i);if(i===e&&e.defaultView){const r=vu(e.defaultView);t({id:a,x:r.left,y:r.top})}else t({id:a,x:i.scrollLeft,y:i.scrollTop})}),o.scroll||100));return du("scroll",i,e)}const eh=["INPUT","TEXTAREA","SELECT"],rh=new WeakMap;function nh(t){return function(t,e){if(ah("CSSGroupingRule")&&t.parentRule instanceof CSSGroupingRule||ah("CSSMediaRule")&&t.parentRule instanceof CSSMediaRule||ah("CSSSupportsRule")&&t.parentRule instanceof CSSSupportsRule||ah("CSSConditionRule")&&t.parentRule instanceof CSSConditionRule){const r=Array.from(t.parentRule.cssRules).indexOf(t);e.unshift(r)}else if(t.parentStyleSheet){const r=Array.from(t.parentStyleSheet.cssRules).indexOf(t);e.unshift(r)}return e}(t,[])}function sh(t,e,r){let n,s;return t?(t.ownerNode?n=e.getId(t.ownerNode):s=r.getId(t),{styleId:s,id:n}):{}}function oh({mirror:t,stylesheetManager:e},r){var n,s,o;let i=null;i="#document"===r.nodeName?t.getId(r):t.getId(hu(r));const a="#document"===r.nodeName?null==(n=r.defaultView)?void 0:n.Document:null==(o=null==(s=r.ownerDocument)?void 0:s.defaultView)?void 0:o.ShadowRoot,l=(null==a?void 0:a.prototype)?Object.getOwnPropertyDescriptor(null==a?void 0:a.prototype,"adoptedStyleSheets"):void 0;return null!==i&&-1!==i&&a&&l?(Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var t;return null==(t=l.get)?void 0:t.call(this)},set(t){var r;const n=null==(r=l.set)?void 0:r.call(this,t);if(null!==i&&-1!==i)try{e.adoptStyleSheets(t,i)}catch(t){}return n}}),Xu(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})})):()=>{}}function ih(t,e={}){const r=t.doc.defaultView;if(!r)return()=>{};let n;!function(t,e){const{mutationCb:r,mousemoveCb:n,mouseInteractionCb:s,scrollCb:o,viewportResizeCb:i,inputCb:a,mediaInteractionCb:l,styleSheetRuleCb:c,styleDeclarationCb:u,canvasMutationCb:h,fontCb:p,selectionCb:d,customElementCb:f}=t;t.mutationCb=(...t)=>{e.mutation&&e.mutation(...t),r(...t)},t.mousemoveCb=(...t)=>{e.mousemove&&e.mousemove(...t),n(...t)},t.mouseInteractionCb=(...t)=>{e.mouseInteraction&&e.mouseInteraction(...t),s(...t)},t.scrollCb=(...t)=>{e.scroll&&e.scroll(...t),o(...t)},t.viewportResizeCb=(...t)=>{e.viewportResize&&e.viewportResize(...t),i(...t)},t.inputCb=(...t)=>{e.input&&e.input(...t),a(...t)},t.mediaInteractionCb=(...t)=>{e.mediaInteaction&&e.mediaInteaction(...t),l(...t)},t.styleSheetRuleCb=(...t)=>{e.styleSheetRule&&e.styleSheetRule(...t),c(...t)},t.styleDeclarationCb=(...t)=>{e.styleDeclaration&&e.styleDeclaration(...t),u(...t)},t.canvasMutationCb=(...t)=>{e.canvasMutation&&e.canvasMutation(...t),h(...t)},t.fontCb=(...t)=>{e.font&&e.font(...t),p(...t)},t.selectionCb=(...t)=>{e.selection&&e.selection(...t),d(...t)},t.customElementCb=(...t)=>{e.customElement&&e.customElement(...t),f(...t)}}(t,e),t.recordDOM&&(n=Qu(t,t.doc));const s=function({mousemoveCb:t,sampling:e,doc:r,mirror:n}){if(!1===e.mousemove)return()=>{};const s="number"==typeof e.mousemove?e.mousemove:50,o="number"==typeof e.mousemoveCallback?e.mousemoveCallback:500;let i,a=[];const l=gu(Xu(e=>{const r=Date.now()-i;t(a.map(t=>(t.timeOffset-=r,t)),e),a=[],i=null}),o),c=Xu(gu(Xu(t=>{const e=Ku(t),{clientX:r,clientY:s}=Eu(t)?t.changedTouches[0]:t;i||(i=wu()),a.push({x:r,y:s,id:n.getId(e),timeOffset:wu()-i}),l("undefined"!=typeof DragEvent&&t instanceof DragEvent?Nu.Drag:t instanceof MouseEvent?Nu.MouseMove:Nu.TouchMove)}),s,{trailing:!1})),u=[du("mousemove",c,r),du("touchmove",c,r),du("drag",c,r)];return Xu(()=>{u.forEach(t=>t())})}(t),o=function({mouseInteractionCb:t,doc:e,mirror:r,blockClass:n,blockSelector:s,sampling:o}){if(!1===o.mouseInteraction)return()=>{};const i=!0===o.mouseInteraction||void 0===o.mouseInteraction?{}:o.mouseInteraction,a=[];let l=null;return Object.keys(Du).filter(t=>Number.isNaN(Number(t))&&!t.endsWith("_Departed")&&!1!==i[t]).forEach(o=>{let i=Ke(o);const c=(e=>o=>{const i=Ku(o);if(ku(i,n,s,!0))return;let a=null,c=e;if("pointerType"in o){switch(o.pointerType){case"mouse":a=Fu.Mouse;break;case"touch":a=Fu.Touch;break;case"pen":a=Fu.Pen}a===Fu.Touch?Du[e]===Du.MouseDown?c="TouchStart":Du[e]===Du.MouseUp&&(c="TouchEnd"):Fu.Pen}else Eu(o)&&(a=Fu.Touch);null!==a?(l=a,(c.startsWith("Touch")&&a===Fu.Touch||c.startsWith("Mouse")&&a===Fu.Mouse)&&(a=null)):Du[e]===Du.Click&&(a=l,l=null);const u=Eu(o)?o.changedTouches[0]:o;if(!u)return;const h=r.getId(i),{clientX:p,clientY:d}=u;Xu(t)({type:Du[c],id:h,x:p,y:d,...null!==a&&{pointerType:a}})})(o);if(window.PointerEvent)switch(Du[o]){case Du.MouseDown:case Du.MouseUp:i=i.replace("mouse","pointer");break;case Du.TouchStart:case Du.TouchEnd:return}a.push(du(i,c,e))}),Xu(()=>{a.forEach(t=>t())})}(t),i=th(t),a=function({viewportResizeCb:t},{win:e}){let r=-1,n=-1;return du("resize",Xu(gu(Xu(()=>{const e=Su(),s=Cu();r===e&&n===s||(t({width:Number(s),height:Number(e)}),r=e,n=s)}),200)),e)}(t,{win:r}),l=function({inputCb:t,doc:e,mirror:r,blockClass:n,blockSelector:s,ignoreClass:o,ignoreSelector:i,maskInputOptions:a,maskInputFn:l,sampling:c,userTriggeredOnInput:u}){function h(t){let r=Ku(t);const c=t.isTrusted,h=r&&r.tagName;if(r&&"OPTION"===h&&(r=au(r)),!r||!h||eh.indexOf(h)<0||ku(r,n,s,!0))return;if(r.classList.contains(o)||i&&r.matches(i))return;let d=r.value,f=!1;const m=tr(r)||"";"radio"===m||"checkbox"===m?f=r.checked:(a[h.toLowerCase()]||a[m])&&(d=$e({element:r,maskInputOptions:a,tagName:h,type:m,value:d,maskInputFn:l})),p(r,u?{text:d,isChecked:f,userTriggered:c}:{text:d,isChecked:f});const g=r.name;"radio"===m&&g&&f&&e.querySelectorAll(`input[type="radio"][name="${g}"]`).forEach(t=>{if(t!==r){const e=t.value;p(t,u?{text:e,isChecked:!f,userTriggered:!1}:{text:e,isChecked:!f})}})}function p(e,n){const s=rh.get(e);if(!s||s.text!==n.text||s.isChecked!==n.isChecked){rh.set(e,n);const s=r.getId(e);Xu(t)({...n,id:s})}}const d=("last"===c.input?["change"]:["input","change"]).map(t=>du(t,Xu(h),e)),f=e.defaultView;if(!f)return()=>{d.forEach(t=>t())};const m=f.Object.getOwnPropertyDescriptor(f.HTMLInputElement.prototype,"value"),g=[[f.HTMLInputElement.prototype,"value"],[f.HTMLInputElement.prototype,"checked"],[f.HTMLSelectElement.prototype,"value"],[f.HTMLTextAreaElement.prototype,"value"],[f.HTMLSelectElement.prototype,"selectedIndex"],[f.HTMLOptionElement.prototype,"selected"]];return m&&m.set&&d.push(...g.map(t=>yu(t[0],t[1],{set(){Xu(h)({target:this,isTrusted:!1})}},!1,f))),Xu(()=>{d.forEach(t=>t())})}(t),c=function({mediaInteractionCb:t,blockClass:e,blockSelector:r,mirror:n,sampling:s,doc:o}){const i=Xu(o=>gu(Xu(s=>{const i=Ku(s);if(!i||ku(i,e,r,!0))return;const{currentTime:a,volume:l,muted:c,playbackRate:u,loop:h}=i;t({type:o,id:n.getId(i),currentTime:a,volume:l,muted:c,playbackRate:u,loop:h})}),s.media||500)),a=[du("play",i(ju.Play),o),du("pause",i(ju.Pause),o),du("seeked",i(ju.Seeked),o),du("volumechange",i(ju.VolumeChange),o),du("ratechange",i(ju.RateChange),o)];return Xu(()=>{a.forEach(t=>t())})}(t);let u=()=>{},h=()=>{},p=()=>{},d=()=>{};t.recordDOM&&(u=function({styleSheetRuleCb:t,mirror:e,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};const s=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:Xu((n,s,o)=>{const[i,a]=o,{id:l,styleId:c}=sh(s,e,r.styleMirror);return(l&&-1!==l||c&&-1!==c)&&t({id:l,styleId:c,adds:[{rule:i,index:a}]}),n.apply(s,o)})}),n.CSSStyleSheet.prototype.addRule=function(t,e,r=this.cssRules.length){const s=`${t} { ${e} }`;return n.CSSStyleSheet.prototype.insertRule.apply(this,[s,r])};const o=n.CSSStyleSheet.prototype.deleteRule;let i,a;n.CSSStyleSheet.prototype.deleteRule=new Proxy(o,{apply:Xu((n,s,o)=>{const[i]=o,{id:a,styleId:l}=sh(s,e,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&t({id:a,styleId:l,removes:[{index:i}]}),n.apply(s,o)})}),n.CSSStyleSheet.prototype.removeRule=function(t){return n.CSSStyleSheet.prototype.deleteRule.apply(this,[t])},n.CSSStyleSheet.prototype.replace&&(i=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:Xu((n,s,o)=>{const[i]=o,{id:a,styleId:l}=sh(s,e,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&t({id:a,styleId:l,replace:i}),n.apply(s,o)})})),n.CSSStyleSheet.prototype.replaceSync&&(a=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(a,{apply:Xu((n,s,o)=>{const[i]=o,{id:a,styleId:l}=sh(s,e,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&t({id:a,styleId:l,replaceSync:i}),n.apply(s,o)})}));const l={};lh("CSSGroupingRule")?l.CSSGroupingRule=n.CSSGroupingRule:(lh("CSSMediaRule")&&(l.CSSMediaRule=n.CSSMediaRule),lh("CSSConditionRule")&&(l.CSSConditionRule=n.CSSConditionRule),lh("CSSSupportsRule")&&(l.CSSSupportsRule=n.CSSSupportsRule));const c={};return Object.entries(l).forEach(([n,s])=>{c[n]={insertRule:s.prototype.insertRule,deleteRule:s.prototype.deleteRule},s.prototype.insertRule=new Proxy(c[n].insertRule,{apply:Xu((n,s,o)=>{const[i,a]=o,{id:l,styleId:c}=sh(s.parentStyleSheet,e,r.styleMirror);return(l&&-1!==l||c&&-1!==c)&&t({id:l,styleId:c,adds:[{rule:i,index:[...nh(s),a||0]}]}),n.apply(s,o)})}),s.prototype.deleteRule=new Proxy(c[n].deleteRule,{apply:Xu((n,s,o)=>{const[i]=o,{id:a,styleId:l}=sh(s.parentStyleSheet,e,r.styleMirror);return(a&&-1!==a||l&&-1!==l)&&t({id:a,styleId:l,removes:[{index:[...nh(s),i]}]}),n.apply(s,o)})})}),Xu(()=>{n.CSSStyleSheet.prototype.insertRule=s,n.CSSStyleSheet.prototype.deleteRule=o,i&&(n.CSSStyleSheet.prototype.replace=i),a&&(n.CSSStyleSheet.prototype.replaceSync=a),Object.entries(l).forEach(([t,e])=>{e.prototype.insertRule=c[t].insertRule,e.prototype.deleteRule=c[t].deleteRule})})}(t,{win:r}),h=oh(t,t.doc),p=function({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:r,stylesheetManager:n},{win:s}){const o=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(o,{apply:Xu((s,i,a)=>{var l;const[c,u,h]=a;if(r.has(c))return o.apply(i,[c,u,h]);const{id:p,styleId:d}=sh(null==(l=i.parentRule)?void 0:l.parentStyleSheet,e,n.styleMirror);return(p&&-1!==p||d&&-1!==d)&&t({id:p,styleId:d,set:{property:c,value:u,priority:h},index:nh(i.parentRule)}),s.apply(i,a)})});const i=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(i,{apply:Xu((s,o,a)=>{var l;const[c]=a;if(r.has(c))return i.apply(o,[c]);const{id:u,styleId:h}=sh(null==(l=o.parentRule)?void 0:l.parentStyleSheet,e,n.styleMirror);return(u&&-1!==u||h&&-1!==h)&&t({id:u,styleId:h,remove:{property:c},index:nh(o.parentRule)}),s.apply(o,a)})}),Xu(()=>{s.CSSStyleDeclaration.prototype.setProperty=o,s.CSSStyleDeclaration.prototype.removeProperty=i})}(t,{win:r}),t.collectFonts&&(d=function({fontCb:t,doc:e}){const r=e.defaultView;if(!r)return()=>{};const n=[],s=new WeakMap,o=r.FontFace;r.FontFace=function(t,e,r){const n=new o(t,e,r);return s.set(n,{family:t,buffer:"string"!=typeof e,descriptors:r,fontSource:"string"==typeof e?e:JSON.stringify(Array.from(new Uint8Array(e)))}),n};const i=bu(e.fonts,"add",function(e){return function(r){return setTimeout(Xu(()=>{const e=s.get(r);e&&(t(e),s.delete(r))}),0),e.apply(this,[r])}});return n.push(()=>{r.FontFace=o}),n.push(i),Xu(()=>{n.forEach(t=>t())})}(t)));const f=function(t){const{doc:e,mirror:r,blockClass:n,blockSelector:s,selectionCb:o}=t;let i=!0;const a=Xu(()=>{const t=e.getSelection();if(!t||i&&(null==t?void 0:t.isCollapsed))return;i=t.isCollapsed||!1;const a=[],l=t.rangeCount||0;for(let e=0;e<l;e++){const o=t.getRangeAt(e),{startContainer:i,startOffset:l,endContainer:c,endOffset:u}=o;ku(i,n,s,!0)||ku(c,n,s,!0)||a.push({start:r.getId(i),startOffset:l,end:r.getId(c),endOffset:u})}o({ranges:a})});return a(),du("selectionchange",a)}(t),m=function({doc:t,customElementCb:e}){const r=t.defaultView;return r&&r.customElements?bu(r.customElements,"define",function(t){return function(r,n,s){try{e({define:{name:r}})}catch(t){console.warn(`Custom element callback failed for ${r}`)}return t.apply(this,[r,n,s])}}):()=>{}}(t),g=[];for(const e of t.plugins)g.push(e.observer(e.callback,r,e.options));return Xu(()=>{$u.forEach(t=>t.reset()),null==n||n.disconnect(),s(),o(),i(),a(),l(),c(),u(),h(),p(),d(),f(),m(),g.forEach(t=>t())})}function ah(t){return void 0!==window[t]}function lh(t){return Boolean(void 0!==window[t]&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class ch{constructor(t){Oe(this,"iframeIdToRemoteIdMap",new WeakMap),Oe(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=t}getId(t,e,r,n){const s=r||this.getIdToRemoteIdMap(t),o=n||this.getRemoteIdToIdMap(t);let i=s.get(e);return i||(i=this.generateIdFn(),s.set(e,i),o.set(i,e)),i}getIds(t,e){const r=this.getIdToRemoteIdMap(t),n=this.getRemoteIdToIdMap(t);return e.map(e=>this.getId(t,e,r,n))}getRemoteId(t,e,r){const n=r||this.getRemoteIdToIdMap(t);if("number"!=typeof e)return e;return n.get(e)||-1}getRemoteIds(t,e){const r=this.getRemoteIdToIdMap(t);return e.map(e=>this.getRemoteId(t,e,r))}reset(t){if(!t)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let e=this.iframeIdToRemoteIdMap.get(t);return e||(e=new Map,this.iframeIdToRemoteIdMap.set(t,e)),e}getRemoteIdToIdMap(t){let e=this.iframeRemoteIdToIdMap.get(t);return e||(e=new Map,this.iframeRemoteIdToIdMap.set(t,e)),e}}class uh{constructor(t){Oe(this,"iframes",new WeakMap),Oe(this,"crossOriginIframeMap",new WeakMap),Oe(this,"crossOriginIframeMirror",new ch(ur)),Oe(this,"crossOriginIframeStyleMirror"),Oe(this,"crossOriginIframeRootIdMap",new WeakMap),Oe(this,"mirror"),Oe(this,"mutationCb"),Oe(this,"wrappedEmit"),Oe(this,"loadListener"),Oe(this,"stylesheetManager"),Oe(this,"recordCrossOriginIframes"),this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new ch(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,e){var r,n;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:e}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&(null==(r=t.contentWindow)||r.addEventListener("message",this.handleMessage.bind(this))),null==(n=this.loadListener)||n.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){const e=t;if("rrweb"!==e.data.type||e.origin!==e.data.origin)return;if(!t.source)return;const r=this.crossOriginIframeMap.get(t.source);if(!r)return;const n=this.transformCrossOriginEvent(r,e.data.event);n&&this.wrappedEmit(n,e.data.isCheckout)}transformCrossOriginEvent(t,e){var r;switch(e.type){case Pu.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(e.data.node,t);const r=e.data.node.id;return this.crossOriginIframeRootIdMap.set(t,r),this.patchRootIdOnNode(e.data.node,r),{timestamp:e.timestamp,type:Pu.IncrementalSnapshot,data:{source:Nu.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:e.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case Pu.Meta:case Pu.Load:case Pu.DomContentLoaded:return!1;case Pu.Plugin:return e;case Pu.Custom:return this.replaceIds(e.data.payload,t,["id","parentId","previousId","nextId"]),e;case Pu.IncrementalSnapshot:switch(e.data.source){case Nu.Mutation:return e.data.adds.forEach(e=>{this.replaceIds(e,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(e.node,t);const r=this.crossOriginIframeRootIdMap.get(t);r&&this.patchRootIdOnNode(e.node,r)}),e.data.removes.forEach(e=>{this.replaceIds(e,t,["parentId","id"])}),e.data.attributes.forEach(e=>{this.replaceIds(e,t,["id"])}),e.data.texts.forEach(e=>{this.replaceIds(e,t,["id"])}),e;case Nu.Drag:case Nu.TouchMove:case Nu.MouseMove:return e.data.positions.forEach(e=>{this.replaceIds(e,t,["id"])}),e;case Nu.ViewportResize:return!1;case Nu.MediaInteraction:case Nu.MouseInteraction:case Nu.Scroll:case Nu.CanvasMutation:case Nu.Input:return this.replaceIds(e.data,t,["id"]),e;case Nu.StyleSheetRule:case Nu.StyleDeclaration:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleId"]),e;case Nu.Font:return e;case Nu.Selection:return e.data.ranges.forEach(e=>{this.replaceIds(e,t,["start","end"])}),e;case Nu.AdoptedStyleSheet:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleIds"]),null==(r=e.data.styles)||r.forEach(e=>{this.replaceStyleIds(e,t,["styleId"])}),e}}return!1}replace(t,e,r,n){for(const s of n)(Array.isArray(e[s])||"number"==typeof e[s])&&(Array.isArray(e[s])?e[s]=t.getIds(r,e[s]):e[s]=t.getId(r,e[s]));return e}replaceIds(t,e,r){return this.replace(this.crossOriginIframeMirror,t,e,r)}replaceStyleIds(t,e,r){return this.replace(this.crossOriginIframeStyleMirror,t,e,r)}replaceIdOnNode(t,e){this.replaceIds(t,e,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(t=>{this.replaceIdOnNode(t,e)})}patchRootIdOnNode(t,e){t.type===Bu.Document||t.rootId||(t.rootId=e),"childNodes"in t&&t.childNodes.forEach(t=>{this.patchRootIdOnNode(t,e)})}}class hh{constructor(t){Oe(this,"shadowDoms",new WeakSet),Oe(this,"mutationCb"),Oe(this,"scrollCb"),Oe(this,"bypassOptions"),Oe(this,"mirror"),Oe(this,"restoreHandlers",[]),this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,e){if(!qe(t))return;if(this.shadowDoms.has(t))return;this.shadowDoms.add(t);const r=Qu({...this.bypassOptions,doc:e,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},t);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(th({...this.bypassOptions,scrollCb:this.scrollCb,doc:t,mirror:this.mirror})),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(hu(t))),this.restoreHandlers.push(oh({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){t.contentWindow&&t.contentDocument&&this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,e){const r=this;this.restoreHandlers.push(bu(t.prototype,"attachShadow",function(t){return function(n){const s=t.call(this,n),o=pu(this);return o&&Lu(this)&&r.addShadowRoot(o,e),s}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch(t){}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var ph="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dh="undefined"==typeof Uint8Array?[]:new Uint8Array(256),fh=0;fh<64;fh++)dh[ph.charCodeAt(fh)]=fh;const mh=new Map,gh=(t,e,r)=>{if(!t||!wh(t,e)&&"object"!=typeof t)return;const n=function(t,e){let r=mh.get(t);return r||(r=new Map,mh.set(t,r)),r.has(e)||r.set(e,[]),r.get(e)}(r,t.constructor.name);let s=n.indexOf(t);return-1===s&&(s=n.length,n.push(t)),s};function yh(t,e,r){if(t instanceof Array)return t.map(t=>yh(t,e,r));if(null===t)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer)return{rr_type:t.constructor.name,base64:function(t){var e,r=new Uint8Array(t),n=r.length,s="";for(e=0;e<n;e+=3)s+=ph[r[e]>>2],s+=ph[(3&r[e])<<4|r[e+1]>>4],s+=ph[(15&r[e+1])<<2|r[e+2]>>6],s+=ph[63&r[e+2]];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s}(t)};if(t instanceof DataView)return{rr_type:t.constructor.name,args:[yh(t.buffer,e,r),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){const e=t.constructor.name,{src:r}=t;return{rr_type:e,src:r}}return t instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:t.toDataURL()}:t instanceof ImageData?{rr_type:t.constructor.name,args:[yh(t.data,e,r),t.width,t.height]}:wh(t,e)||"object"==typeof t?{rr_type:t.constructor.name,index:gh(t,e,r)}:t}const bh=(t,e,r)=>t.map(t=>yh(t,e,r)),wh=(t,e)=>{const r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(t=>"function"==typeof e[t]);return Boolean(r.find(r=>t instanceof e[r]))};function vh(t,e,r,n){const s=[];try{const o=bu(t.HTMLCanvasElement.prototype,"getContext",function(t){return function(s,...o){if(!ku(this,e,r,!0)){const t=function(t){return"experimental-webgl"===t?"webgl":t}(s);if("__context"in this||(this.__context=t),n&&["webgl","webgl2"].includes(t))if(o[0]&&"object"==typeof o[0]){const t=o[0];t.preserveDrawingBuffer||(t.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return t.apply(this,[s,...o])}});s.push(o)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{s.forEach(t=>t())}}function Sh(t,e,r,n,s,o){const i=[],a=Object.getOwnPropertyNames(t);for(const l of a)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(l))try{if("function"!=typeof t[l])continue;const a=bu(t,l,function(t){return function(...i){const a=t.apply(this,i);if(gh(a,o,this),"tagName"in this.canvas&&!ku(this.canvas,n,s,!0)){const t=bh(i,o,this),n={type:e,property:l,args:t};r(this.canvas,n)}return a}});i.push(a)}catch{const n=yu(t,l,{set(t){r(this.canvas,{type:e,property:l,args:[t],setter:!0})}});i.push(n)}return i}const Ch="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=",Ih="undefined"!=typeof window&&window.Blob&&new Blob([(kh=Ch,Uint8Array.from(atob(kh),t=>t.charCodeAt(0)))],{type:"text/javascript;charset=utf-8"});var kh;function xh(t){let e;try{if(e=Ih&&(window.URL||window.webkitURL).createObjectURL(Ih),!e)throw"";const r=new Worker(e,{name:null==t?void 0:t.name});return r.addEventListener("error",()=>{(window.URL||window.webkitURL).revokeObjectURL(e)}),r}catch(e){return new Worker("data:text/javascript;base64,"+Ch,{name:null==t?void 0:t.name})}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}class _h{constructor(t){Oe(this,"pendingCanvasMutations",new Map),Oe(this,"rafStamps",{latestId:0,invokeId:null}),Oe(this,"mirror"),Oe(this,"mutationCb"),Oe(this,"resetObservers"),Oe(this,"frozen",!1),Oe(this,"locked",!1),Oe(this,"processMutation",(t,e)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(t)||this.pendingCanvasMutations.set(t,[]),this.pendingCanvasMutations.get(t).push(e)});const{sampling:e="all",win:r,blockClass:n,blockSelector:s,recordCanvas:o,dataURLOptions:i}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,o&&"all"===e&&this.initCanvasMutationObserver(r,n,s),o&&"number"==typeof e&&this.initCanvasFPSObserver(e,r,n,s,{dataURLOptions:i})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(t,e,r,n,s){const o=vh(e,r,n,!0),i=new Map,a=new xh;a.onmessage=t=>{const{id:e}=t.data;if(i.set(e,!1),!("base64"in t.data))return;const{base64:r,type:n,width:s,height:o}=t.data;this.mutationCb({id:e,type:Uu["2D"],commands:[{property:"clearRect",args:[0,0,s,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:n}]},0,0]}]})};const l=1e3/t;let c,u=0;const h=t=>{u&&t-u<l||(u=t,(()=>{const t=[];return e.document.querySelectorAll("canvas").forEach(e=>{ku(e,r,n,!0)||t.push(e)}),t})().forEach(async t=>{var e;const r=this.mirror.getId(t);if(i.get(r))return;if(0===t.width||0===t.height)return;if(i.set(r,!0),["webgl","webgl2"].includes(t.__context)){const r=t.getContext(t.__context);!1===(null==(e=null==r?void 0:r.getContextAttributes())?void 0:e.preserveDrawingBuffer)&&r.clear(r.COLOR_BUFFER_BIT)}const n=await createImageBitmap(t);a.postMessage({id:r,bitmap:n,width:t.width,height:t.height,dataURLOptions:s.dataURLOptions},[n])})),c=requestAnimationFrame(h)};c=requestAnimationFrame(h),this.resetObservers=()=>{o(),cancelAnimationFrame(c)}}initCanvasMutationObserver(t,e,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const n=vh(t,e,r,!1),s=function(t,e,r,n){const s=[],o=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const i of o)try{if("function"!=typeof e.CanvasRenderingContext2D.prototype[i])continue;const o=bu(e.CanvasRenderingContext2D.prototype,i,function(s){return function(...o){return ku(this.canvas,r,n,!0)||setTimeout(()=>{const r=bh(o,e,this);t(this.canvas,{type:Uu["2D"],property:i,args:r})},0),s.apply(this,o)}});s.push(o)}catch{const r=yu(e.CanvasRenderingContext2D.prototype,i,{set(e){t(this.canvas,{type:Uu["2D"],property:i,args:[e],setter:!0})}});s.push(r)}return()=>{s.forEach(t=>t())}}(this.processMutation.bind(this),t,e,r),o=function(t,e,r,n){const s=[];return s.push(...Sh(e.WebGLRenderingContext.prototype,Uu.WebGL,t,r,n,e)),void 0!==e.WebGL2RenderingContext&&s.push(...Sh(e.WebGL2RenderingContext.prototype,Uu.WebGL2,t,r,n,e)),()=>{s.forEach(t=>t())}}(this.processMutation.bind(this),t,e,r);this.resetObservers=()=>{n(),s(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,e)=>{const r=this.mirror.getId(e);this.flushPendingCanvasMutationFor(e,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,e){if(this.frozen||this.locked)return;const r=this.pendingCanvasMutations.get(t);if(!r||-1===e)return;const n=r.map(t=>{const{type:e,...r}=t;return r}),{type:s}=r[0];this.mutationCb({id:e,type:s,commands:n}),this.pendingCanvasMutations.delete(t)}}class Eh{constructor(t){Oe(this,"trackedLinkElements",new WeakSet),Oe(this,"mutationCb"),Oe(this,"adoptedStyleSheetCb"),Oe(this,"styleMirror",new Au),this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,e){"_cssText"in e.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:e.id,attributes:e.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,e){if(0===t.length)return;const r={id:e,styleIds:[]},n=[];for(const e of t){let t;this.styleMirror.has(e)?t=this.styleMirror.getId(e):(t=this.styleMirror.add(e),n.push({styleId:t,rules:Array.from(e.rules||CSSRule,(t,r)=>({rule:Ye(t,e.href),index:r}))})),r.styleIds.push(t)}n.length>0&&(r.styles=n),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class Rh{constructor(){Oe(this,"nodeMap",new WeakMap),Oe(this,"active",!1)}inOtherBuffer(t,e){const r=this.nodeMap.get(t);return r&&Array.from(r).some(t=>t!==e)}add(t,e){this.active||(this.active=!0,requestAnimationFrame(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(e))}destroy(){}}let Oh,Mh,Ah,Th=!1;try{if(2!==Array.from([1],t=>2*t)[0]){const t=document.createElement("iframe");document.body.appendChild(t),Array.from=(null==(Ee=t.contentWindow)?void 0:Ee.Array.from)||Array.from,document.body.removeChild(t)}}catch(t){console.debug("Unable to override Array.from",t)}const Lh=new Xe;function Ph(t={}){const{emit:e,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:s="rr-block",blockSelector:o=null,ignoreClass:i="rr-ignore",ignoreSelector:a=null,maskTextClass:l="rr-mask",maskTextSelector:c=null,inlineStylesheet:u=!0,maskAllInputs:h,maskInputOptions:p,slimDOMOptions:d,maskInputFn:f,maskTextFn:m,hooks:g,packFn:y,sampling:b={},dataURLOptions:w={},mousemoveWait:v,recordDOM:S=!0,recordCanvas:C=!1,recordCrossOriginIframes:I=!1,recordAfter:k=("DOMContentLoaded"===t.recordAfter?t.recordAfter:"load"),userTriggeredOnInput:x=!1,collectFonts:_=!1,inlineImages:E=!1,plugins:R,keepIframeSrcFn:O=()=>!1,ignoreCSSAttributes:M=new Set([]),errorHandler:A}=t;Yu=A;const T=!I||window.parent===window;let L=!1;if(!T)try{window.parent.document&&(L=!1)}catch(t){L=!0}if(T&&!e)throw new Error("emit function is required");if(!T&&!L)return()=>{};void 0!==v&&void 0===b.mousemove&&(b.mousemove=v),Lh.reset();const P=!0===h?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==p?p:{password:!0},N=!0===d||"all"===d?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===d,headMetaDescKeywords:"all"===d,headTitleMutations:"all"===d}:d||{};let D;!function(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach)}();let F=0;const U=t=>{for(const e of R||[])e.eventProcessor&&(t=e.eventProcessor(t));return y&&!L&&(t=y(t)),t};Oh=(t,s)=>{var o;const i=t;if(i.timestamp=wu(),!(null==(o=$u[0])?void 0:o.isFrozen())||i.type===Pu.FullSnapshot||i.type===Pu.IncrementalSnapshot&&i.data.source===Nu.Mutation||$u.forEach(t=>t.unfreeze()),T)null==e||e(U(i),s);else if(L){const t={type:"rrweb",event:U(i),origin:window.location.origin,isCheckout:s};window.parent.postMessage(t,"*")}if(i.type===Pu.FullSnapshot)D=i,F=0;else if(i.type===Pu.IncrementalSnapshot){if(i.data.source===Nu.Mutation&&i.data.isAttachIframe)return;F++;const t=n&&F>=n,e=r&&i.timestamp-D.timestamp>r;(t||e)&&Mh(!0)}};const j=t=>{Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.Mutation,...t}})},B=t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.Scroll,...t}}),z=t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.CanvasMutation,...t}}),W=new Eh({mutationCb:j,adoptedStyleSheetCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.AdoptedStyleSheet,...t}})}),V=new uh({mirror:Lh,mutationCb:j,stylesheetManager:W,recordCrossOriginIframes:I,wrappedEmit:Oh});for(const t of R||[])t.getMirror&&t.getMirror({nodeMirror:Lh,crossOriginIframeMirror:V.crossOriginIframeMirror,crossOriginIframeStyleMirror:V.crossOriginIframeStyleMirror});const H=new Rh;Ah=new _h({recordCanvas:C,mutationCb:z,win:window,blockClass:s,blockSelector:o,mirror:Lh,sampling:b.canvas,dataURLOptions:w});const G=new hh({mutationCb:j,scrollCb:B,bypassOptions:{blockClass:s,blockSelector:o,maskTextClass:l,maskTextSelector:c,inlineStylesheet:u,maskInputOptions:P,dataURLOptions:w,maskTextFn:m,maskInputFn:f,recordCanvas:C,inlineImages:E,sampling:b,slimDOMOptions:N,iframeManager:V,stylesheetManager:W,canvasManager:Ah,keepIframeSrcFn:O,processedNodeManager:H},mirror:Lh});Mh=(t=!1)=>{if(!S)return;Oh({type:Pu.Meta,data:{href:window.location.href,width:Cu(),height:Su()}},t),W.reset(),G.init(),$u.forEach(t=>t.lock());const e=function(t,e){const{mirror:r=new Xe,blockClass:n="rr-block",blockSelector:s=null,maskTextClass:o="rr-mask",maskTextSelector:i=null,inlineStylesheet:a=!0,inlineImages:l=!1,recordCanvas:c=!1,maskAllInputs:u=!1,maskTextFn:h,maskInputFn:p,slimDOM:d=!1,dataURLOptions:f,preserveWhiteSpace:m,onSerialize:g,onIframeLoad:y,iframeLoadTimeout:b,onStylesheetLoad:w,stylesheetLoadTimeout:v,keepIframeSrcFn:S=()=>!1}=e||{};return kr(t,{doc:t,mirror:r,blockClass:n,blockSelector:s,maskTextClass:o,maskTextSelector:i,skipChild:!1,inlineStylesheet:a,maskInputOptions:!0===u?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===u?{password:!0}:u,maskTextFn:h,maskInputFn:p,slimDOMOptions:!0===d||"all"===d?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===d,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===d?{}:d,dataURLOptions:f,inlineImages:l,recordCanvas:c,preserveWhiteSpace:m,onSerialize:g,onIframeLoad:y,iframeLoadTimeout:b,onStylesheetLoad:w,stylesheetLoadTimeout:v,keepIframeSrcFn:S,newlyAddedElement:!1})}(document,{mirror:Lh,blockClass:s,blockSelector:o,maskTextClass:l,maskTextSelector:c,inlineStylesheet:u,maskAllInputs:P,maskTextFn:m,maskInputFn:f,slimDOM:N,dataURLOptions:w,recordCanvas:C,inlineImages:E,onSerialize:t=>{Ru(t,Lh)&&V.addIframe(t),Ou(t,Lh)&&W.trackLinkElement(t),Mu(t)&&G.addShadowRoot(pu(t),document)},onIframeLoad:(t,e)=>{V.attachIframe(t,e),G.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{W.attachLinkElement(t,e)},keepIframeSrcFn:O});if(!e)return console.warn("Failed to snapshot the document");Oh({type:Pu.FullSnapshot,data:{node:e,initialOffset:vu(window)}},t),$u.forEach(t=>t.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&W.adoptStyleSheets(document.adoptedStyleSheets,Lh.getId(document))};try{const t=[],e=t=>{var e;return Xu(ih)({mutationCb:j,mousemoveCb:(t,e)=>Oh({type:Pu.IncrementalSnapshot,data:{source:e,positions:t}}),mouseInteractionCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.MouseInteraction,...t}}),scrollCb:B,viewportResizeCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.ViewportResize,...t}}),inputCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.Input,...t}}),mediaInteractionCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.MediaInteraction,...t}}),styleSheetRuleCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.StyleSheetRule,...t}}),styleDeclarationCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.StyleDeclaration,...t}}),canvasMutationCb:z,fontCb:t=>Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.Font,...t}}),selectionCb:t=>{Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.Selection,...t}})},customElementCb:t=>{Oh({type:Pu.IncrementalSnapshot,data:{source:Nu.CustomElement,...t}})},blockClass:s,ignoreClass:i,ignoreSelector:a,maskTextClass:l,maskTextSelector:c,maskInputOptions:P,inlineStylesheet:u,sampling:b,recordDOM:S,recordCanvas:C,inlineImages:E,userTriggeredOnInput:x,collectFonts:_,doc:t,maskInputFn:f,maskTextFn:m,keepIframeSrcFn:O,blockSelector:o,slimDOMOptions:N,dataURLOptions:w,mirror:Lh,iframeManager:V,stylesheetManager:W,shadowDomManager:G,processedNodeManager:H,canvasManager:Ah,ignoreCSSAttributes:M,plugins:(null==(e=null==R?void 0:R.filter(t=>t.observer))?void 0:e.map(t=>({observer:t.observer,options:t.options,callback:e=>Oh({type:Pu.Plugin,data:{plugin:t.name,payload:e}})})))||[]},g)};V.addLoadListener(r=>{try{t.push(e(r.contentDocument))}catch(t){console.warn(t)}});const r=()=>{Mh(),t.push(e(document)),Th=!0};return"interactive"===document.readyState||"complete"===document.readyState?r():(t.push(du("DOMContentLoaded",()=>{Oh({type:Pu.DomContentLoaded,data:{}}),"DOMContentLoaded"===k&&r()})),t.push(du("load",()=>{Oh({type:Pu.Load,data:{}}),"load"===k&&r()},window))),()=>{t.forEach(t=>t()),H.destroy(),Th=!1,Yu=void 0}}catch(t){console.warn(t)}}var Nh,Dh;Ph.addCustomEvent=(t,e)=>{if(!Th)throw new Error("please add custom event after start recording");Oh({type:Pu.Custom,data:{tag:t,payload:e}})},Ph.freezePage=()=>{$u.forEach(t=>t.freeze())},Ph.takeFullSnapshot=t=>{if(!Th)throw new Error("please take full snapshot after start recording");Mh(t)},Ph.mirror=Lh,(Dh=Nh||(Nh={}))[Dh.NotStarted=0]="NotStarted",Dh[Dh.Running=1]="Running",Dh[Dh.Stopped=2]="Stopped";var Fh=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(Fh||{});class Uh{_options;_rrwebOptions;_isReady=!1;_stopFn=null;_recordFn;_buffers=[[],[]];_currentSlot=0;get _previousSlot(){return 1^this._currentSlot}constructor(t){this.options=t,this._recordFn=t.recordFn||Ph}get isRecording(){return null!==this._stopFn}get isReady(){return this._isReady}get options(){return this._options}set options(t){this.configure(t)}configure(t){const{enabled:e,autoStart:r,maxPreDuration:n,debug:s,emit:o,checkoutEveryNms:i,...a}=t;this._options={enabled:e,autoStart:r,maxPreDuration:n,debug:s},this._rrwebOptions=a,this.isRecording&&!1===t.enabled&&this.stop()}checkoutEveryNms(){return 1e3*(this.options.maxPreDuration||10)/2}bufferCursor(){return{slot:this._currentSlot,offset:this._buffers[this._currentSlot].length-1}}exportRecordingSpan(t,e={},r){const n=r?this._collectEventsFromCursor(r):this._collectAll();if(0===n.length)throw new Error("Replay recording has no events");const s=t.startSpan("rrweb-replay-recording",{});s.setAttributes({...t.session?.attributes??{},...e});const o=n.reduce((t,e)=>e.timestamp<t.timestamp?e:t);s.span.startTime=ve.fromMillis(o.timestamp);for(const t of n)s.addEvent("rrweb-replay-events",{eventType:t.type,json:JSON.stringify(t.data)},ve.fromMillis(t.timestamp));s.end()}start(){if(!this.isRecording&&!1!==this.options.enabled)return this.clear(),this._stopFn=this._recordFn({emit:(t,e)=>{this._isReady||t.type!==Fh.FullSnapshot||(this._isReady=!0),this.options.debug?.logEmits&&Uh._logEvent(t,e),e&&t.type===Fh.Meta&&(this._currentSlot=this._previousSlot,this._buffers[this._currentSlot]=[]),this._buffers[this._currentSlot].push(t)},checkoutEveryNms:this.checkoutEveryNms(),errorHandler:t=>(this.options.debug?.logErrors&&tt.error("Error during replay recording",t),!0),...this._rrwebOptions}),this}stop(){if(this.isRecording)return this._stopFn(),this._stopFn=null,this._isReady=!1,this}clear(){this._buffers=[[],[]],this._currentSlot=0,this._isReady=!1}_collectAll(){const t=this._buffers[this._previousSlot],e=this._buffers[this._currentSlot],r=t.concat(e);return r.length>0&&r.push(Uh._replayEndEvent()),r}_collectEventsFromCursor(t){const e=this._currentSlot,r=this._buffers[t.slot]??[],n=this._buffers[e],s=r.slice(Math.max(0,t.offset+1)),o=t.slot===e?[]:n,i=s.concat(o);return this.options.debug?.logErrors&&t.slot!==e&&0===s.length&&tt.warn("Captured lead buffer cleared by multiple checkouts"),i.length>0&&i.push(Uh._replayEndEvent()),i}static _replayEndEvent(){return{type:Fh.Custom,timestamp:Date.now(),data:{tag:"replay.end",payload:{}}}}static _logEvent(t,e){tt.log(`Recorder: ${e?"checkout":""} event\n`,(t=>{const e=new WeakSet;return JSON.stringify(t,(t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return"[Circular]";e.add(r)}return r},2)})(t))}}class jh{maxAdjustedCount=2**56;constructor(t){this.configure(t),this.predicates={occurrence:[this.isLevelMatching.bind(this),this.isSampled.bind(this)],navigation:[this.isPathMatching.bind(this),this.isSampled.bind(this)],direct:[this.isTagMatching.bind(this),this.isSampled.bind(this)]}}configure(t){this.config=t||{},this.triggers=this._triggersWithDefaults(t),this.maxPreDuration=this._maxPreDuration()}_triggersWithDefaults(t){return(t?.triggers||[]).map(e=>({...t.triggerDefaults,...e}))}_maxPreDuration(){return this.triggers?Math.max(...this.triggers.map(t=>t.preDuration||0),0):0}shouldCaptureForTriggerContext(t){const e=this.predicates[t.type];for(const r of this.triggers)if(r.type===t.type&&this.isEnabledForTrigger(r,e,t))return r;return null}isEnabledForTrigger(t,e,r){return!e.find(e=>!e(t,r))}isLevelMatching(t,e){return!(t.level&&!t.level.includes(e.level))}isPathMatching(t,e){return!t.pathMatch||!!e.path?.match(new RegExp(t.pathMatch))}isTagMatching(t,e){return!t.tags||!!e.tags?.some(e=>t.tags.includes(e))}isSampled(t,e){const r=t.samplingRatio??1;return 1==r||e.replayId.slice(-14)>=(this.maxAdjustedCount*(1-r)).toString(16).padStart(14,"0")}}class Bh{_recorder;_tracing;_telemeter;_pending=new Map;_shouldSend;_onComplete;constructor({recorder:t,tracing:e,telemeter:r,shouldSend:n,onComplete:s}){this._recorder=t,this._tracing=e,this._telemeter=r,this._shouldSend=n,this._onComplete=s}schedule(t,e,r){const n=Date.now(),s=n+1e3*r,o=this._recorder.checkoutEveryNms(),i=this._recorder.bufferCursor(),a=setInterval(()=>{this._export(t)},o),l=setTimeout(()=>{this._finalExport(t)},1e3*r);this._pending.set(t,{intervalId:a,endTimerId:l,startTime:n,endAt:s,postDuration:r,occurrenceUuid:e,cursor:i,chunkQueue:[],sending:!1,aborted:!1,finished:!1})}async _export(t){const e=this._pending.get(t);if(!e||e.aborted||e.finished||Date.now()>=e.endAt)return;const r=e.cursor,n=this._recorder.bufferCursor();try{this._recorder.exportRecordingSpan(this._tracing,{"rollbar.replay.id":t,"rollbar.occurrence.uuid":e.occurrenceUuid},r)}catch(t){return void tt.debug("Error exporting leading chunk (tick):",t)}this._telemeter?.exportTelemetrySpan({"rollbar.replay.id":t});const s=this._tracing.exporter.toPayload();e.chunkQueue.push({payload:s,cursor:r}),e.cursor=n,await this.sendIfReady(t)}async _finalExport(t){const e=this._pending.get(t);if(!e||e.aborted)return;e.intervalId&&clearInterval(e.intervalId),e.endTimerId&&clearTimeout(e.endTimerId),e.finished=!0;const r=e.cursor,n=this._recorder.bufferCursor();try{this._recorder.exportRecordingSpan(this._tracing,{"rollbar.replay.id":t,"rollbar.occurrence.uuid":e.occurrenceUuid},r),this._telemeter?.exportTelemetrySpan({"rollbar.replay.id":t});const s=this._tracing.exporter.toPayload();e.chunkQueue.push({payload:s,cursor:r}),e.cursor=n}catch(t){tt.debug("Error exporting leading chunk (final):",t)}if(!e.sending&&0===e.chunkQueue.length)return this._pending.delete(t),void this._onComplete?.(t);await this.sendIfReady(t)}async sendIfReady(t){const e=this._pendingContextIfReady(t);if(e){if(e.finished&&!e.sending&&0===e.chunkQueue.length)return this._pending.delete(t),void this._onComplete?.(t);e.sending=!0;for(const r of e.chunkQueue){if(e.aborted)break;if(!this._shouldSend(t))throw tt.error("Coordination check failed during chunk send"),this.discard(t),new Error("Coordination check failed during chunk send");try{await this._tracing.exporter.post(r.payload,{"X-Rollbar-Replay-Id":t})}catch(e){throw tt.error("Failed to send leading replay:",e),this.discard(t),e}}e.sending=!1,e.chunkQueue=[],e.finished&&(this._pending.delete(t),this._onComplete?.(t))}}discard(t){const e=this._pending.get(t);e&&(e.aborted=!0,e.intervalId&&clearInterval(e.intervalId),e.endTimerId&&clearTimeout(e.endTimerId),e.chunkQueue=[],this._pending.delete(t),this._onComplete?.(t))}_pendingContextIfReady(t){const e=this._pending.get(t);return e&&!e.aborted&&!e.sending&&e.chunkQueue.length>0&&this._shouldSend(t)?e:null}}const zh=Object.freeze({PENDING:"pending",SENT:"sent",FAILED:"failed",SKIPPED:"skipped"});class Wh{_map;_recorder;_tracing;_telemeter;_scheduledCapture;_trailingStatus;constructor({tracing:t,telemeter:e,options:r}){if(!t)throw new TypeError("Expected 'tracing' to be provided");this._map=new Map,this._predicates=new jh(r),this._recorder=new Uh({...r,maxPreDuration:this._predicates.maxPreDuration}),this._tracing=t,this._telemeter=e,this._trailingStatus=new Map,this._scheduledCapture=new Bh({recorder:this._recorder,tracing:this._tracing,telemeter:this._telemeter,shouldSend:this._shouldSendScheduled.bind(this),onComplete:this._onScheduledComplete.bind(this)}),this._tracing.addSpanTransform(this.uuidsTransform.bind(this))}_onScheduledComplete(t){this._trailingStatus.delete(t)}_shouldSendScheduled(t){const e=this._trailingStatus.get(t);return e===zh.SENT||e===zh.SKIPPED}configure(t){this._predicates.configure(t),this._recorder.configure({...t,maxPreDuration:this._predicates.maxPreDuration})}async _exportSpansAndAddTracingPayload(t,e,r,n){try{this._recorder.exportRecordingSpan(this._tracing,{"rollbar.replay.id":t,"rollbar.occurrence.uuid":e,"rollbar.replay.trigger.type":r.type,"rollbar.replay.trigger.context":JSON.stringify(n),"rollbar.replay.trigger":JSON.stringify(r),"rollbar.replay.url.full":d(window.location.href)})}catch(t){return void tt.debug("Error exporting recording span:",t)}this._telemeter?.exportTelemetrySpan({"rollbar.replay.id":t});const s=this._tracing.exporter.toPayload();this._map.set(t,s);const o=r?.postDuration||0;o>0&&(this._scheduledCapture.schedule(t,e,o),this._trailingStatus.set(t,zh.PENDING))}capture(t,e,r){if(!this._recorder.isReady)return tt.warn("Replay.capture: Recorder is not ready, cannot export replay"),null;t=t||me(8);const n=this._predicates.shouldCaptureForTriggerContext({...r,replayId:t});return n?(this._exportSpansAndAddTracingPayload(t,e,n,r),t):null}async triggerReplay(t){const e=me(8),r=this._predicates.shouldCaptureForTriggerContext({...t,replayId:e});if(!r)return null;if(this._recorder.isReady)await this._exportSpansAndAddTracingPayload(e,null,r,t);else{this._trailingStatus.set(e,zh.SKIPPED);const t=this._recorder.options?.postDuration||0;t>0&&this._scheduledCapture.schedule(e,null,t)}try{await this.send(e)}catch(t){return this.discard(e),null}return e}static _canSendReplay(t,e,r){if(!r)return!1;const n=!t&&0===e?.err,s=Object.fromEntries(Object.entries(r).map(([t,e])=>[t.toLowerCase(),String(e).trim()])),o="true"===s["rollbar-replay-enabled"]&&"0"!==s["rollbar-replay-ratelimit-remaining"];return n&&o}async sendOrDiscardReplay(t,e,r,n){if(Wh._canSendReplay(e,r,n))try{await this.send(t)}catch(e){tt.error("Failed to send replay:",e),this.discard(t)}else this.discard(t)}async send(t){if(!t)throw Error("Replay.send: No replayId provided");if(!this._map.has(t))throw Error(`Replay.send: No replay found for id: ${t}`);const e=this._map.get(t);if(this._map.delete(t),!e||Array.isArray(e)&&0===e.length||e.resourceSpans&&0===e.resourceSpans.length)throw Error(`Replay.send: No payload found for id: ${t}`);await this._tracing.exporter.post(e,{"X-Rollbar-Replay-Id":t}),this._trailingStatus.set(t,zh.SENT),await this._scheduledCapture.sendIfReady(t)}discard(t){return t?(this._trailingStatus.set(t,zh.FAILED),this._scheduledCapture.discard(t),this._map.has(t)?(this._map.delete(t),this._trailingStatus.delete(t),!0):(tt.error(`Replay.discard: No replay found for replayId: ${t}`),!1)):(tt.error("Replay.discard: No replayId provided"),!1)}uuidsTransform(t){const e=ve.toMillis(t.startTime),r=this._telemeter.queue.filter(t=>t.timestamp_ms>=e&&t.uuid).map(t=>t.uuid);t.attributes["rollbar.occurrence.uuids"]=JSON.stringify(r)}getSpans(t){return this._map.get(t)??null}setSpans(t,e){this._map.set(t,e)}clear(){this._map.clear()}get size(){return this._map.size}get recorder(){return this._recorder}}Bt.setComponents({telemeter:class{constructor(t,e){this.queue=[],this.options=o(t);var r=this.options.maxTelemetryEvents||zt;this.maxQueueSize=Math.max(0,Math.min(r,zt)),this.tracing=e,this.telemetrySpan=this.tracing?.startSpan("rollbar-telemetry",{})}configure(t){var e=this.options;this.options=o(e,t);var r=this.options.maxTelemetryEvents||zt,n=Math.max(0,Math.min(r,zt)),s=0;this.queue.length>n&&(s=this.queue.length-n),this.maxQueueSize=n,this.queue.splice(0,s)}copyEvents(){var t=Array.prototype.slice.call(this.queue,0);if(l(this.options.filterTelemetry))try{for(var e=t.length;e--;)this.options.filterTelemetry(t[e])&&t.splice(e,1)}catch(t){this.options.filterTelemetry=null}return(t=t.filter(t=>"connectivity"!==t.type)).map(({otelAttributes:t,...e})=>e)}exportTelemetrySpan(t={}){this.telemetrySpan&&(this.telemetrySpan.end(t),this.telemetrySpan=this.tracing.startSpan("rollbar-telemetry",{}))}capture(t,e,r,n,s=null,o=null){var i={level:Vt(t,r),type:t,timestamp_ms:s||R(),body:e,source:"client"};n&&(i.uuid=n),o&&(i.otelAttributes=o);try{if(l(this.options.filterTelemetry)&&this.options.filterTelemetry(i))return!1}catch(t){this.options.filterTelemetry=null}return this.push(i),i}captureEvent(t,e,r,n){return this.capture(t,e,r,n)}captureError(t,e,r,n){const s=t.message||String(t);var o={message:s};t.stack&&(o.stack=t.stack);const i={message:s,level:e,type:"error",uuid:r};return this.telemetrySpan?.addEvent("rollbar-occurrence-event",i,Wt(n)),this.capture("error",o,e,r,n,i)}captureLog(t,e,r,n){let s=null;return r?(s={message:t,level:e,type:"message",uuid:r},this.telemetrySpan?.addEvent("rollbar-occurrence-event",s,Wt(n))):(s={message:t,level:e},this.telemetrySpan?.addEvent("rollbar-log-event",s,Wt(n))),this.capture("log",{message:t},e,r,n,s)}captureNetwork(t,e,r,n){e=e||"xhr",t.subtype=t.subtype||e,n&&(t.request=n);const s=this.levelFromStatus(t.status_code),o=1e6*(t.end_time_ms||0),i={type:t.subtype,method:t.method,url:t.url,statusCode:t.status_code,"request.headers":JSON.stringify(t.request_headers||{}),"response.headers":JSON.stringify(t.response?.headers||{}),"response.timeUnixNano":o.toString()};return this.telemetrySpan?.addEvent("rollbar-network-event",i,Wt(t.start_time_ms)),this.capture("network",t,s,r,t.start_time_ms,i)}levelFromStatus(t){return t>=200&&t<400?"info":0===t||t>=400?"error":"info"}captureDom(t,e,r,n,s){var o={subtype:t,element:e};return void 0!==r&&(o.value=r),void 0!==n&&(o.checked=n),this.capture("dom",o,"info",s)}captureInput({type:t,isSynthetic:e,element:r,value:n,timestamp:s}){const o="rollbar-input-event",i={type:o,subtype:t,element:r,value:n},a={type:t,isSynthetic:e,element:r,value:n,endTimeUnixNano:Wt(s)},l=this._getRepeatedEvent(o,a);return l?this._updateRepeatedEvent(l,a,s):(this.telemetrySpan?.addEvent(o,a,Wt(s)),this.capture("dom",i,"info",null,s,a))}captureClick({type:t,isSynthetic:e,element:r,timestamp:n}){const s="rollbar-click-event",o={type:s,subtype:t,element:r},i={type:t,isSynthetic:e,element:r,endTimeUnixNano:Wt(n)},a=this._getRepeatedEvent(s,i);return a?this._updateRepeatedEvent(a,i,n):(this.telemetrySpan?.addEvent(s,i,Wt(n)),this.capture("dom",o,"info",null,n,i))}_getRepeatedEvent(t,e){const r=this._lastEvent(this.queue);if(r&&r.body.type===t&&r.otelAttributes.target===e.target)return r}_updateRepeatedEvent(t,e,r){const n=Math.max(r-t.timestamp_ms,1);t.body.value=e.value,t.otelAttributes.value=e.value,t.otelAttributes.height=e.height,t.otelAttributes.width=e.width,t.otelAttributes.textZoomRatio=e.textZoomRatio,t.otelAttributes.endTimeUnixNano=Wt(r),t.otelAttributes.durationUnixNano=Wt(n),t.otelAttributes.count=(t.otelAttributes.count||1)+1,t.otelAttributes.rate=t.otelAttributes.count/(n/1e3)}_lastEvent(t){return t.length>0?t[t.length-1]:null}captureFocus({type:t,isSynthetic:e,element:r,timestamp:n}){const s="rollbar-focus-event",o={type:s,subtype:t,element:r},i={type:t,isSynthetic:e,element:r};return this.telemetrySpan?.addEvent(s,i,Wt(n)),this.capture("dom",o,"info",null,n,i)}captureResize({type:t,isSynthetic:e,width:r,height:n,textZoomRatio:s,timestamp:o}){const i="rollbar-resize-event",a={type:i,subtype:t,width:r,height:n,textZoomRatio:s},l={type:t,isSynthetic:e,width:r,height:n,textZoomRatio:s},c=this._getRepeatedEvent(i,l);return c?this._updateRepeatedEvent(c,l,o):(this.telemetrySpan?.addEvent(i,l,Wt(o)),this.capture("dom",a,"info",null,o,l))}captureDragDrop({type:t,isSynthetic:e,element:r,dropEffect:n,effectAllowed:s,kinds:o,mediaTypes:i,timestamp:a}){const l="rollbar-dragdrop-event";let c={type:l,subtype:t,isSynthetic:e},u={type:t,isSynthetic:e};return"dragstart"===t&&(c={...c,element:r,dropEffect:n,effectAllowed:s},u={...u,element:r,dropEffect:n,effectAllowed:s}),"drop"===t&&(c={...c,element:r,dropEffect:n,effectAllowed:s,kinds:o,mediaTypes:i},u={...u,element:r,dropEffect:n,effectAllowed:s,kinds:o,mediaTypes:i}),this.telemetrySpan?.addEvent(l,u,Wt(a)),this.capture("dom",c,"info",null,a,u)}captureNavigation(t,e,r,n){return this.telemetrySpan?.addEvent("rollbar-navigation-event",{"previous.url.full":t,"url.full":e},Wt(n)),this.capture("navigation",{from:t,to:e},"info",r,n)}captureDomContentLoaded(t){return this.capture("navigation",{subtype:"DOMContentLoaded"},"info",void 0,t&&t.getTime())}captureLoad(t){return this.capture("navigation",{subtype:"load"},"info",void 0,t&&t.getTime())}captureConnectivityChange({type:t,isSynthetic:e,timestamp:r}){const n="rollbar-connectivity-event",s={type:n,subtype:t},o={type:t,isSynthetic:e};return this.telemetrySpan?.addEvent(n,o,Wt(r)),this.capture("connectivity",s,"info",null,r,o)}_captureRollbarItem(t){if(this.options.includeItemsInTelemetry)return t.err?this.captureError(t.err,t.level,t.uuid,t.timestamp):t.message?this.captureLog(t.message,t.level,t.uuid,t.timestamp):t.custom?this.capture("log",t.custom,t.level,t.uuid,t.timestamp):void 0}push(t){this.queue.push(t),this.queue.length>this.maxQueueSize&&this.queue.shift()}},instrumenter:class{constructor(t,e,r,n,s){this.options=t;let a=t.autoInstrument;!1===t.enabled||!1===a?this.autoInstrument={}:(i(a,"object")||(a=Qt),this.autoInstrument=o(Qt,a)),this.scrubTelemetryInputs=!!t.scrubTelemetryInputs,this.telemetryScrubber=t.telemetryScrubber,this.defaultValueScrubber=function(t){const e=[];for(const r of t)e.push(new RegExp(r,"i"));return function(t){const r=function(t){if(!t||!t.attributes)return null;const e=t.attributes;for(const t of e)if("name"===t.key)return t.value;return null}(t);if(!r)return!1;for(const t of e)if(t.test(r))return!0;return!1}}(t.scrubFields),this.telemeter=e,this.rollbar=r,this.diagnostic=r.client.notifier.diagnostic,this._window=n||{},this._document=s||{},this.replacements={network:[],log:[],navigation:[],connectivity:[]},this.eventRemovers={dom:[],connectivity:[],contentsecuritypolicy:[]},this._location=this._window.location,this._lastHref=this._location&&this._location.href}configure(t){this.options=o(this.options,t);let e=t.autoInstrument;const r=o(this.autoInstrument);!1===t.enabled||!1===e?this.autoInstrument={}:(i(e,"object")||(e=Qt),this.autoInstrument=o(Qt,e)),this.instrument(r),void 0!==t.scrubTelemetryInputs&&(this.scrubTelemetryInputs=!!t.scrubTelemetryInputs),void 0!==t.telemetryScrubber&&(this.telemetryScrubber=t.telemetryScrubber)}instrument(t){!this.autoInstrument.network||t&&t.network?!this.autoInstrument.network&&t&&t.network&&this.deinstrumentNetwork():this.instrumentNetwork(),!this.autoInstrument.log||t&&t.log?!this.autoInstrument.log&&t&&t.log&&this.deinstrumentConsole():this.instrumentConsole(),!this.autoInstrument.dom||t&&t.dom?!this.autoInstrument.dom&&t&&t.dom&&this.deinstrumentDom():this.instrumentDom(),!this.autoInstrument.navigation||t&&t.navigation?!this.autoInstrument.navigation&&t&&t.navigation&&this.deinstrumentNavigation():this.instrumentNavigation(),!this.autoInstrument.connectivity||t&&t.connectivity?!this.autoInstrument.connectivity&&t&&t.connectivity&&this.deinstrumentConnectivity():this.instrumentConnectivity(),!this.autoInstrument.contentSecurityPolicy||t&&t.contentSecurityPolicy?!this.autoInstrument.contentSecurityPolicy&&t&&t.contentSecurityPolicy&&this.deinstrumentContentSecurityPolicy():this.instrumentContentSecurityPolicy()}deinstrumentNetwork(){te(this.replacements,"network")}instrumentNetwork(){const t=this;function e(e,r){e in r&&l(r[e])&&Jt(r,e,function(e){return t.rollbar.wrap(e)})}if("XMLHttpRequest"in this._window){const r=this._window.XMLHttpRequest.prototype;Jt(r,"open",function(t){return function(e,r){const n=ee(r);return(i(r,"string")||n)&&(r=n?r.toString():r,this.__rollbar_xhr?(this.__rollbar_xhr.method=e,this.__rollbar_xhr.url=r,this.__rollbar_xhr.status_code=null,this.__rollbar_xhr.start_time_ms=R(),this.__rollbar_xhr.end_time_ms=null):this.__rollbar_xhr={method:e,url:r,status_code:null,start_time_ms:R(),end_time_ms:null}),t.apply(this,arguments)}},this.replacements,"network"),Jt(r,"setRequestHeader",function(e){return function(r,n){return this.__rollbar_xhr||(this.__rollbar_xhr={}),i(r,"string")&&i(n,"string")&&(t.autoInstrument.networkRequestHeaders&&(this.__rollbar_xhr.request_headers||(this.__rollbar_xhr.request_headers={}),this.__rollbar_xhr.request_headers[r]=n),"content-type"===r.toLowerCase()&&(this.__rollbar_xhr.request_content_type=n)),e.apply(this,arguments)}},this.replacements,"network"),Jt(r,"send",function(r){return function(n){const s=this;function o(){if(s.__rollbar_xhr&&(null===s.__rollbar_xhr.status_code&&(s.__rollbar_xhr.status_code=0,t.autoInstrument.networkRequestBody&&(s.__rollbar_xhr.request=n),s.__rollbar_event=t.captureNetwork(s.__rollbar_xhr,"xhr",void 0)),s.readyState<2&&(s.__rollbar_xhr.start_time_ms=R()),s.readyState>3)){const e=R();s.__rollbar_xhr.end_time_ms=e;let r=null;if(s.__rollbar_xhr.response_content_type=s.getResponseHeader("Content-Type"),t.autoInstrument.networkResponseHeaders){const e=t.autoInstrument.networkResponseHeaders;r={};try{let t;if(!0===e){const e=s.getAllResponseHeaders();if(e){const n=e.trim().split(/[\r\n]+/);let s,o;for(const e of n)s=e.split(": "),t=s.shift(),o=s.join(": "),r[t]=o}}else for(const t of e)r[t]=s.getResponseHeader(t)}catch(t){}}let n=null;if(t.autoInstrument.networkResponseBody)try{n=s.responseText}catch(t){}let o=null;(n||r)&&(o={},n&&(t.isJsonContentType(s.__rollbar_xhr.response_content_type)?o.body=t.scrubJson(n):o.body=n),r&&(o.headers=r)),o&&(s.__rollbar_xhr.response=o);try{let r=s.status;r=1223===r?204:r,s.__rollbar_xhr.status_code=r,t.addOtelNetworkResponse(s.__rollbar_event,e,r),s.__rollbar_event.level=t.telemeter.levelFromStatus(r),t.errorOnHttpStatus(s.__rollbar_xhr)}catch(t){}}}return e("onload",s),e("onerror",s),e("onprogress",s),"onreadystatechange"in s&&l(s.onreadystatechange)?Jt(s,"onreadystatechange",function(e){return t.rollbar.wrap(e,void 0,o)}):s.onreadystatechange=o,s.__rollbar_xhr&&t.trackHttpErrors()&&(s.__rollbar_xhr.stack=(new Error).stack),r.apply(this,arguments)}},this.replacements,"network")}"fetch"in this._window&&Jt(this._window,"fetch",function(e){return function(r,n){const s=[...arguments],o=s[0];let a,l="GET";const c=ee(o);i(o,"string")||c?a=c?o.toString():o:o&&(a=o.url,o.method&&(l=o.method)),s[1]&&s[1].method&&(l=s[1].method);const u={method:l,url:a,status_code:null,start_time_ms:R(),end_time_ms:null};if(s[1]&&s[1].headers){const e=(h=s[1].headers,"undefined"==typeof Headers?new Gt(h):new Headers(h));u.request_content_type=e.get("Content-Type"),t.autoInstrument.networkRequestHeaders&&(u.request_headers=t.fetchHeaders(e,t.autoInstrument.networkRequestHeaders))}var h;t.autoInstrument.networkRequestBody&&(s[1]&&s[1].body?u.request=s[1].body:s[0]&&!i(s[0],"string")&&s[0].body&&(u.request=s[0].body));const p=t.captureNetwork(u,"fetch",void 0);return t.trackHttpErrors()&&(u.stack=(new Error).stack),e.apply(this,s).then(function(e){const r=R();u.end_time_ms=r,u.status_code=e.status,t.addOtelNetworkResponse(p,r,e.status),u.response_content_type=e.headers.get("Content-Type");let n=null;t.autoInstrument.networkResponseHeaders&&(n=t.fetchHeaders(e.headers,t.autoInstrument.networkResponseHeaders));let s=null;return t.autoInstrument.networkResponseBody&&"function"==typeof e.text&&(s=e.clone().text()),(n||s)&&(u.response={},s&&("function"==typeof s.then?s.then(function(e){e&&t.isJsonContentType(u.response_content_type)?u.response.body=t.scrubJson(e):u.response.body=e}):u.response.body=s),n&&(u.response.headers=n)),t.errorOnHttpStatus(u),e})}},this.replacements,"network")}captureNetwork(t,e,r){return t.request&&this.isJsonContentType(t.request_content_type)&&(t.request=this.scrubJson(t.request)),this.telemeter.captureNetwork(t,e,r)}isJsonContentType(t){return!!(t&&i(t,"string")&&t.toLowerCase().includes("json"))}addOtelNetworkResponse(t,e,r){t.otelAttributes&&(t.otelAttributes["response.timeUnixNano"]=(1e6*e).toString(),t.otelAttributes.statusCode=r)}scrubJson(t){return JSON.stringify(Yt(JSON.parse(t),this.options.scrubFields))}fetchHeaders(t,e){const r={};try{if(!0===e){if("function"==typeof t.entries){const e=t.entries();let n=e.next();for(;!n.done;)r[n.value[0]]=n.value[1],n=e.next()}}else for(const n of e)r[n]=t.get(n)}catch(t){}return r}trackHttpErrors(){return this.autoInstrument.networkErrorOnHttp5xx||this.autoInstrument.networkErrorOnHttp4xx||this.autoInstrument.networkErrorOnHttp0}errorOnHttpStatus(t){const e=t.status_code;if(e>=500&&this.autoInstrument.networkErrorOnHttp5xx||e>=400&&this.autoInstrument.networkErrorOnHttp4xx||0===e&&this.autoInstrument.networkErrorOnHttp0){const r=new Error("HTTP request failed with Status "+e);r.stack=t.stack,this.rollbar.error(r,{skipFrames:1})}}deinstrumentConsole(){let t;for(;this.replacements.log.length;)t=this.replacements.log.shift(),this._window.console[t[0]]=t[1]}instrumentConsole(){if(!this._window?.console?.log)return;const t=this,e=this._window.console;function r(r){const n=e[r],s=e,o="warn"===r?"warning":r;e[r]=function(){const e=Array.prototype.slice.call(arguments),r=function(t){var e,r,n,s=[];for(e=0,r=t.length;e<r;++e){switch(a(n=t[e])){case"object":(n=(n=y(n)).error||n.value).length>500&&(n=n.substr(0,497)+"...");break;case"null":n="null";break;case"undefined":n="undefined";break;case"symbol":n=n.toString()}s.push(n)}return s.join(" ")}(e);t.telemeter.captureLog(r,o,null,R()),n&&Function.prototype.apply.call(n,s,e)},t.replacements.log.push([r,n])}const n=["debug","info","warn","error","log"];try{for(const t of n)r(t)}catch(t){this.diagnostic.instrumentConsole={error:t.message}}}deinstrumentDom(){this.removeListeners("dom")}instrumentDom(){this.addListener("dom",this._window,["click","dblclick","contextmenu"],t=>this.handleEvent("click",t)),this.addListener("dom",this._window,["dragstart","dragend","dragenter","dragleave","drop"],t=>this.handleEvent("dragdrop",t)),this.addListener("dom",this._window,["blur","focus"],t=>this.handleEvent("focus",t)),this.addListener("dom",this._window,["submit","invalid"],t=>this.handleEvent("form",t)),this.addListener("dom",this._window,["input","change"],t=>this.handleEvent("input",t)),this.addListener("dom",this._window,["resize"],t=>this.handleEvent("resize",t)),this.addListener("dom",this._document,["DOMContentLoaded"],t=>this.handleEvent("contentLoaded",t))}handleEvent(t,e){try{return{click:this.handleClick,dragdrop:this.handleDrag,focus:this.handleFocus,form:this.handleForm,input:this.handleInput,resize:this.handleResize,contentLoaded:this.handleContentLoaded}[t].call(this,e)}catch(r){console.log(`${t} handler error`,e,r,r.stack)}}handleContentLoaded(t){this.rollbar.triggerReplay({type:"navigation",path:new URL(this._location.href).pathname})}handleClick(t){const e=t.target?.tagName.toLowerCase();["input","select","textarea"].includes(e)||this.telemeter.captureClick({type:t.type,isSynthetic:!t.isTrusted,element:Xt(t.target),timestamp:R()})}handleFocus(t){const e=t.type,r=t.target?.window?"window":Xt(t.target);this.telemeter.captureFocus({type:e,isSynthetic:!t.isTrusted,element:r,timestamp:R()})}handleForm(t){const e=t.type,r=t.target?.window?"window":Xt(t.target);console.log("handleForm",e,r,t)}handleResize(t){const e=window.screen.width/window.innerWidth;this.telemeter.captureResize({type:t.type,isSynthetic:!t.isTrusted,width:window.innerWidth,height:window.innerHeight,textZoomRatio:e,timestamp:R()})}handleDrag(t){const e=t.type;let r,n,s,o;if("drop"===e){r=[],n=[];const e=[...t.dataTransfer.files,...t.dataTransfer.items];for(const t of e)t.kind&&t.type&&(r.push(t.kind),n.push(t.type))}["drop","dragstart"].includes(e)&&(s=t.dataTransfer?.dropEffect,o=t.dataTransfer?.effectAllowed),this.telemeter.captureDragDrop({type:e,isSynthetic:!t.isTrusted,element:Xt(t.target),dropEffect:s,effectAllowed:o,kinds:JSON.stringify(r),mediaTypes:JSON.stringify(n),timestamp:R()})}handleInput(t){const e=t.type,r=t.target?.tagName.toLowerCase();let n=t.target?.value,s=t.target?.attributes?.type?.value||t.target?.type;switch(e){case"input":if(["radio","checkbox"].includes(s))return;["select","textarea"].includes(r)&&(s=r),"password"===s&&(n=null);break;case"change":if(!["radio","checkbox"].includes(s))return;"checkbox"===s&&(n=t.target?.checked)}this.telemeter.captureInput({type:s,isSynthetic:!t.isTrusted,element:Xt(t.target),value:n,timestamp:R()})}deinstrumentNavigation(){const t=this._window.chrome;!(t&&t.app&&t.app.runtime)&&this._window.history&&this._window.history.pushState&&te(this.replacements,"navigation")}instrumentNavigation(){const t=this._window.chrome;if(t&&t.app&&t.app.runtime||!this._window.history||!this._window.history.pushState)return;const e=this;Jt(this._window,"onpopstate",function(t){return function(){const r=e._location.href;e.handleUrlChange(e._lastHref,r),t&&t.apply(this,arguments)}},this.replacements,"navigation"),Jt(this._window.history,"pushState",function(t){return function(){const r=arguments.length>2?arguments[2]:void 0;return r&&e.handleUrlChange(e._lastHref,r+""),t.apply(this,arguments)}},this.replacements,"navigation")}handleUrlChange(t,e){const r=st(this._location.href),n=st(e),s=st(t);this._lastHref=e,r.protocol===n.protocol&&r.host===n.host&&(e=n.path+(n.hash||"")),r.protocol===s.protocol&&r.host===s.host&&(t=s.path+(s.hash||"")),this.telemeter.captureNavigation(t,e,null,R()),this.rollbar.triggerReplay({type:"navigation",path:e})}deinstrumentConnectivity=function(){this.removeListeners("connectivity")};instrumentConnectivity(){const t=this;this.addListener("connectivity",this._window,["online","offline"],e=>t.handleConnectivity(e))}handleConnectivity(t){const e=t.type;this.telemeter.captureConnectivityChange({type:e,isSynthetic:!t.isTrusted,timestamp:R()})}handleCspEvent(t){let e="Security Policy Violation: blockedURI: "+t.blockedURI+", violatedDirective: "+t.violatedDirective+", effectiveDirective: "+t.effectiveDirective+", ";t.sourceFile&&(e+="location: "+t.sourceFile+", line: "+t.lineNumber+", col: "+t.columnNumber+", "),e+="originalPolicy: "+t.originalPolicy,this.telemeter.captureLog(e,"error",null,R()),this.handleCspError(e)}handleCspError(t){this.autoInstrument.errorOnContentSecurityPolicy&&this.rollbar.error(t)}deinstrumentContentSecurityPolicy(){this.removeListeners("contentsecuritypolicy")}instrumentContentSecurityPolicy(){if(!("addEventListener"in this._document))return;const t=this.handleCspEvent.bind(this);this.addListener("contentsecuritypolicy",this._document,["securitypolicyviolation"],t)}addListener(t,e,r,n){if(e.addEventListener)for(const s of r){const r={capture:!0,passive:!0};e.addEventListener(s,n,r,!0),this.eventRemovers[t].push(function(){e.removeEventListener(s,n,r)})}}removeListeners(t){let e;for(;this.eventRemovers[t].length;)e=this.eventRemovers[t].shift(),e()}},wrapGlobals:function(t,e,r){if(t){var n,s,o="EventTarget,Window,Node,ApplicationCache,AudioTrackList,ChannelMergerNode,CryptoOperation,EventSource,FileReader,HTMLUnknownElement,IDBDatabase,IDBRequest,IDBTransaction,KeyOperation,MediaController,MessagePort,ModalWindow,Notification,SVGElementInstance,Screen,TextTrack,TextTrackCue,TextTrackList,WebSocket,WebSocketWorker,Worker,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload".split(",");for(n=0;n<o.length;++n)t[s=o[n]]&&t[s].prototype&&re(e,t[s].prototype,r)}},scrub:Yt,truncation:he,tracing:class{constructor(t,e,r){this.api=e,this.options=r,this.window=t,this.window.sessionStorage&&(this.session=new ye(this,r)),this.createTracer()}configure(t){this.options=t}initSession(){this.session&&this.session.init()}get sessionId(){return this.session?this.session.session.id:null}get resource(){return{attributes:{...this.options.resource||{},"rollbar.environment":this.options.payload?.environment??this.options.environment}}}get scope(){return{name:"rollbar-browser-js",version:this.options.version}}idGen(t=16){return me(t)}createTracer(){this.contextManager=new fe,this.exporter=new Se(this.api,this.options),this.spanProcessor=new Ie(this.exporter,this.options.tracing),this.tracer=new xe(this,this.spanProcessor)}getTracer(){return this.tracer}addSpanTransform(t){this.spanProcessor.addTransform(t)}getSpan(t=this.contextManager.active()){return t.getValue(_e)}setSpan(t=this.contextManager.active(),e){return t.setValue(_e,e)}startSpan(t,e={},r=this.contextManager.active()){return this.tracer.startSpan(t,e,r)}with(t,e,r,...n){return this.contextManager.with(t,e,r,...n)}withSpan(t,e,r,n){const s=this.startSpan(t,e);return this.with(this.setSpan(this.contextManager.active(),s),r,n,s)}},replay:Wh});const Vh=new Bt({accessToken:"POST_CLIENT_ITEM_TOKEN",captureUncaught:!0,captureUnhandledRejections:!0,replay:{enabled:!0,autoStart:!0},checkIgnore:(t,e,r)=>!!(r.body.message&&r.body.message.extra&&r.body.message.extra.storePayload)&&(window.jsonPayload=Vh.buildJsonPayload(r),!0)});window.Rollbar=Vh,window.rollbarInfo=()=>{Vh.info("webpack test log")},window.throwError=()=>{throw new Error("webpack test error")},window.rollbarInfoWithExtra=()=>{Vh.info("webpack test log",{storePayload:!0})},window.sendJson=()=>{Vh.sendJsonPayload(window.jsonPayload)}})();
//# sourceMappingURL=bundle.js.map